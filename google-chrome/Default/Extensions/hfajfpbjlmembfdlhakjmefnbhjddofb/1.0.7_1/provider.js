(()=>{"use strict";var n,t,e=function(){function n(){this.callbacks={}}return n.prototype.on=function(n,t){this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(t)},n.prototype.off=function(n,t){var e=this.callbacks[n];e&&(this.callbacks[n]=e.filter((function(n){return n!==t})))},n.prototype.emit=function(n,t){var e=this.callbacks[n];e&&e.forEach((function(n){return n(t)}))},n}(),o=(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=function(n){function t(t){void 0===t&&(t=window.ion);var e=n.call(this)||this;return e.isOpenMask=!0,e.targetOrigin="*",e.nextJsonRpcId=0,e.promises={},e.isConnected=function(){return e.send("ping").then((function(){return!0}))},e.isLocked=function(){return e.send("ton_getLocked")},e.onMessage=function(n){return t=e,o=void 0,i=function(){var t,e,o,r,i,s,c;return function(n,t){var e,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(n,s)}catch(n){i=[6,n],o=0}finally{e=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(a){return n&&n.data?"OpenMaskAPI"!==n.data.type?[2]:(t=n.data)&&t.message&&t.message.jsonrpc?(e=t.message,o=e.id,r=e.method,i=e.error,s=e.result,void 0!==o?(c=this.promises[o])&&(e.error?c.reject(i):c.resolve(s),delete this.promises[o]):r&&function(n){switch(n){case"accountsChanged":case"chainChanged":return!0;default:return!1}}(r)&&this.emit(r,s),[2]):[2]:[2]}))},new((r=void 0)||(r=Promise))((function(n,e){function s(n){try{a(i.next(n))}catch(n){e(n)}}function c(n){try{a(i.throw(n))}catch(n){e(n)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(s,c)}a((i=i.apply(t,o||[])).next())}));var t,o,r,i},e.addListener=e.on,e.removeListener=e.off,e.addEventListener=e.on,e.removeEventListener=e.off,t&&t.isOpenMask&&(e.nextJsonRpcId=t.nextJsonRpcId,e.promises=t.promises,e.callbacks=t.callbacks),e.isConnected().catch((function(n){return console.error(n)})),t&&t.isOpenMask&&t.destroyOpenMask(),t&&t.isTonWallet&&(t._destroy&&t._destroy(),window.ion=e),window.addEventListener("message",e.onMessage),e}return o(t,n),t.prototype.send=function(n){for(var t=this,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(!n||"string"!=typeof n)return Promise.reject("Method is not a valid string.");1===e.length&&e[0]instanceof Array&&(e=e[0]);var r=this.nextJsonRpcId++,i={jsonrpc:"2.0",id:r,method:n,params:e,origin:window.origin,event:void 0!==window.event},s=new Promise((function(n,e){t.promises[i.id]={resolve:n,reject:e}}));return window.postMessage({type:"OpenMaskProvider",message:i},this.targetOrigin),s},t.prototype._destroy=function(){},t.prototype.destroyOpenMask=function(){window.removeEventListener("message",this.onMessage)},t}(e),i=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},n(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();!function(n){n[n.unauthorize=1001]="unauthorize",n[n.reject=1002]="reject",n[n.closePopUp=1003]="closePopUp",n[n.unexpectedParams=1004]="unexpectedParams"}(t||(t={}));var s,c=function(n){function t(t,e,o){var r=n.call(this,e)||this;return r.code=t,r.description=o,r}return i(t,n),t}(Error),a=(i((function(){return s.call(this,t.closePopUp,"Close PopUp")||this}),s=c),function(n){i((function(e){return n.call(this,t.unexpectedParams,null!=e?e:"The method have to call with user event, for example when user click to button, calling event by script is restricted.")||this}),n)}(c),function(n){function t(t,e){var o=n.call(this,t)||this;return o.code=e,o}return i(t,n),t}(Error));var u=function(n,t,e,o){return new(e||(e=Promise))((function(r,i){function s(n){try{a(o.next(n))}catch(n){i(n)}}function c(n){try{a(o.throw(n))}catch(n){i(n)}}function a(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(s,c)}a((o=o.apply(n,t||[])).next())}))},l=function(n,t){var e,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(n,s)}catch(n){i=[6,n],o=0}finally{e=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function f(){var n,t,e=(null===(t=null===(n=window.navigator)||void 0===n?void 0:n.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform,o=window.navigator.userAgent,r=null;return-1!==["macOS","Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(e)?r="mac":-1!==["iPhone"].indexOf(e)?r="iphone":-1!==["iPad","iPod"].indexOf(e)?r="ipad":-1!==["Win32","Win64","Windows","WinCE"].indexOf(e)?r="windows":(/Android/.test(o)||/Linux/.test(e))&&(r="linux"),r}var d,p=function(){return{platform:f(),appName:"ION Wallet",appVersion:"1.0.0",maxProtocolVersion:2,features:["SendTransaction",{name:"SendTransaction",maxMessages:4}]}},h=function(n){var t;return{event:"connect_error",payload:{code:null!==(t=n.code)&&void 0!==t?t:0,message:n.message}}},v=function(n){switch(n){case 1001:return 100;case 1002:return 300;default:return 0}},w=!!window.ion,y=new r(null===window||void 0===window?void 0:window.ion),m=new function(n,t){var e=this;this.provider=n,this.callbacks=[],this.deviceInfo=p(),this.walletInfo={name:"ION Wallet",app_name:"ION Wallet",image:"https://raw.githubusercontent.com/ice-blockchain/ion-chrome-wallet/refs/heads/ion-mainnet/public/ion-logo128.png",about_url:"https://ice.io/",platforms:["chrome"]},this.protocolVersion=2,this.isWalletBrowser=!1,this.connect=function(n,t){return u(e,void 0,void 0,(function(){var e,o,r;return l(this,(function(i){switch(i.label){case 0:if(n>this.protocolVersion)return[2,this.notify(h(new a("Unsupported protocol version",1)))];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.provider.send("tonConnect_connect",t)];case 2:return e=i.sent(),[2,this.notify({event:"connect",payload:{items:e,device:p()}})];case 3:return(o=i.sent())instanceof a?[2,this.notify(h(o))]:[2,this.notify(h(new a(null!==(r=o.message)&&void 0!==r?r:"Unknown error",v(o.code))))];case 4:return[2]}}))}))},this.disconnect=function(){return u(e,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return[4,this.provider.send("tonConnect_disconnect")];case 1:return n.sent(),[2,this.notify({event:"disconnect",payload:{}})]}}))}))},this.restoreConnection=function(){return u(e,void 0,void 0,(function(){var n,t,e;return l(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.provider.send("tonConnect_reconnect",[{name:"ton_addr"}])];case 1:return n=o.sent(),[2,this.notify({event:"connect",payload:{items:n,device:p()}})];case 2:return(t=o.sent())instanceof a?[2,this.notify(h(t))]:[2,this.notify(h(new a(null!==(e=t.message)&&void 0!==e?e:"Unknown error")))];case 3:return[2]}}))}))},this.send=function(n){return u(e,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.provider.send("tonConnect_".concat(n.method),n.params.map((function(n){return JSON.parse(n)})))];case 1:return[2,{result:t.sent(),id:String(n.id)}];case 2:return[2,{error:t.sent(),id:String(n.id)}];case 3:return[2]}}))}))},this.listen=function(n){return e.callbacks.push(n),function(){e.callbacks=e.callbacks.filter((function(t){return t!=n}))}},this.notify=function(n){return e.callbacks.forEach((function(t){return t(n)})),n},t?this.callbacks=t.callbacks:n.on("chainChanged",(function(){e.notify({event:"disconnect",payload:{}})}))}(y,null===(d=null===window||void 0===window?void 0:window.ionmask)||void 0===d?void 0:d.ionconnect);window.ionProtocolVersion=2,window.ion=y,window.ionmask={provider:y,ionconnect:m},w||window.dispatchEvent(new Event("ionready"))})();