"use strict";(self.webpackChunk_ionwallet_extension=self.webpackChunk_ionwallet_extension||[]).push([[338],{73338:function(e,n,t){t.r(n),t.d(n,{Notifications:function(){return un},default:function(){return ln}});var r,s,a,i,o,c,u,l,d,x=t(1413),f=t(74165),p=t(15861),h=t(70885),g=t(72791),m=t(27393),v=t(27706),j=t(95958),Z=t(74617),w=t(10278),b=t(45490),C=t(69758),k=t(36664),y=t(62006),S=t(96403),L=t(73418),R=t(11915),A=t(98052),M=t(12213),B=t(67835),E=t(27351),T=t(48682),D=t(62657),q=t(22007),N=t(66995),Q=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(n,t){var r;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.jettonContent){e.next=6;break}return e.next=3,M.SF.validateAsync(n.jettonContent);case 3:case 9:return e.abrupt("return",e.sent);case 6:return r={symbol:t.symbol,image:t.image,name:t.name,decimals:t.decimals},e.next=9,M.SF.validateAsync(r);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),J=t(80184),K=g.memo((function(e){var n=e.wallet,t=e.state,r=function(e,n,t){var r=(0,g.useContext)(q.LQ);return(0,y.a)([D.xL.jetton,n,t,e],(0,p.Z)((0,f.Z)().mark((function e(){var s,a;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.d)(r,t,n);case 2:return s=e.sent,a=s.wallet,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))}(e.id,e.jettonMinterAddress,n),s=r.data;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(w.xv,{children:["Wallet: ",(0,k.QJ)(n)]}),(0,J.jsx)(C.e,{state:t,balance:null===s||void 0===s?void 0:s.balance})]})})),P=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=function(e){return(0,y.a)([D.xL.origin,e],(0,p.Z)((0,f.Z)().mark((function n(){var t;return(0,f.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,v.ZC)().message("getWallets",e);case 2:if(null!=(t=n.sent)){n.next=5;break}throw new Error("Unexpected wallets");case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),n)}))),{enabled:!!e})}(r),o=i.data,c=function(e){var n=(0,g.useContext)(q.LQ);return(0,y.a)([D.xL.jetton,e.address],(0,p.Z)((0,f.Z)().mark((function t(){var r,s,a;return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.open(A.JettonMinter.createFromAddress(R.Address.parse(e.address))),t.next=3,r.getJettonData();case 3:return s=t.sent,t.next=6,Q(s,e);case 6:return a=t.sent,t.abrupt("return",{data:s,state:a});case 8:case"end":return t.stop()}}),t)}))))}(s),u=c.data,l=c.isFetching,d=c.error,h=function(e){var n=(0,g.useContext)(q.J5),t=(0,g.useContext)(q.Qu),r=(0,S.NL)();return(0,L.D)(function(){var s=(0,p.Z)((0,f.Z)().mark((function s(a){var i,o,c;return(0,f.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(i=a.state,o=a.wallets){s.next=3;break}throw new Error("Unexpected set of wallets");case 3:return c=(0,x.Z)((0,x.Z)({},t),{},{wallets:t.wallets.map((function(e){if(o.includes(e.address)){var n=(0,B.n)(e);if(!n.some((function(e){return(0,E.hh)(e)&&e.minterAddress===i.minterAddress})))return n.push(i),(0,B.F)(e,n)}return e}))}),s.next=6,(0,N.GX)(n,r,c);case 6:v.L2.message("approveRequest",{id:e,payload:void 0});case 7:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}())}(n),m=h.mutateAsync,j=h.isLoading,C=h.error,k=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,m({wallets:o,state:{state:u.state,minterAddress:s.address}});case 4:a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]);return l?(0,J.jsx)(Z.g,{}):!u||d||C?(0,J.jsx)(Z.D,{button:"Close",action:M,children:(0,J.jsx)(w.Bc,{children:(null===d||void 0===d?void 0:d.message)||(null===C||void 0===C?void 0:C.message)||"Jetton Data is not define"})}):(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Add Suggested Token"}),(0,J.jsx)(w.xv,{children:"Would you like to import these jetton?"}),(0,J.jsx)(w.xv,{children:"Jetton (Your wallet balance)"})]}),(0,J.jsx)(w.Xs,{children:(null!==o&&void 0!==o?o:[]).map((function(e){return(0,J.jsx)(K,{wallet:e,id:n,state:u.state,jettonMinterAddress:s.address})}))}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.z4,{children:[(0,J.jsx)(w.E0,{onClick:M,disabled:j,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:k,disabled:j,children:"Add Jetton"})]})]})},F=t(37043),z=t(12362),U=t(70224),I=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=(0,g.useContext)(q.RJ),o=(0,g.useState)(null),c=(0,h.Z)(o,2),u=c[0],l=c[1],d=(0,g.useState)(null),x=(0,h.Z)(d,2),m=x[0],j=x[1],C=(0,g.useState)(null),k=(0,h.Z)(C,2),y=k[0],S=k[1],L=(0,U.Gc)(),R=L.mutateAsync,A=L.isLoading,M=(0,U.rA)(),B=M.mutateAsync,E=M.isLoading,T=(0,U.zk)(),D=T.mutateAsync,N=T.isLoading,Q=(0,U.zJ)(),K=Q.mutateAsync,P=Q.reset,I=Q.isLoading,W=(0,U.hH)(),H=W.mutateAsync,V=W.isLoading;(0,g.useEffect)((function(){(0,p.Z)((0,f.Z)().mark((function e(){var n,t,r,a;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(s.address);case 2:if(n=e.sent,l(n),!n.collectionAddress){e.next=13;break}return e.next=7,D(n.collectionAddress);case 7:return t=e.sent,S(t),e.next=11,H({collection:t,address:s.address});case 11:(r=e.sent)&&j(r);case 13:return e.next=15,B(n).catch((function(){return null}));case 15:(a=e.sent)&&j(a);case 17:case"end":return e.stop()}}),e)})))()}),[]);var _=A||E||N||V,O=(0,g.useMemo)((function(){var e;return!!u&&new F.kL(i.address).toString(!0,!0,!0)==(null===(e=u.ownerAddress)||void 0===e?void 0:e.toString(!0,!0,!0))}),[i,u]),$=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(),O&&u){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,K({nftAddress:s.address,nftData:u,state:m,collection:y});case 5:v.L2.message("approveRequest",{id:n,payload:void 0}),a();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]);return _?(0,J.jsx)(Z.g,{}):null==u?(0,J.jsx)(Z.D,{button:"Close",action:G,children:(0,J.jsx)(w.Bc,{children:"NFT Data is not define"})}):(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Add Suggested NFT"}),(0,J.jsx)(w.xv,{children:"Would you like to import these NFT?"})]}),(0,J.jsx)(z.K,{state:m}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:G,disabled:_,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:$,disabled:_||I||!O,children:O?"Add NFT":"Another's NFT"})]})]})},W=t(69632),H=t(36794),V=t(36292),_=t(29701),O=t(88238),$=t(2826),G=t.n($),Y=t(60731),X=function(e){var n=(0,g.useContext)(q.hi),t=(0,g.useContext)(q.RJ);return(0,y.a)([e,D.xL.publicKey],(0,p.Z)((0,f.Z)().mark((function r(){var s,a,i;return(0,f.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return",t.address);case 2:return r.next=4,(0,k.n_)(n,(0,F.K9)(e));case 4:return s=r.sent,a=(0,h.Z)(s,2),a[0],i=a[1],r.abrupt("return",i.toString(!0,!0,!0));case 9:case"end":return r.stop()}}),r)}))))},ee=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]),o=function(){var e=(0,g.useContext)(q.RJ);return(0,L.D)(function(){var n=(0,p.Z)((0,f.Z)().mark((function n(t){var r,s,a,i,o,c,u;return(0,f.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.message){n.next=2;break}throw new Error("Missing decrypt message");case 2:return n.next=4,(0,N.nC)(e);case 4:return r=n.sent,s=(0,Y.decodeBase64)(t.message),a=s.slice(0,G().box.nonceLength),i=s.slice(G().box.nonceLength,s.length),o=t.senderPublicKey?(0,F.K9)(t.senderPublicKey):r.publicKey,n.next=11,(0,O.ZV)((0,F.ci)(r.secretKey.slice(0,32)),(0,F.ci)(o));case 11:if(c=n.sent,u=G().box.open.after(i,a,c)){n.next=15;break}throw new Error("Decryption error");case 15:return n.abrupt("return",(0,Y.encodeBase64)(u));case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}(),c=o.isLoading,u=o.mutateAsync,l=X(s.senderPublicKey),d=l.isLoading,x=l.data,h=(0,_.ih)().data,m="webauthn"==(null===h||void 0===h?void 0:h.kind),j=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({message:s.message,senderPublicKey:s.senderPublicKey});case 2:t=e.sent,v.L2.message("approveRequest",{id:n,payload:t}),a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Decrypt message"}),(0,J.jsx)(w.xv,{children:"Would you like to decrypt message?"})]}),(0,J.jsx)(H.p,{label:"Sender",address:x}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:i,disabled:c,children:"Cancel"}),(0,J.jsxs)(w.zQ,{onClick:j,disabled:c||d,children:["Decrypt ",m&&(0,J.jsx)(V.hY,{})]})]})]})},ne=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]),o=function(){var e=(0,g.useContext)(q.RJ);return(0,L.D)(function(){var n=(0,p.Z)((0,f.Z)().mark((function n(t){var r,s,a,i,o,c;return(0,f.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t&&void 0!==t&&t.message){n.next=2;break}throw new Error("Missing encrypt message");case 2:return n.next=4,(0,N.nC)(e);case 4:return r=n.sent,s=(0,$.randomBytes)(G().box.nonceLength),a=(0,F.K9)(t.message),i=t.receiverPublicKey?(0,F.K9)(t.receiverPublicKey):r.publicKey,n.next=10,(0,O.ZV)((0,F.ci)(r.secretKey.slice(0,32)),(0,F.ci)(i));case 10:if(o=n.sent,c=G().box.after(a,s,o)){n.next=14;break}throw new Error("Encryption error");case 14:return n.abrupt("return",(0,Y.encodeBase64)((0,F.eV)(s,c)));case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}(),c=o.isLoading,u=o.mutateAsync,l=X(s.receiverPublicKey),d=l.isLoading,x=l.data,h=(0,_.ih)().data,m="webauthn"==(null===h||void 0===h?void 0:h.kind),j=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({message:s.message,receiverPublicKey:s.receiverPublicKey});case 2:t=e.sent,v.L2.message("approveRequest",{id:n,payload:t}),a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Encrypt message"}),(0,J.jsx)(w.xv,{children:"Would you like to encrypt data?"})]}),(0,J.jsx)(H.p,{label:"Receiver",address:x}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:i,disabled:c,children:"Cancel"}),(0,J.jsxs)(w.zQ,{onClick:j,disabled:c||d,children:["Encrypt ",m&&(0,J.jsx)(V.hY,{})]})]})]})},te=t(14565),re=t(42732),se=t(67064),ae=t(74386),ie=t(97463),oe=t(66627),ce=t(73132),ue=t(5885),le=t(89491),de=t(19778).Buffer,xe=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(n,t,r){var s,a,i,o,c,u,l,d,x;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,oe.$8)(t),a=n.open(s),e.next=4,a.getBalance();case 4:return i=e.sent,o=r.address,r.initialCode,r.initialData,c=r.initialMessage,u=r.amount,(0,N.Ux)(i.toString(),r.amount),e.next=9,a.getSeqno();case 9:return l=e.sent,d=(0,ue.BH)(t,l,o,{amount:(0,R.fromNano)(u)},c),e.next=13,(0,le.x$)(d);case 13:return x=e.sent,e.next=16,a.send(x);case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),fe=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(n,t,r){var s,a,i,o,c,u,l,d,x,p,h,g;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ce.Ny)(r.address);case 2:return e.next=4,(0,N.nC)(t);case 4:return s=e.sent,a=de.from(s.secretKey),i=(0,oe.$8)(t),o=n.open(i),e.next=10,o.getBalance();case 10:return c=e.sent,u=r.address,l=r.initialCode,d=r.initialData,x=r.initialMessage,p=r.amount,(0,N.Ux)(c.toString(),p),e.next=15,o.getSeqno();case 15:return h=e.sent,g=(0,ue.ei)(h,t,u,{amount:(0,R.fromNano)(p)},x,{code:l,data:d},a),e.next=19,o.send(g);case 19:return e.abrupt("return",h);case 20:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),pe=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=(0,g.useContext)(q.RJ),o=(0,g.useContext)(q.J5),c=(0,g.useMemo)((function(){return function(e,n){var t=e.initDataCell,r=e.initCodeCell,s=e.workchain,a=e.amount,i=e.initMessageCell,o=R.Cell.fromBoc(de.from(t,"hex")),c=(0,h.Z)(o,1)[0],u=R.Cell.fromBoc(de.from(r,"hex")),l=(0,h.Z)(u,1)[0];return{workchain:null!==s&&void 0!==s?s:0,initialData:c,initialCode:l,address:(0,oe.CR)({workchain:null!==s&&void 0!==s?s:0,data:c,code:l}).toString({testOnly:"testnet"===n}),amount:a,initialMessage:i?R.Cell.fromBoc(de.from(i,"hex"))[0]:void 0}}(s,o)}),[s,o]),u=function(e){var n=(0,g.useContext)(q.LQ),t=(0,g.useContext)(q.RJ);return(0,y.a)([D.xL.estimation,e],(0,p.Z)((0,f.Z)().mark((function r(){var s,a,i,o,c,u,l;return(0,f.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.address,a=e.initialCode,i=e.initialData,o=e.initialMessage,c=e.amount,u=(0,ue.ei)(0,t,s,{amount:(0,R.fromNano)(c)},o,{code:a,data:i}),r.next=4,n.estimateExternalMessageFee(R.Address.parse(t.address),{body:u,initCode:null,initData:null,ignoreSignature:!0});case 4:return l=r.sent,r.abrupt("return",l.source_fees);case 6:case"end":return r.stop()}}),r)}))))}(c),l=u.data,d=function(e){var n=(0,g.useContext)(q.LQ),t=(0,g.useContext)(q.RJ);return(0,L.D)((function(){return t.ledger?xe(n,t,e):fe(n,t,e)}))}(c),x=d.mutateAsync,m=d.isLoading,j=d.error,Z=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t,r;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:t=e.sent,r={walletSeqNo:t,newContractAddress:c.address.toString()},v.L2.message("approveRequest",{id:n,payload:r}),a();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=m;return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Deploy Smart Contract"}),(0,J.jsx)(w.xv,{children:"Would you like to deploy contract?"})]}),(0,J.jsx)(te.e,{left:i.name,right:c.address.toString()}),(0,J.jsx)(w.bi,{children:"Forward amount:"}),(0,J.jsx)(w.bi,{children:(0,J.jsxs)("b",{children:[(0,F.T6)(s.amount)," ION"]})}),(0,J.jsx)(ae.M,{estimation:l}),(0,J.jsx)(re.d,{label:"Initial Code",children:s.initCodeCell}),(0,J.jsx)(re.d,{label:"Initial Data",children:s.initDataCell}),s.initMessageCell&&(0,J.jsx)(re.d,{label:"Initial Message",children:s.initMessageCell}),j&&(0,J.jsx)(w.Bc,{children:j.message}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:function(){v.L2.message("rejectRequest",n),a()},disabled:C,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:Z,disabled:C||null!=j,children:m?(0,J.jsx)(se.b,{children:"Deploying"}):(0,J.jsx)(ie.U,{children:"Deploy"})})]})]})},he=t(15671),ge=t(43144),me=t(60136),ve=t(29388),je=function(e){(0,me.Z)(t,e);var n=(0,ve.Z)(t);function t(){var e;(0,he.Z)(this,t);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return(e=n.call.apply(n,[this].concat(s))).state={hasError:!1},e}return(0,ge.Z)(t,[{key:"componentDidCatch",value:function(e,n){console.error("Uncaught error:",e,n)}},{key:"render",value:function(){return this.state.hasError?(0,J.jsx)(Z.D,{action:this.props.onClose,button:"Cancel",children:this.state.error&&(0,J.jsx)(w.Bc,{children:this.state.error.message})}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),t}(g.Component),Ze=t(12267),we=t(19778).Buffer,be=function(e){if(e.data)switch(e.dataType){case"hex":return R.Cell.fromBoc(we.from(e.data,"hex"))[0];case"base64":return(0,R.beginCell)().storeBuffer(we.from(e.data,"base64")).endCell();case"boc":return R.Cell.fromBase64(e.data);default:return e.data}},Ce=function(e){var n,t=e.id,r=e.logo,s=e.origin,a=e.data,i=e.onClose,o=(0,g.useContext)(q.RJ),c=(n=a,(0,y.a)([D.xL.transactions,n],(function(){return{address:n.to,amount:(0,R.fromNano)(n.value),max:"0",data:be(n),hex:n.data}}))),u=c.data,l=c.isFetching,d=(0,Ze.HI)(a.to),x=d.data,h=d.error,m=d.isFetching,j=(0,Ze.pQ)(),C=j.mutateAsync,k=j.error,S=j.isLoading,L=(0,Ze.Tf)(u,x).data,A=l||m,M=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var n;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x&&u){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C({address:x,state:u});case 4:n=e.sent,v.L2.message("approveRequest",{id:t,payload:n}),i();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(!u)return(0,J.jsx)(Z.g,{});var B=A||S,E=B&&null==h&&null==k,T=B||null!=h||null!=k;return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:r,origin:s}),(0,J.jsx)(w.H1,{children:"Send Transaction"}),(0,J.jsx)(w.xv,{children:"Would you like to send transaction?"})]}),(0,J.jsx)(te.e,{left:o.name,right:a.to}),(0,J.jsxs)(w.bi,{children:["SENDING: (",s,")"]}),(0,J.jsx)(w.bi,{children:(0,J.jsxs)("b",{children:[u.amount," ION"]})}),(0,J.jsx)(ae.M,{estimation:L}),u.hex&&(0,J.jsx)(re.d,{label:"Payload",children:u.hex}),h&&(0,J.jsx)(w.Bc,{children:h.message}),k&&(0,J.jsx)(w.Bc,{children:k.message}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:function(){v.L2.message("rejectRequest",t),i()},disabled:E,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:M,disabled:T,children:A?(0,J.jsx)(se.b,{children:"Validating"}):S?(0,J.jsx)(se.b,{children:"Sending"}):(0,J.jsx)(ie.U,{children:"Confirm"})})]})]})},ke=t(19778).Buffer,ye=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=function(){var e=(0,g.useContext)(q.RJ);return(0,L.D)(function(){var n=(0,p.Z)((0,f.Z)().mark((function n(t){var r,s,a,i;return(0,f.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}throw new Error("Missing sign data");case 2:if(!((r=G().hash(ke.from(t,"utf8"))).length+"ton-safe-sign-magic".length>=127)){n.next=5;break}throw new Error("Too large personal message");case 5:return s=ke.concat([ke.from([255,255]),ke.from("ton-safe-sign-magic"),r]).toString("hex"),n.next=8,(0,N.nC)(e);case 8:return a=n.sent,i=G().sign.detached((0,F.nr)(s),a.secretKey),n.abrupt("return",(0,F.ci)(i));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}(),o=i.mutateAsync,c=i.isLoading,u=i.error,l=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]),d=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(s.data);case 2:t=e.sent,v.L2.message("approveRequest",{id:n,payload:t}),a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Personal Sign"}),(0,J.jsx)(w.xv,{children:"Would you like to sign data?"})]}),(0,J.jsx)(re.d,{label:"Message",children:s.data}),u&&(0,J.jsx)(w.Bc,{children:u.message}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:l,disabled:c,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:d,disabled:c,children:"Sign"})]})]})},Se=t(84101),Le=function(){return Se.Z.openTab({url:"https://consensys.net/blog/metamask/the-seal-of-approval-know-what-youre-consenting-to-with-permissions-and-approvals-in-metamask/"})},Re=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data,a=e.onClose,i=function(){var e=(0,g.useContext)(q.RJ);return(0,L.D)(function(){var n=(0,p.Z)((0,f.Z)().mark((function n(t){var r,s;return(0,f.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}throw new Error("Missing sign data");case 2:return n.next=4,(0,N.nC)(e);case 4:return r=n.sent,s=G().sign.detached((0,F.nr)(t),r.secretKey),n.abrupt("return",(0,F.ci)(s));case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}(),o=i.mutateAsync,c=i.isLoading,u=i.error,l=(0,g.useCallback)((function(){v.L2.message("rejectRequest",n),a()}),[n]),d=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(s.data);case 2:t=e.sent,v.L2.message("approveRequest",{id:n,payload:t}),a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Raw Sign"}),(0,J.jsx)(w.xv,{children:"Would you like to sign raw data?"})]}),(0,J.jsxs)(w.jB,{children:["Signing this message can be dangerous.",(0,J.jsx)("br",{}),(0,J.jsx)("br",{})," This signature could potentially perform any operation on your account's behalf, including granting complete control of your account and all of its assets to the requesting site. Only sign this message if you know what you're doing or completely trust the requesting site."," ",(0,J.jsxs)(w.Un,{onClick:Le,children:["Learn more ",(0,J.jsx)(V.xP,{})]})]}),(0,J.jsx)(re.d,{label:"Message",children:s.data}),u&&(0,J.jsx)(w.Bc,{children:u.message}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:l,disabled:c,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:d,disabled:c,children:"Sign"})]})]})},Ae=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.data.network,a=e.onClose,i=(0,g.useContext)(q.J5),o=(0,L.D)(function(){var e=(0,p.Z)((0,f.Z)().mark((function e(n){var t,r;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.id,r=n.network,e.next=3,(0,D.ZQ)(D.xL.network,r);case 3:v.L2.message("chainChanged",r),v.L2.message("approveRequest",{id:t,payload:void 0});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),c=o.mutateAsync,u=o.isLoading,l=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({id:n,network:s});case 2:a();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Switch wallet network"}),(0,J.jsx)(w.xv,{children:"Allow this site to switch the network?"}),(0,J.jsx)(w.xv,{children:"This will switch the OpenMask network:"})]}),(0,J.jsx)(te.e,{left:i,right:s}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.z4,{children:[(0,J.jsx)(w.E0,{onClick:function(){v.L2.message("rejectRequest",n),a()},disabled:u,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:l,disabled:u,children:"Switch"})]})]})},Me=t(30168),Be=t(16444),Ee=t(54481),Te=t(37762),De=t(70156),qe=t(84471),Ne=t(23027),Qe=t(2633),Je=t(62109),Ke=t(83061),Pe=function(e,n,t){var r=t.payload?R.Cell.fromBase64(t.payload):void 0;if(!r)return(0,ue.BH)(e,n,t.address,{amount:(0,R.fromNano)(t.amount)},r);var s=(0,oe.$8)(e);switch(r.asSlice().loadUint(32)){case Ke.cT:var a=(0,Ke.Yx)(r);return(0,Ke.hm)(t.address,BigInt(t.amount),n,s.init,a);case Je.QF:var i=(0,Je.Nk)(r);return(0,Je.$z)(R.Address.parse(t.address),BigInt(t.amount),n,s.init,i);default:throw new Error("App Ledger 2.0 is not support custom transaction")}},Fe=t(96200),ze=t(19778).Buffer,Ue=function(e,n,t){var r=Math.round(Date.now()/1e3),s=ze.allocUnsafe(8);s.writeBigInt64LE(BigInt(r));var a=ze.from(new URL(e).host),i=ze.allocUnsafe(4);i.writeInt32LE(a.byteLength);var o=R.Address.parse(n),c=ze.allocUnsafe(4);c.writeInt32BE(o.workChain);var u=ze.concat([c,o.hash]),l=ze.concat([ze.from("ton-proof-item-v2/","utf8"),u,i,a,s,ze.from(t)]);return{timestamp:r,bufferToSign:ze.concat([ze.from("ffff","hex"),ze.from("ton-connect","utf8"),ze.from((0,De.sha256_sync)(l))]),domainBuffer:a,payload:t,origin:e}},Ie=function(e,n){return{name:"ton_proof",proof:{timestamp:e.timestamp,domain:{lengthBytes:e.domainBuffer.byteLength,value:e.domainBuffer.toString("utf8")},signature:n.toString("base64"),payload:e.payload}}},We=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(n,t){var r,s;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.nC)(t);case 2:return r=e.sent,s=G().sign.detached(ze.from((0,De.sha256_sync)(n.bufferToSign)),r.secretKey),e.abrupt("return",Ie(n,ze.from(s)));case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),He=function(e){var n=(0,g.useContext)(q.RJ),t=(0,g.useContext)(q.LQ);return(0,y.a)([D.xL.estimation,e],(0,p.Z)((0,f.Z)().mark((function r(){var s,a;return(0,f.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=(0,ue.$2)(n,0,e.messages),r.next=3,t.estimateExternalMessageFee(R.Address.parse(n.address),{body:s,initCode:null,initData:null,ignoreSignature:!0});case 3:return a=r.sent,r.abrupt("return",a.source_fees);case 5:case"end":return r.stop()}}),r)}))))},Ve=Be.ZP.label(r||(r=(0,Me.Z)(["\n  display: flex;\n  gap: ",";\n  margin: 5px ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.padding}),(function(e){return e.theme.padding}),(function(e){return e.theme.darkGray})),_e=Be.ZP.div(s||(s=(0,Me.Z)(["\n  overflow: hidden;\n  flex-grow: 1;\n  padding: 5px;\n"]))),Oe=Be.ZP.div(a||(a=(0,Me.Z)(["\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  line-height: 18px;\n"]))),$e=(0,Be.ZP)(Oe)(i||(i=(0,Me.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.darkGray})),Ge=Be.ZP.span(o||(o=(0,Me.Z)(["\n  margin-left: ",";\n  border: 1px solid ",";\n  background: ",";\n  padding: 0px 8px;\n  border-radius: 20px;\n"])),(function(e){return e.theme.padding}),(function(e){return e.theme.darkGray}),(function(e){return e.theme.lightGray})),Ye=function(e){var n=e.wallet,t=e.selected,r=e.onSelect,s=(0,Ee.KQ)(n.address).data;return(0,J.jsxs)(Ve,{children:[(0,J.jsx)("input",{type:"radio",checked:t,onChange:function(){return r(n.address)}}),(0,J.jsxs)(_e,{children:[(0,J.jsxs)(Oe,{children:[(0,J.jsx)("b",{children:n.name}),n.ledger&&(0,J.jsx)(Ge,{children:"Ledger"})]}),(0,J.jsx)(Oe,{children:n.address}),(0,J.jsxs)($e,{children:[s?(0,k.WT)(s):"-"," ION"]})]})]},n.address)},Xe=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.onClose,a=e.data,i=(0,g.useContext)(q.Qu),o=(0,g.useState)(i.activeWallet),c=(0,h.Z)(o,2),u=c[0],l=c[1],d=function(){var e=(0,g.useContext)(q.J5),n=(0,g.useContext)(q.lp),t=(0,g.useContext)(q.Qu);return(0,L.D)(function(){var r=(0,p.Z)((0,f.Z)().mark((function r(s){var a,i,o,c,u,l,d,x,p,h,g,m,j,Z,w,b,C;return(0,f.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=s.origin,i=s.wallet,o=s.id,c=s.logo,u=s.data,l=(0,Ne.aX)(e,n),d=t.wallets.find((function(e){return e.address===i})),d){r.next=5;break}throw new Error("Unexpected wallet state");case 5:x=(0,oe.$8)(d),p=(0,R.beginCell)().storeWritable((0,R.storeStateInit)(x.init)).endCell(),h=new R.Address(x.workchain,p.hash()),g=[],m=(0,Te.Z)(u.items),r.prev=10,m.s();case 12:if((j=m.n()).done){r.next=32;break}if("ton_addr"!==(Z=j.value).name){r.next=19;break}w={name:"ton_addr",address:h.toRawString(),network:l.id,walletStateInit:p.toBoc({idx:!0,crc32:!0}).toString("base64")},g.push(w),r.next=30;break;case 19:if("ton_proof"!==Z.name){r.next=30;break}if(b=Ue(a,d.address,Z.payload),!d.ledger){r.next=25;break}throw new Error("Not implemented");case 25:return r.t0=g,r.next=28,We(b,d);case 28:r.t1=r.sent,r.t0.push.call(r.t0,r.t1);case 30:r.next=12;break;case 32:r.next=37;break;case 34:r.prev=34,r.t2=r.catch(10),m.e(r.t2);case 37:return r.prev=37,m.f(),r.finish(37);case 40:return r.next=42,(0,D.E6)(e);case 42:return C=r.sent,(0,Fe.X9)(C,c,a,[i],[Qe.y.base]),r.next=46,(0,D.FY)(C,e);case 46:v.L2.message("approveRequest",{id:o,payload:g});case 47:case"end":return r.stop()}}),r,null,[[10,34,37,40]])})));return function(e){return r.apply(this,arguments)}}())}(),x=d.mutateAsync,m=d.isLoading;(0,g.useEffect)((function(){r||(v.L2.message("rejectRequest",n),s())}),[]);var j=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,x({id:n,origin:r,wallet:u,logo:null!==t&&void 0!==t?t:null,data:a});case 4:s();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=(0,g.useMemo)((function(){return i.wallets.filter((function(e){return e.address===u}))}),[i,u]),C=(0,h.Z)(Z,1)[0],k=(0,g.useMemo)((function(){return a.items.some((function(e){return"ton_proof"===e.name}))}),[a]),y=m||k&&!!C.ledger;return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:"Connect with ION Wallet"}),(0,J.jsx)(w.xv,{children:"Select the account(s) to use on this site"})]}),(0,J.jsx)(w.Xs,{children:i.wallets.map((function(e){return(0,J.jsx)(Ye,{wallet:e,selected:u===e.address,onSelect:l},e.address)}))}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.z4,{children:[(0,J.jsx)(w.E0,{onClick:function(){v.L2.message("rejectRequest",n),s()},disabled:m,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:j,disabled:y,children:m?(0,J.jsx)(se.b,{children:"Loading"}):(0,J.jsx)(ie.V,{isSignature:k,wallet:C,children:k&&C.ledger?"Not Supported":"Connect"})})]})]})},en=Be.ZP.div(c||(c=(0,Me.Z)(["\n  display: flex;\n  gap: ",";\n  margin: 5px ",";\n  border-bottom: 1px solid ",";\n  align-items: center;\n"])),(function(e){return e.theme.padding}),(function(e){return e.theme.padding}),(function(e){return e.theme.darkGray})),nn=Be.ZP.div(u||(u=(0,Me.Z)(["\n  margin: 5px ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.padding}),(function(e){return e.theme.darkGray})),tn=Be.ZP.span(l||(l=(0,Me.Z)(["\n  font-size: 200%;\n"]))),rn=Be.ZP.span(d||(d=(0,Me.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.blueTon})),sn=function(e){var n=e.message,t=(0,g.useMemo)((function(){if(n.payload)try{switch(R.Cell.fromBase64(n.payload).asSlice().loadUint(32)){case 1607220500:return"NFT Transfer";case 260734629:return"Jetton Transfer";default:return}}catch(e){return}}),[n]);return(0,J.jsxs)(en,{children:[(0,J.jsx)(tn,{children:n.isConfirmed?(0,J.jsx)(rn,{children:(0,J.jsx)(V.nQ,{})}):n.isSend?(0,J.jsx)(rn,{children:(0,J.jsx)(V.L4,{})}):(0,J.jsx)(V.wZ,{})}),(0,J.jsxs)("div",{children:[(0,J.jsxs)(w.bi,{children:[null!==t&&void 0!==t?t:"SENDING",":"]}),(0,J.jsxs)(w.bi,{children:[(0,J.jsxs)("b",{children:[(0,k.WT)(String(n.amount))," ION"]})," to"," ",(0,k.QJ)(n.address||"",6)]})]})]})},an=function(e){var n=e.data,t=e.onCancel,r=e.onOk,s=(0,g.useState)(!1),a=(0,h.Z)(s,2),i=a[0],o=a[1],c=(0,g.useState)(1==n.messages.length),u=(0,h.Z)(c,2),l=u[0],d=u[1],m=(0,g.useState)(n.messages),j=(0,h.Z)(m,2),Z=j[0],b=j[1],C=(0,g.useState)(null),k=(0,h.Z)(C,2),y=k[0],S=k[1],A=function(){var e=(0,g.useContext)(q.RJ),n=(0,g.useContext)(q.LQ);return(0,L.D)((0,p.Z)((0,f.Z)().mark((function t(){var r,s,a;return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getTransactions(R.Address.parse(e.address),{limit:1});case 2:return r=t.sent,s=(0,h.Z)(r,1),a=s[0],t.abrupt("return",a.stateUpdate.newHash.toString());case 6:case"end":return t.stop()}}),t)}))))}().mutateAsync,M=He(n).data,B=function(){var e=(0,g.useContext)(q.RJ),n=(0,g.useContext)(q.LQ);return(0,L.D)(function(){var t=(0,p.Z)((0,f.Z)().mark((function t(r){var s,a,i,o,c;return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=(0,oe.$8)(e),a=n.open(s),t.next=4,a.getSeqno();case 4:return i=t.sent,o=Pe(e,i,r),t.next=8,(0,le.x$)(o);case 8:return c=t.sent,t.next=11,a.send(c);case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}(),E=B.mutateAsync,T=B.reset,D=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var n,t,s;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(!0),e.prev=1,n=(0,f.Z)().mark((function e(n){var t,r;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Z[n]).isConfirmed){e.next=3;break}return e.abrupt("return","continue");case 3:return T(),b((function(e){return e.map((function(e){return e===t?t=(0,x.Z)((0,x.Z)({},t),{},{isSend:!0}):e}))})),e.next=7,E(t);case 7:if(r=e.sent,n===Z.length-1){e.next=11;break}return e.next=11,(0,v.ZC)(6e4).message("confirmSeqNo",r);case 11:b((function(e){return e.map((function(e){return e===t?t=(0,x.Z)((0,x.Z)({},t),{},{isConfirmed:!0}):e}))}));case 12:case"end":return e.stop()}}),e)})),t=0;case 4:if(!(t<Z.length)){e.next=12;break}return e.delegateYield(n(t),"t0",6);case 6:if("continue"!==e.t0){e.next=9;break}return e.abrupt("continue",9);case 9:t++,e.next=4;break;case 12:return e.next=14,A().catch((function(){return""}));case 14:s=e.sent,r(s),e.next=23;break;case 18:e.prev=18,e.t1=e.catch(1),S(e.t1),o(!1),b((function(e){return e.map((function(e){return e.isConfirmed?e:(0,x.Z)((0,x.Z)({},e),{},{isSend:!1})}))}));case 23:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}();if(!l)return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(nn,{children:[(0,J.jsx)(w.xv,{children:"The Ton Ledger App version 2.0 does not support sending multiple transfers per transaction."}),(0,J.jsx)(w.xv,{children:"You may sign and send multiple transfers one by one."}),(0,J.jsx)(w.xv,{children:"Please do not interrupt the execution of transactions to get multiple transfer expected result."})]}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:t,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:function(){return d(!0)},children:"Agree"})]})]});var N=i,Q=i;return(0,J.jsxs)(J.Fragment,{children:[Z.map((function(e,n){return(0,J.jsx)(sn,{message:e},n)})),M&&(0,J.jsx)(en,{children:(0,J.jsx)(ae.M,{estimation:M})}),(0,J.jsx)(w.Zv,{}),y&&(0,J.jsx)(w.Bc,{children:y.message}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:t,disabled:N,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:D,disabled:Q,children:i?(0,J.jsx)(se.b,{children:"Sending"}):(0,J.jsx)(ie.U,{children:"Continue"})})]})]})},on=function(e){var n=e.data,t=e.origin,r=e.onCancel,s=e.onOk,a=(0,g.useState)(!1),i=(0,h.Z)(a,2),o=i[0],c=i[1],u=(0,g.useState)(n.messages),l=(0,h.Z)(u,2),d=l[0],m=l[1],v=(0,g.useState)(null),j=(0,h.Z)(v,2),Z=j[0],b=j[1],C=He(n).data,k=function(e){var n=(0,g.useContext)(q.RJ),t=(0,g.useContext)(q.LQ);return(0,L.D)(function(){var r=(0,p.Z)((0,f.Z)().mark((function r(s){var a,i,o,c,u,l,d,x;return(0,f.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(Date.now()/1e3>s.valid_until)){r.next=3;break}throw new Error("Transaction expired");case 3:return r.next=5,(0,ce.it)(e,s.messages);case 5:return r.next=7,(0,N.nC)(n);case 7:return a=r.sent,i=(0,oe.$8)(n),o=t.open(i),r.next=12,o.getSeqno();case 12:return c=r.sent,r.next=15,o.getBalance();case 15:return u=r.sent,l=s.messages.reduce((function(e,n){return e.plus(n.amount)}),new qe.Z("0")),r.next=19,(0,N.Ux)(u.toString(),l);case 19:return d=(0,ue.$2)(n,c,s.messages,ze.from(a.secretKey)),r.next=22,o.send(d);case 22:return x=(0,R.beginCell)().storeWritable((0,R.storeMessage)((0,R.external)({to:o.address,init:0===c?o.init:void 0,body:d}))).endCell().toBoc({idx:!1}).toString("base64"),r.abrupt("return",x);case 24:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}(t),y=k.mutateAsync,S=k.reset,A=k.error,M=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(){var t;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,S(),m((function(e){return e.map((function(e){return(0,x.Z)((0,x.Z)({},e),{},{isSend:!0})}))})),e.next=6,y(n);case 6:t=e.sent,m((function(e){return e.map((function(e){return(0,x.Z)((0,x.Z)({},e),{},{isConfirmed:!0})}))})),s(t),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),b(e.t0),c(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),B=o,E=o||null!=Z;return(0,J.jsxs)(J.Fragment,{children:[d.map((function(e,n){return(0,J.jsx)(sn,{message:e},n)})),C&&(0,J.jsx)(en,{children:(0,J.jsx)(ae.M,{estimation:C})}),A&&(0,J.jsx)(w.Bc,{children:A.message}),Z&&(0,J.jsx)(w.Bc,{children:Z.message}),(0,J.jsx)(w.Zv,{}),(0,J.jsxs)(w.VR,{children:[(0,J.jsx)(w.E0,{onClick:r,disabled:B,children:"Cancel"}),(0,J.jsx)(w.zQ,{onClick:M,disabled:E,children:o?(0,J.jsx)(se.b,{children:"Sending"}):(0,J.jsx)(ie.U,{children:"Confirm"})})]})]})},cn=function(e){var n=e.id,t=e.logo,r=e.origin,s=e.onClose,a=e.data,i=(0,g.useContext)(q.RJ),o=function(){v.L2.message("rejectRequest",n),s()},c=function(){var e=(0,p.Z)((0,f.Z)().mark((function e(t){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.L2.message("approveRequest",{id:n,payload:t}),e.next=3,(0,m.gw)(500);case 3:s();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,J.jsxs)(w.uT,{children:[(0,J.jsxs)(w.M5,{children:[(0,J.jsx)(b.g,{logo:t,origin:r}),(0,J.jsx)(w.H1,{children:a.messages.length>1?"Send ".concat(a.messages.length," Transactions"):"Send Transaction"}),(0,J.jsx)(w.xv,{children:"Would you like to send transaction?"})]}),i.ledger?(0,J.jsx)(an,{data:a,onCancel:o,onOk:c}):(0,J.jsx)(on,{data:a,origin:r,onCancel:o,onOk:c})]})},un=function(){var e=(0,g.useState)(void 0),n=(0,h.Z)(e,2),t=n[0],r=n[1],s=(0,g.useCallback)((0,p.Z)((0,f.Z)().mark((function e(){var n,t,s=arguments;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(s.length>0&&void 0!==s[0])||s[0],r(void 0),!n){e.next=5;break}return e.next=5,(0,m.gw)(200);case 5:return e.prev=5,e.next=8,(0,v.ZC)().message("getNotification");case 8:(t=e.sent)?r(t):v.L2.message("closePopUp"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),v.L2.message("closePopUp");case 15:case"end":return e.stop()}}),e,null,[[5,12]])}))),[]);if((0,g.useEffect)((function(){s(!1)}),[]),(0,j.ay)(t),!t)return(0,J.jsx)(Z.g,{});var a=function(){switch(t.kind){case"deploy":return(0,J.jsx)(pe,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"rawSign":return(0,J.jsx)(Re,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"personalSign":return(0,J.jsx)(ye,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"switchNetwork":return(0,J.jsx)(Ae,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"importJetton":return(0,J.jsx)(P,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"importNft":return(0,J.jsx)(I,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"connectDApp":return(0,J.jsx)(W.Mz,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"sendTransaction":return(0,J.jsx)(Ce,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"tonConnectRequest":return(0,J.jsx)(Xe,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"tonConnectSend":return(0,J.jsx)(cn,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"decryptMessage":return(0,J.jsx)(ee,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));case"encryptMessage":return(0,J.jsx)(ne,(0,x.Z)((0,x.Z)({},t),{},{onClose:s}));default:return(0,J.jsx)(Z.g,{})}}();return(0,J.jsx)(je,{onClose:function(){v.L2.message("rejectRequest",t.id),s()},children:a})},ln=un}}]);
//# sourceMappingURL=338.5ae6852d.chunk.js.map