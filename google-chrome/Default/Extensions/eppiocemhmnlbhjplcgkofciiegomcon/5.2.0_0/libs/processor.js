/*! For license information please see processor.js.LICENSE.txt */
(()=>{var e={263:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataReader=void 0;const c=a(n(19466));t.MetadataReader=class{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect.getMetadata(c.DESIGN_PARAM_TYPES,e)??[],userGeneratedMetadata:Reflect.getMetadata(c.TAGGED,e)??{}}}getPropertiesMetadata(e){return Reflect.getMetadata(c.TAGGED_PROP,e)??{}}}},686:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CURRENCY_LIST=void 0;const r=n(64434);t.DEFAULT_CURRENCY_LIST=(0,r.deepFreeze)({$:{name:"U.S. Dollar",currency:"USD"},US$:{name:"U.S. Dollar",currency:"USD"},$US:{name:"U.S. Dollar",currency:"USD"},USD:{name:"U.S. Dollar",currency:"USD"},AED:{name:"Arab Emirates Dirham",currency:"AED"},درهم:{name:"Arab Emirates Dirham",currency:"AED"},ARS:{name:"Argentine Peso",currency:"ARS"},AMD:{name:"Armenian Dram",currency:"AMD"},AWG:{name:"Aruban Florin",currency:"AWG"},A$:{name:"Australian Dollar",currency:"AUD"},AU$:{name:"Australian Dollar",currency:"AUD"},AUD:{name:"Australian Dollar",currency:"AUD"},AZN:{name:"Azerbaijan New Manat",currency:"AZN"},BSD:{name:"Bahamas Dollar",currency:"BSD"},BZD:{name:"Belize Dollar",currency:"BZD"},BOB:{name:"Bolivian Boliviano",currency:"BOB"},R$:{name:"Brazilian Real",currency:"BRL"},BRL:{name:"Brazilian Real",currency:"BRL"},BND:{name:"Bruneian Dollar",currency:"BND"},BGN:{name:"Bulgaria Lev",currency:"BGN"},KHR:{name:"Cambodian Riel",currency:"KHR"},KYD:{name:"Caymanian Dollar",currency:"KYD"},KYD$:{name:"Caymanian Dollar",currency:"KYD"},CI$:{name:"Caymanian Dollar",currency:"KYD"},CLP:{name:"Chilean Peso",currency:"CLP"},"CN¥":{name:"Chinese Yuan Renminbi",currency:"CNY"},CNY:{name:"Chinese Yuan Renminbi",currency:"CNY"},COP:{name:" Colombian Peso",currency:"COP"},CRC:{name:"Costa Rican Colon",currency:"CRC"},DOP:{name:"Dominican Republic Peso",currency:"DOP"},EC$:{name:"East Caribbean Dollar",currency:"XCD"},XCD:{name:"East Caribbean Dollar",currency:"XCD"},EGP:{name:"Egyptian Pound",currency:"EGP"},جنيه:{name:"Egyptian Pound",currency:"EGP"},"€":{name:"Euro",currency:"EUR"},EUR:{name:"Euro",currency:"EUR"},GHS:{name:"Ghanaian Cedi",currency:"GHS"},GTQ:{name:"Guatemalan Quetzal",currency:"GTQ"},HNL:{name:"Honduran Lempira",currency:"HNL"},HK$:{name:"Honduran Lempira",currency:"HKD"},HKD:{name:"Honduran Lempira",currency:"HKD"},HUF:{name:"Hungarian Forint",currency:"HUF"},"₹":{name:"Indian Rupee",currency:"INR"},INR:{name:"Indian Rupee",currency:"INR"},Rs:{name:"Indian Rupee",currency:"INR"},IDR:{name:"Indonesian Rupiah",currency:"IDR"},"₪":{name:"Israeli Shekel",currency:"ILS"},ILS:{name:"Israeli Shekel",currency:"ILS"},JMD:{name:"Jamaican Dollar",currency:"JMD"},"¥":{name:"Japanese Yen",currency:"JPY"},JPY:{name:"Japanese Yen",currency:"JPY"},"JP¥":{name:"Japanese Yen",currency:"JPY"},"￥":{name:"Japanese Yen",currency:"JPY"},円:{name:"Japanese Yen",currency:"JPY"},KZT:{name:"Kazakhstan Tenge",currency:"KZT"},KES:{name:"Kenyan Shilling",currency:"KES"},LBP:{name:"Lebanese Pound",currency:"LBP"},MOP:{name:"Macanese Pataca",currency:"MOP"},MOP$:{name:"Macanese Pataca",currency:"MOP"},MYR:{name:"Malaysian Ringgit",currency:"MYR"},MUR:{name:"Mauritian Rupee",currency:"MUR"},MX$:{name:"Mexico Peso",currency:"MXN"},MXN$:{name:"Mexico Peso",currency:"MXN"},MXN:{name:"Mexico Peso",currency:"MXN"},MNT:{name:"Mongolian Tugrik",currency:"MNT"},MAD:{name:"Moroccan Dirham",currency:"MAD"},NAD:{name:"Namibia Dollar",currency:"NAD"},NZ$:{name:"New Zealand Dollar",currency:"NZD"},NZD:{name:"New Zealand Dollar",currency:"NZD"},NGN:{name:"Nigerian Naira",currency:"NGN"},NOK:{name:"Norwegian Krone",currency:"NOK"},PAB:{name:"Panamanian Balboa",currency:"PAB"},PYG:{name:"Paraguayan Guarani",currency:"PYG"},PEN:{name:"Peruvian Sol",currency:"PEN"},PHP:{name:"Philippine Peso",currency:"PHP"},"£":{name:"Pounds",currency:"GBP"},"￡":{name:"Pounds",currency:"GBP"},GBP:{name:"Pounds",currency:"GBP"},QAR:{name:"Qatari Riyal",currency:"QAR"},RUB:{name:"Russian Ruble",currency:"RUB"},руб:{name:"Russian Ruble",currency:"RUB"},SAR:{name:"Saudi Arabian Riyal",currency:"SAR"},ريال:{name:"Saudi Arabian Riyal",currency:"SAR"},SGD:{name:"Singapore Dollar",currency:"SGD"},SG$:{name:"Singapore Dollar",currency:"SGD"},S$:{name:"Singapore Dollar",currency:"SGD"},ZAR:{name:"South African Rand",currency:"ZAR"},"₩":{name:"South Korean Won",currency:"KRW"},KRW:{name:"South Korean Won",currency:"KRW"},NT$:{name:"Taiwan New Dollar",currency:"TWD"},TWD:{name:"Taiwan New Dollar",currency:"TWD"},TZS:{name:"Tanzania Shilling",currency:"TZS"},THB:{name:"Thai Baht",currency:"THB"},TTD:{name:"Trinidadian Dollar",currency:"TTD"},TRY:{name:"Turkish Lira",currency:"TRY"},UYU:{name:"Uruguayan Peso",currency:"TRY"},"֏":{name:"Armenian Dram",currency:"AMD"},"₼":{name:"Azerbaijani Manat",currency:"AZN"},BAM:{name:"Bosnia and Herzegovina Convertible Mark",currency:"BAM"},KM:{name:"Bosnia and Herzegovina Convertible Mark",currency:"BAM"},лв:{name:"Bulgarian lev",currency:"BGN"},BHD:{name:"Bahraini Dinar",currency:"BHD"},"ب.د":{name:"Bahraini Dinar",currency:"BHD"},BD:{name:"Bahraini Dinar",currency:"BHD"},B$:{name:"Brunei Dollar",currency:"BND"},BYN:{name:"Belarusian Ruble",currency:"BYN"},Br:{name:"Belarusian Ruble",currency:"BYN"},CAD:{name:"Canadian Dollar",currency:"CAD"},C$:{name:"Canadian Dollar",currency:"CAD"},CA$:{name:"Canadian Dollar",currency:"CAD"},CHF:{name:"Swiss Franc",currency:"CHF"},Fr:{name:"Swiss Franc",currency:"CHF"},Col$:{name:" Colombian Peso",currency:"COP"},CZK:{name:"Czech Koruna",currency:"CZK"},Kč:{name:"Czech Koruna",currency:"CZK"},DJF:{name:"Djiboutian Franc",currency:"DJF"},Fdj:{name:"Djiboutian Franc",currency:"DJF"},DKK:{name:"Danish Krone",currency:"DKK"},kr:{name:"Swedish Krona",currency:"SEK"},DZD:{name:"Algerian Dinar ",currency:"DZD"},دج:{name:"Algerian Dinar ",currency:"DZD"},DA:{name:"Algerian Dinar ",currency:"DZD"},GEL:{name:"Georgian Lari",currency:"GEL"},ლ:{name:"Georgian Lari",currency:"GEL"},"GH₵":{name:"Ghanaian Cedi ",currency:"GHS"},GNF:{name:"Guinean Franc",currency:"GNF"},FG:{name:"Guinean Franc",currency:"GNF"},Ft:{name:"Hungarian Forint",currency:"HUF"},Rp:{name:"Indonesian Rupiah",currency:"IDR"},ISK:{name:"Icelandic Króna",currency:"ISK"},Íkr:{name:"Icelandic Króna",currency:"ISK"},JOD:{name:"Jordanian Dinar",currency:"JOD"},JD:{name:"Jordanian Dinar",currency:"JOD"},KGS:{name:"Kyrgyzstani Som",currency:"KGS"},с:{name:"Kyrgyzstani Som",currency:"KGS"},"៛":{name:"Cambodian Riel",currency:"KHR"},KWD:{name:"Kuwaiti Dinar",currency:"KWD"},"K.D.":{name:"Kuwaiti Dinar",currency:"KWD"},"₸":{name:"Kazakhstani Tenge",currency:"KZT"},LVL:{name:"Latvian Lats",currency:"LVL"},Ls:{name:"Latvian Lats",currency:"LVL"},DH:{name:"Moroccan Dirham",currency:"MAD"},MDL:{name:"Moldovan Leu ",currency:"MDL"},L:{name:"Romanian Leu",currency:"RON"},MKD:{name:"Macedonian Denar",currency:"MKD"},ден:{name:"Macedonian Denar",currency:"MKD"},MVR:{name:"Maldivian Rufiyaa",currency:"MVR"},ރ:{name:"Maldivian Rufiyaa",currency:"MVR"},MWK:{name:"Malawian Kwacha",currency:"MWK"},MK:{name:"Malawian Kwacha",currency:"MWK"},Mex$:{name:"Mexican Peso",currency:"MXN"},RM:{name:"Malaysian Ringgit",currency:"MYR"},N:{name:"Nigerian Naira",currency:"NGN"},"₦":{name:"Nigerian Naira",currency:"NGN"},NPR:{name:"Nepalese Rupee ",currency:"NPR"},रू:{name:"Nepalese Rupee ",currency:"NPR"},OMR:{name:"Omani Rial",currency:"OMR"},"S/":{name:"Peruvian Nuevo Sol",currency:"PEN"},"₱":{name:"Philippine Peso",currency:"PHP"},PKR:{name:"Pakistani Rupee",currency:"PKR"},"₨":{name:"Pakistani Rupee",currency:"PKR"},PLN:{name:"Polish Zloty",currency:"PLN"},zł:{name:"Polish Zloty",currency:"PLN"},QR:{name:"Qatari Riyal",currency:"QAR"},RON:{name:"Romanian Leu",currency:"RON"},lei:{name:"Romanian Leu",currency:"RON"},RSD:{name:"Serbian Dinar",currency:"RSD"},РСД:{name:"Serbian Dinar",currency:"RSD"},"₽":{name:"Russian Ruble",currency:"RUB"},RWF:{name:"Rwandan Franc",currency:"RWF"},FRw:{name:"Rwandan Franc",currency:"RWF"},"ر.س":{name:"Saudi Riyal",currency:"SAR"},SEK:{name:"Swedish Krona",currency:"SEK"},STN:{name:"Sao Tome and Principe Dobra",currency:"STN"},Db:{name:"Sao Tome and Principe Dobra",currency:"STN"},SZL:{name:"Swazi Lilangeni",currency:"SZL"},E:{name:"Swazi Lilangeni",currency:"SZL"},"฿":{name:"Thai Baht",currency:"THB"},TOP:{name:"Tongan Paʻanga",currency:"TOP"},T$:{name:"Tongan Paʻanga",currency:"TOP"},TL:{name:"Turkish Lira",currency:"TRY"},"₺":{name:"Turkish Lira",currency:"TRY"},UAH:{name:"Ukrainian Hryvnia",currency:"UAH"},"₴":{name:"Ukrainian Hryvnia",currency:"UAH"},грн:{name:"Ukrainian Hryvnia",currency:"UAH"},UGX:{name:"Ugandan Shilling",currency:"UGX"},USh:{name:"Ugandan Shilling",currency:"UGX"},UZS:{name:"Uzbekistan Som",currency:"UZS"},soʻm:{name:"Uzbekistan Som",currency:"UZS"},VEF:{name:"Venezuelan Bolívar Fuerte",currency:"VEF"},"Bs.F.":{name:"Venezuelan Bolívar Fuerte",currency:"VEF"},vef:{name:"Venezuelan Bolívar Fuerte",currency:"VEF"},VND:{name:"Vietnamese Dong",currency:"VND"},"₫":{name:"Vietnamese Dong",currency:"VND"},XAF:{name:"Central African CFA Franc",currency:"XAF"},"F.CFA":{name:"Central African CFA Franc",currency:"XAF"},CFA:{name:"Central African CFA Franc",currency:"XAF"},YER:{name:"Yemeni Rial",currency:"YER"},"﷼":{name:"Yemeni Rial",currency:"YER"},R:{name:"South African Rand",currency:"ZAR"},IQD:{name:"Iraqi Dinar",currency:"IQD"},ALL:{name:"Albanian Lek",currency:"ALL"},BBD:{name:"Barbados Dollar",currency:"BBD"},LKR:{name:"Sri Lankan Rupee",currency:"LKR"},AOA:{name:"Angolan Kwanza",currency:"AOA"},XOF:{name:"CFA Franc BCEAO",currency:"XOF"},BYR:{name:"Belarusian ruble",currency:"BYR"},BDT:{name:"Bangladeshi Taka",currency:"BDT"},XPF:{name:"CFP Franc",currency:"XPF"},BMD:{name:"Bermudian Dollar",currency:"BMD"},BTN:{name:"Bhutan Ngultrum",currency:"BTN"},BWP:{name:"Botswana Pula",currency:"BWP"},BIF:{name:"Burundi Franc",currency:"BIF"},CVE:{name:"Cape Verde Escudo",currency:"CVE"},LYD:{name:"Lybian Dinar",currency:"LYD"},KMF:{name:"Comoros Franc",currency:"KMF"},HRK:{name:"Croatian Kuna",currency:"HRK"},ETB:{name:"Ethiopian Birr",currency:"ETB"},SVC:{name:"El Salvador Colon",currency:"SVC"},ERN:{name:"Eritrean Nakfa",currency:"ERN"},FRP:{name:"Falkland Islands Pound",currency:"FRP"},FJD:{name:"Fijian Dollar",currency:"FJD"},SLL:{name:"Sierra Leone Leone",currency:"SLL"},GMD:{name:"Gambian Dalasi",currency:"GMD"},GIP:{name:"Gibraltar Pound",currency:"GIP"},GYD:{name:"Guyanan Dollar",currency:"GYD"},HTG:{name:"Haitian Gourde",currency:"HTG"},PGK:{name:"Papua New Guinea Kina",currency:"PGK"},LAK:{name:"Lao Kip",currency:"LAK"},LSL:{name:"Lesotho Loti",currency:"LSL"},STD:{name:"Sao Tome/Principe Dobra",currency:"STD"},SCR:{name:"Seychelles Rupee",currency:"SCR"},WST:{name:"Samoan Tala",currency:"WST"},NIO:{name:"Nicaraguan Cordoba Oro",currency:"NIO"},SBD:{name:"Solomon Islands Dollar",currency:"SBD"},TND:{name:"Tunisian Dinar",currency:"TND"},AFN:{name:"Afghan Afghani",currency:"AFN"},VUV:{name:"Vanuatu Vatu",currency:"VUV"},MMK:{name:"Myanmar Kyat",currency:"MMK"},FKP:{name:"Falkland Islands Pound",currency:"FKP"}})},953:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Single=void 0;const a=n(39084),c=n(88393),s=n(39376),u=n(64434),l=n(41136),d=n(18195),f=n(52650),p=n(35809),h=n(67161);let g=class extends a.BaseHandler{constructor(e,t,n){super(),this.selectorsSolver=e,this.elementSolver=t,this.elScope=n}type(){return d.OperationType.SINGLE}scope(){return d.OperationScope.LOCAL}async*handle(e){let t=this.elScope;if(null!=e.scope){const n=await this.elementSolver.solve(e.scope);if(!n.success)return(0,u.failed)(void 0,n.message);t=n.value.value}const n=await this.selectorsSolver.solve(e.selectors);if(!n.success)return(0,u.failed)(void 0,n.message);const r=n.value.value;try{for(const n of r){const r=t.querySelector(n);if(null==r)continue;const i=(0,l.getter)(e,r);return(0,u.succeeded)(i)}}catch(e){return(0,u.failed)(void 0,e.message,d.NativeOperationType.NATIVE_ERROR)}return(0,u.failed)(void 0,`No element with selectors "${JSON.stringify(r)}" were found`)}};t.Single=g,r([(0,h.requiredFields)("selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],g.prototype,"handle",null),t.Single=g=r([(0,f.injectable)(),o(0,(0,f.inject)(p.Injections.selectorsSolver)),o(1,(0,f.inject)(p.Injections.htmlElementSolver)),o(2,(0,f.inject)(p.Injections.elScope)),i("design:paramtypes",[s.SelectorsSolver,c.HtmlElementSolver,Object])],g)},2353:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InContentMessageManager=void 0;const a=n(71063),c=n(80146),s=n(52650),u=n(48151),l=n(47748),d=n(16904),f=n(57421),p=n(8380),h=n(58456),g=n(85362),y=n(15918);let m=class{constructor(e,t,n,r,i,o,a,c,s,u,l,d,f,p){this.container=e,this.id=t,this.matcher=n,this.interceptors=r,this.click=i,this.change=o,this.load=a,this.domLoad=c,this.windowLoad=s,this.postMessage=u,this.urlChanged=l,this.iframeLoaded=d,this.domChanged=f,this.keyDown=p,chrome.runtime.onMessage.addListener(this.bindListeners.bind(this))}onInit(e){if(e.id!==this.id)return;const{payload:t}=e,{libConfig:n,watcher:r,varScope:i,currencyList:o}=t;try{if(document.body.getAttribute(this.processedFlagAttribute))return}catch(t){return void setTimeout((()=>{this.onInit(e)}),100)}document.body.setAttribute(this.processedFlagAttribute,"true"),this.watcher=r,this.libConfig=n,this.currencyList=o,this.initAdditionalDependencies(),this.initStorage(i),this.initHandlers(a.MessageBgType.INIT)}onReInit({payload:e}){if((0,g.isIframe)())return;const{initialUrl:t,watcher:n,varScope:r}=e;this.libConfig.initialUrl=t;const i=JSON.stringify(this.watcher)!==JSON.stringify(n);i&&(this.watcher=n,this.container.rebind(u.ContentInjections.activeConfig).toConstantValue(this.watcher)),this.initStorage(r),this.initHandlers(a.MessageBgType.RE_INIT,i)}onRuntimeStorageSave({payload:e,id:t}){t!==this.id&&this.storage?.save?.(e.name,e.data)}onRuntimeStorageRemove({payload:e,id:t}){t!==this.id&&this.storage?.remove?.(e.name)}initHandlers(e,t=!0){const n={[a.MessageBgType.INIT]:()=>{this.load.handle(),this.domLoad.handle(),this.windowLoad.handle(),this.click.handle(),this.change.handle(),this.keyDown.handle(),this.urlChanged.handle(),this.postMessage.handle(),this.interceptors.handle(),this.domChanged.handle()},[a.MessageBgType.RE_INIT]:(e=!0)=>{this.load.handle(),this.domLoad.handle(),this.windowLoad.handle(),e&&(this.interceptors.handle(),this.domChanged.handle())}};n[e]?.(t)}initStorage(e){const t={...e,...{[h.RESERVED_VARIABLES.$url]:(0,y.parseUrl)(this.libConfig.initialUrl),[h.RESERVED_VARIABLES.$globalThis]:window}};this.storage.initStorage(t)}bindListeners(e){const t={[a.MessageBgType.INIT]:this.onInit.bind(this),[a.MessageBgType.IFRAME_LOADED]:this.iframeLoaded.handle.bind(this.iframeLoaded),[a.MessageBgType.RE_INIT]:this.onReInit.bind(this),[a.MessageBgType.STORAGE_SAVE]:this.onRuntimeStorageSave.bind(this),[a.MessageBgType.STORAGE_REMOVE]:this.onRuntimeStorageRemove.bind(this)};t[e.type]?t[e.type](e):this.log("Ignored message",e)}initAdditionalDependencies(){this.container.bind(d.ConfigInjections.config).toConstantValue(this.libConfig),this.container.bind(u.ContentInjections.activeConfig).toConstantValue(this.watcher),this.container.bind(u.ContentInjections.currencyList).toConstantValue(this.currencyList),this.container.bind(u.ContentInjections.logger).to(l.Logger).inSingletonScope(),this.container.bind(u.ContentInjections.contentStorage).to(c.ContentStorage).inSingletonScope(),this.storage=this.container.get(u.ContentInjections.contentStorage),this.logger=this.container.get(u.ContentInjections.logger)}get processedFlagAttribute(){return`__processed_${this.id}__`}log(e,...t){this.logger?.log?.(e,...t)}};m=r([(0,s.injectable)(),o(0,(0,s.inject)(u.ContentInjections.DI)),o(1,(0,s.inject)(u.ContentInjections.ID)),o(2,(0,s.inject)(u.ContentInjections.matcher)),o(3,(0,s.inject)(u.ContentInjections.interceptorsHandler)),o(4,(0,s.inject)(u.ContentInjections.onClickHandler)),o(5,(0,s.inject)(u.ContentInjections.onInputChangeHandler)),o(6,(0,s.inject)(u.ContentInjections.onLoadHandler)),o(7,(0,s.inject)(u.ContentInjections.onDomLoadHandler)),o(8,(0,s.inject)(u.ContentInjections.onWindowLoadHandler)),o(9,(0,s.inject)(u.ContentInjections.onPostMessageHandler)),o(10,(0,s.inject)(u.ContentInjections.onUrlChangedHandler)),o(11,(0,s.inject)(u.ContentInjections.onIframeLoadedHandler)),o(12,(0,s.inject)(u.ContentInjections.onDomChangedHandler)),o(13,(0,s.inject)(u.ContentInjections.onKeyDownHandler)),i("design:paramtypes",[s.Container,String,f.Matcher,p.InterceptorsHandler,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],m),t.InContentMessageManager=m},4035:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.multiInject=void 0;const c=a(n(19466)),s=(0,n(8701).injectBase)(c.MULTI_INJECT_TAG);t.multiInject=s},4045:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;const c=a(n(19466));t.Metadata=class{key;value;constructor(e,t){this.key=e,this.value=t}toString(){return this.key===c.NAMED_TAG?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}},5139:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Observer=void 0;const i=n(52650);let o=class{constructor(){this.listeners={}}emit(e,t){if(!this.listeners[e])return;this.listeners[e].forEach((e=>{e(t)}))}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}clear(e=[]){this.listeners=e.reduce(((e,t)=>({...e,[t]:this.listeners[t]})),{})}};o=r([(0,i.injectable)()],o),t.Observer=o},5265:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyServiceIdentifier=t.LazyServiceIdentifier=void 0;const r=n(11446);Object.defineProperty(t,"stringifyServiceIdentifier",{enumerable:!0,get:function(){return r.stringifyServiceIdentifier}});const i=n(82151);Object.defineProperty(t,"LazyServiceIdentifier",{enumerable:!0,get:function(){return i.LazyServiceIdentifier}})},6289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleActivationStore=void 0;const r=n(93382);class i{_map=new Map;remove(e){const t=this._map.get(e);return void 0===t?this._getEmptyHandlersStore():(this._map.delete(e),t)}addDeactivation(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)}addActivation(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)}clone(){const e=new i;return this._map.forEach(((t,n)=>{e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})})),e}_getModuleActivationHandlers(e){let t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t}_getEmptyHandlersStore(){return{onActivations:new r.Lookup,onDeactivations:new r.Lookup}}}t.ModuleActivationStore=i},6439:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnDomLoadHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(65334),l=n(85362);let d=class{constructor(e,t){this.container=e,this.extractor=t}handle(){(0,l.isIframe)()||(["interactive","complete"].includes(document.readyState)?this.extractDomLoadHandlers():document.addEventListener("DOMContentLoaded",this.extractDomLoadHandlers.bind(this)))}extractDomLoadHandlers(){this.watcher()?.config?.onDomLoad?.forEach((e=>{this.extractor?.run?.(e,u.WatcherHandler.onDomLoad)}))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnDomLoadHandler=d},6591:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.WaitForNotProcessedElementHandler=void 0;const a=n(18195),c=n(64434),s=n(52650),u=n(35809),l=n(67161);let d=class{constructor(e){this.elScope=e}type(){return a.OperationType.WAIT_FOR_NOT_PROCESSED_ELEMENT}scope(){return a.OperationScope.LOCAL}async*handle(e){return await new Promise((t=>{const n=setInterval((()=>{for(const i of e.selectors){let e;try{e=this.elScope.querySelector(i)}catch(e){continue}null!=e&&(e.hasAttribute("data-lib-processed")||(clearInterval(n),clearTimeout(r),t((0,c.succeeded)(!0))))}}),500),r=setTimeout((()=>{clearInterval(n),t((0,c.failed)(!1,"Some element was already processed, or selectors was not found"))}),e.timeout)}))}};t.WaitForNotProcessedElementHandler=d,r([(0,l.requiredFields)("selectors","timeout"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],d.prototype,"handle",null),t.WaitForNotProcessedElementHandler=d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.elScope)),i("design:paramtypes",[Object])],d)},6736:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.BindingCount=void 0,function(e){e[e.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",e[e.NoBindingsAvailable=0]="NoBindingsAvailable",e[e.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"}(n||(t.BindingCount=n={}))},7520:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadataPropertiesFromMetadataReader=function(e,t){const n=t.getPropertiesMetadata(e),i=new Map;for(const t of Reflect.ownKeys(n)){const o=n[t];i.set(t,(0,r.getPropertyMetadataFromLegacyMetadata)(e,t,o))}return i};const r=n(23498)},8260:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Variable=void 0;const a=n(18195),c=n(52650),s=n(35809),u=n(64434),l=n(67161),d=n(90726);let f=class{constructor(e){this.main=e}type(){return a.OperationType.VAR}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=e.value.split(".");let n=this.main.programScope(!1);for(let r=0;r<t.length-1;r++){const i=n?.[t[r]];((0,u.isObject)(i)||e.strict)&&(n=i)}const r=t.at(-1),i=n?.[r];if(!e.dynamic){return(e.acceptNull?void 0===i:null==i)?(0,u.failed)(void 0,`Variable "${e.value}" is not defined`):(0,u.succeeded)(i)}const o=this.handle({...e,dynamic:!1,value:i});let a,c;do{a=await o.next(),c=a.value}while(!a.done);return c}};t.Variable=f,r([(0,l.requiredFields)("value"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.Variable=f=r([(0,c.injectable)(),o(0,(0,c.inject)(s.Injections.program)),i("design:paramtypes",[d.Program])],f)},8358:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Constructor=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.CONSTRUCTOR}scope(){return a.OperationScope.LOCAL}async*handle(e){const{constructor:t}=e;if(!globalThis.hasOwnProperty(t))return(0,s.failed)(void 0,`Constructor "${t}" does not exist`,a.NativeOperationType.NATIVE_ERROR);const n=globalThis[t];if(e.static)return(0,s.succeeded)(n);if("function"!=typeof n)return(0,s.failed)(void 0,`Constructor "${t}" can't produce instances`,a.NativeOperationType.NATIVE_ERROR);const r=[];for(const t of e.args??[]){const e=await this.main.handle({operation:t,isChild:!0});r.push(e.value.value)}try{const e=new n(...r);return(0,s.succeeded)(e)}catch(e){return(0,s.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}}};t.Constructor=f,r([(0,d.requiredFields)("constructor"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.Constructor=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},8380:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterceptorsHandler=void 0;const a=n(52650),c=n(48151),s=n(22039),u=n(44892),l=n(89399),d=n(12668);let f=class{constructor(e,t,n,r){this.container=e,this.requestsManager=t,this.extractor=n,this.out=r,this.requestsManager.onHttpDataSave(this.onHttpDataSave.bind(this))}handle(){const{onHttpRequest:e=[],onHttpResponse:t=[]}=this.watcher()?.config??{};(e.length>0||t.length>0)&&this.requestsManager.injectConfig(e,t)}async onHttpDataSave({payload:e,handler:t,watcher:n}){this.storage().upsert(t.var,e),this.out.storageSave(t.var,this.storage().getItem(t.var));const r=t;r.operations?.length&&r.event&&(await(0,l.delay)(20),this.extractor.run(r,n))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}storage(){return this.container.get(c.ContentInjections.contentStorage)}};f=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.requestsManager)),o(2,(0,a.inject)(c.ContentInjections.extractorManager)),o(3,(0,a.inject)(c.ContentInjections.outContentMessageManager)),i("design:paramtypes",[a.Container,s.RequestsManager,u.ExtractorManager,d.OutContentMessageManager])],f),t.InterceptorsHandler=f},8701:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectBase=function(e){return t=>(n,a,c)=>{if(void 0===t){const e="function"==typeof n?n.name:n.constructor.name;throw new Error((0,r.UNDEFINED_INJECT_ANNOTATION)(e))}(0,o.createTaggedDecorator)(new i.Metadata(e,t))(n,a,c)}};const r=n(35007),i=n(4045),o=n(33353)},8835:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getFactoryDetails=t.ensureFullyBound=t.multiBindToService=void 0;const c=a(n(35007)),s=n(9117),u=n(56272),l=n(88053);t.multiBindToService=e=>t=>(...n)=>{n.forEach((n=>{e.bind(n).toService(t)}))};t.ensureFullyBound=e=>{let t=null;switch(e.type){case s.BindingTypeEnum.ConstantValue:case s.BindingTypeEnum.Function:t=e.cache;break;case s.BindingTypeEnum.Constructor:case s.BindingTypeEnum.Instance:t=e.implementationType;break;case s.BindingTypeEnum.DynamicValue:t=e.dynamicValue;break;case s.BindingTypeEnum.Provider:t=e.provider;break;case s.BindingTypeEnum.Factory:t=e.factory}if(null===t){const t=(0,u.getServiceIdentifierAsString)(e.serviceIdentifier);throw new Error(`${c.INVALID_BINDING_TYPE} ${t}`)}};t.getFactoryDetails=e=>{switch(e.type){case s.BindingTypeEnum.Factory:return{factory:e.factory,factoryType:l.FactoryType.Factory};case s.BindingTypeEnum.Provider:return{factory:e.provider,factoryType:l.FactoryType.Provider};case s.BindingTypeEnum.DynamicValue:return{factory:e.dynamicValue,factoryType:l.FactoryType.DynamicValue};default:throw new Error(`Unexpected factory type ${e.type}`)}}},8841:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadataFromMetadataReader=function(e,t){const n=(0,r.getReflectMetadata)(e,i.POST_CONSTRUCT),c=(0,r.getReflectMetadata)(e,i.PRE_DESTROY);return{constructorArguments:(0,o.getClassMetadataConstructorArgumentsFromMetadataReader)(e,t),lifecycle:{postConstructMethodName:n?.value,preDestroyMethodName:c?.value},properties:(0,a.getClassMetadataPropertiesFromMetadataReader)(e,t)}};const r=n(99757),i=n(83313),o=n(86249),a=n(7520)},9117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetTypeEnum=t.BindingTypeEnum=t.BindingScopeEnum=void 0;t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},9750:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadataProperties=function(e){const t=(0,r.getReflectMetadata)(e,i.TAGGED_PROP),n=new Map;if(void 0!==t)for(const r of Reflect.ownKeys(t)){const i=t[r];n.set(r,(0,o.getPropertyMetadataFromLegacyMetadata)(e,r,i))}return n};const r=n(99757),i=n(83313),o=n(23498)},11446:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyServiceIdentifier=function(e){switch(typeof e){case"string":case"symbol":return e.toString();case"function":return e.name;default:throw new Error(`Unexpected ${typeof e} service id type`)}}},11497:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateArgs=void 0;const r=n(24747);t.validateArgs=function(e){return function(t,n,i){const o=i.value;i.value=function(...n){const i=r.validationRules[e];if(!i)throw t.logger().error(`"${e}" is not supported for validation`),new Error;const[a]=n;for(const t of i.rules)if(t.rule(a,e)){const n=t.errorMsg(a,e);throw new Error(n)}return o.apply(this,n)}}}},12576:(e,t)=>{"use strict";function n(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=n,t.isPromiseOrContainsPromise=function(e){if(n(e))return!0;return Array.isArray(e)&&e.some(n)}},12668:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OutContentMessageManager=void 0;const a=n(35263),c=n(52650),s=n(48151),u=n(16904),l=n(58456),d=e=>{chrome.runtime.sendMessage(e)};let f=class{constructor(e,t){this.id=e,this.container=t}track(e,{customEvent:t=!1,preventDuplicates:n,testEvent:r=!1}){const i={id:this.id,type:a.MessageContentType.ECOMMERCE_TRACK,customEvent:t,payload:{...e,preventDuplicates:n,testEvent:r,clientTs:Date.now()}};d(i)}errorTrace(e,t,n,r){const{handleError:i=!0,testEvent:o=!1}=n;if(!i)return void this.logger().log(`TrackError: Listener ${t} was ignored to track error`);const c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,{marketplace:u}=this.libConfig(),l=this.watcher(),f={id:this.id,type:a.MessageContentType.ERROR_TRACE,testEvent:o,payload:{url:r,window:{height:s,width:c},template:u,trace:e,config:{regex:l.regex,var:l.var,config:{[t]:Object.keys(n).filter((e=>!["operations","preventDuplicates"].includes(e))).reduce(((e,t)=>({...e,[t]:n[t]})),{})}}}};d(f)}init(){const e={id:this.id,type:a.MessageContentType.ECOMMERCE_INIT,payload:{url:document.location.href}};d(e)}initShopify({$shopify:e}){const t={id:this.id,type:a.MessageContentType.ECOMMERCE_INIT_SHOPIFY,payload:{[l.RESERVED_VARIABLES.$shopify]:e,url:document.location.href}};d(t)}reInit(){const e=document.location.href;this.logger().log(`Re-init config for url: "${e}"`);const t=this.storage().getItem(l.RESERVED_VARIABLES.$shopify),n={id:this.id,type:a.MessageContentType.ECOMMERCE_RE_INIT,payload:{url:e,...t&&{[l.RESERVED_VARIABLES.$shopify]:t}}};d(n)}storageSave(e,t){const n={id:this.id,type:a.MessageContentType.ECOMMERCE_STORAGE_SAVE,payload:{name:e,data:t}};d(n)}storageRemove(e){const t={id:this.id,type:a.MessageContentType.ECOMMERCE_STORAGE_REMOVE,payload:{name:e}};d(t)}libConfig(){return this.container.get(u.ConfigInjections.config)}logger(){return this.container.get(s.ContentInjections.logger)}watcher(){return this.container.get(s.ContentInjections.activeConfig)}storage(){return this.container.get(s.ContentInjections.contentStorage)}};f=r([(0,c.injectable)(),o(0,(0,c.inject)(s.ContentInjections.ID)),o(1,(0,c.inject)(s.ContentInjections.DI)),i("design:paramtypes",[String,c.Container])],f),t.OutContentMessageManager=f},12672:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.tryAndThrowErrorIfStackOverflow=void 0,t.isStackOverflowException=s;const c=a(n(35007));function s(e){return e instanceof RangeError||e.message===c.STACK_OVERFLOW}t.tryAndThrowErrorIfStackOverflow=(e,t)=>{try{return e()}catch(e){if(s(e))throw t();throw e}}},12818:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConstructorArgumentMetadataFromLegacyMetadata=function(e,t,n){try{return(0,o.getClassElementMetadataFromLegacyMetadata)(n)}catch(n){throw r.InversifyCoreError.isErrorOfKind(n,i.InversifyCoreErrorKind.missingInjectionDecorator)?new r.InversifyCoreError(i.InversifyCoreErrorKind.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${e.name}" at constructor arguments at index "${t.toString()}"`,{cause:n}):n}};const r=n(21773),i=n(94931),o=n(44063)},13007:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnDomChangedHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(58456),l=n(65334);let d=class{constructor(e,t){this.container=e,this.extractor=t,this.existingObservers=[]}handle(){this.cleanObservers(),this.onDomChanged()?.length&&("complete"!==document.readyState?window.addEventListener("load",this.extractDomChangedListener.bind(this)):this.extractDomChangedListener())}cleanObservers(){this.existingObservers.forEach((e=>{e.disconnect()})),this.existingObservers=[]}watcher(){return this.container.get(c.ContentInjections.activeConfig)}logger(){return this.container.get(c.ContentInjections.logger)}onDomChanged(){return this.watcher()?.config?.onDomChanged??[]}logError(e,t){this.logger().error(`\n Handler: "${l.WatcherHandler.onDomChanged}". \n Event: "${e}". \n Error: "${t}"`)}extractDomChangedListener(){this.onDomChanged().forEach((e=>{const{parent:t,action:n,child:r,options:i=this.defaultOptions}=e;if(r)if(n)try{const n=document.querySelector(t),r=n instanceof HTMLIFrameElement?n.contentWindow.document:n;if(!r)return void this.logError(e.event,`No element found with selector: "${t}"`);const o=new MutationObserver(this.mutationCallback(e).bind(this));o.observe(r,i),this.existingObservers.push(o)}catch(t){this.logError(e.event,t.message)}else this.logError(e.event,'"Action" property was not provided');else this.logError(e.event,'"Child" property was not provided')}))}mutationCallback(e){const{action:t}=e;return(n,r)=>{const i={ADD:"addedNodes",REMOVE:"removedNodes"}[t];if(!i)return this.logError(e.event,`Action "${t}" is not acceptable. Use "ADD" or "REMOVE"`),void r.disconnect();this.proceedNodes(n,i,e)}}proceedNodes(e,t,n){for(const r of e)0!==r[t].length&&r[t].forEach((e=>{try{if(e.matches?.(n.child)){const t={[u.RESERVED_VARIABLES.$parent]:r.target,[u.RESERVED_VARIABLES.$child]:e};this.extractor?.run?.(n,l.WatcherHandler.onDomChanged,t)}}catch(e){this.logError(n.event,e.message)}}))}get defaultOptions(){return{childList:!0,subtree:!0}}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnDomChangedHandler=d},13198:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PriceParser=void 0;const a=n(18195),c=n(64434),s=n(52650),u=n(90726),l=n(35809),d=n(67161),f=n(48724);let p=class{constructor(e,t){this.main=e,this.currencyList=t}type(){return a.OperationType.PRICE_PARSER}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=Boolean(e.validateCurrency??!0),n=await this.main.handle({operation:e.price,isChild:!0});if(!n.success)return(0,c.failed)(void 0,n.message);const r=n.value.value,i=(0,f.currencyParser)(r,this.currencyList,t,e.modulus);return i.success?(0,c.succeeded)(i.result):(0,c.failed)(void 0,i.message)}};t.PriceParser=p,r([(0,d.requiredFields)("price"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.PriceParser=p=r([(0,s.injectable)(),o(0,(0,s.inject)(l.Injections.program)),o(1,(0,s.inject)(l.Injections.currencyList)),i("design:paramtypes",[u.Program,Object])],p)},15918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUrl=void 0;t.parseUrl=e=>{try{return new URL(e)}catch{return e}}},16586:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetsFromMetadataProviders=function(e,t){return function(n){const a=e(n);let c=(0,i.getBaseType)(n);for(;void 0!==c&&c!==Object;){const e=t(c);for(const[t,n]of e)a.properties.has(t)||a.properties.set(t,n);c=(0,i.getBaseType)(c)}const s=[];for(const e of a.constructorArguments)if(e.kind!==r.ClassElementMetadataKind.unmanaged){const t=e.targetName??"";s.push(new o.LegacyTargetImpl(t,e,"ConstructorArgument"))}for(const[e,t]of a.properties)if(t.kind!==r.ClassElementMetadataKind.unmanaged){const n=t.targetName??e;s.push(new o.LegacyTargetImpl(n,t,"ClassProperty"))}return s}};const r=n(86277),i=n(55028),o=n(80877)},16904:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigInjections=void 0,function(e){e.config="config"}(t.ConfigInjections||(t.ConfigInjections={}))},18195:(e,t)=>{"use strict";var n,r,i,o,a,c;Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractorResponseStatus=t.FlowList=t.SINGLE_GET_TYPE=t.NativeOperationType=t.OperationType=t.OperationScope=void 0,function(e){e.LOCAL="LOCAL",e.BLOCK="BLOCK"}(n||(t.OperationScope=n={})),function(e){e.SINGLE="single",e.PLURAL="plural",e.SPLIT_SCOPE="splitScope",e.OR="or",e.AND="and",e.COMPUTED="computed",e.EXIST="exist",e.LOG="log",e.IS_NOT_HIDDEN_ELEMENT="isNotHiddenElement",e.MARK_PROCESSED_ELEMENT="markProcessedElement",e.WAIT_FOR_NOT_PROCESSED_ELEMENT="waitForNotProcessedElement",e.FUNC="func",e.SELECT="select",e.CALL_METHOD="callMethod",e.GET_PROPERTY="property",e.LITERAL="literal",e.VAR="var",e.FOR_EACH="forEach",e.RETURN="return",e.MAP="map",e.CLOSEST="closest",e.PRICE_PARSER="priceParser",e.JSON_PARSER="jsonParser",e.EMIT="emit",e.FLOW="flow",e.CONDITION="condition",e.REPLACE="replace",e.REPLACE_BETWEEN="replaceBetween",e.MATH="math",e.CONSTRUCTOR="constructor",e.INTERRUPT="interrupt",e.BREAK="break",e.CONTINUE="continue"}(r||(t.OperationType=r={})),function(e){e.NATIVE_ERROR="nativeError",e.MISSING_ARGUMENT_ERROR="missingArgumentError"}(i||(t.NativeOperationType=i={})),function(e){e.TEXT="text",e.VALUE="value",e.ATTRIBUTE="attribute"}(o||(t.SINGLE_GET_TYPE=o={})),function(e){e.NONE="none",e.THEN="then",e.ELSE="else"}(a||(t.FlowList=a={})),function(e){e.SUCCESS="SUCCESS",e.FAILED="FAILED",e.INTERRUPTED="INTERRUPTED"}(c||(t.ExtractorResponseStatus=c={}))},18353:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Break=void 0;const i=n(64434),o=n(18195),a=n(52650);let c=class{type(){return o.OperationType.BREAK}scope(){return o.OperationScope.LOCAL}async*handle(){return(0,i.$break)()}};t.Break=c,t.Break=c=r([(0,a.injectable)()],c)},18721:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const r=n(37763);t.Context=class{id;container;plan;currentRequest;constructor(e){this.id=(0,r.id)(),this.container=e}addPlan(e){this.plan=e}setCurrentRequest(e){this.currentRequest=e}}},18968:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tracer=void 0;const a=n(52650),c=n(35809),s=n(76062),u=n(78082);let l=class{constructor(e,t){this.loggerTracer=e,this.operationTracer=t}init(e){this.operationTracer.init(e),this.loggerTracer.clear()}trace(e){return{version:this.version(),error:this.operationTracer.trace(),logs:this.loggerTracer.trace(),...e&&{message:e}}}version(){return"1.1.0"}};t.Tracer=l,t.Tracer=l=r([(0,a.injectable)(),o(0,(0,a.inject)(c.Injections.loggerTracer)),o(1,(0,a.inject)(c.Injections.operationTracer)),i("design:paramtypes",[s.LoggerTracer,u.OperationTracer])],l)},19466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NON_CUSTOM_TAG_KEYS=t.PRE_DESTROY=t.POST_CONSTRUCT=t.DESIGN_PARAM_TYPES=t.PARAM_TYPES=t.TAGGED_PROP=t.TAGGED=t.MULTI_INJECT_TAG=t.INJECT_TAG=t.OPTIONAL_TAG=t.UNMANAGED_TAG=t.NAME_TAG=t.NAMED_TAG=void 0,t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct",t.PRE_DESTROY="pre_destroy",t.NON_CUSTOM_TAG_KEYS=[t.INJECT_TAG,t.MULTI_INJECT_TAG,t.NAME_TAG,t.UNMANAGED_TAG,t.NAMED_TAG,t.OPTIONAL_TAG]},20388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidatorErrorTypes=t.ValidatorSharedErrorTypes=void 0,function(e){e.ARG_IS_NULL="argIsNull",e.INVALID_EVENT_NAME="invalidEventName"}(t.ValidatorSharedErrorTypes||(t.ValidatorSharedErrorTypes={})),function(e){e.NAME_IS_NOT_STRING="nameIsNotString",e.INVALID_ARGS_AMOUNT="invalidArgsAmount"}(t.ValidatorErrorTypes||(t.ValidatorErrorTypes={}))},21352:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;const a=n(18195),c=n(64434),s=n(52650),u=n(35809),l=n(76062),d=n(67161),f=n(59670),p=n(90726);let h=class{constructor(e,t,n){this.main=e,this.loggerTracer=t,this.logger=n}type(){return a.OperationType.LOG}scope(){return a.OperationScope.LOCAL}async*handle({args:e,msg:t}){const n=this.main.programScope(!1);let r;if(e){const i=Array.isArray(e)?e:[e];r=Object.values(i).reduce(((e,t)=>({...e,[t]:n[t]})),{}),this.loggerTracer.log(t,r)}else this.loggerTracer.log(t);return null!=r?this.logger.log(t,r):this.logger.log(t),(0,c.succeeded)(!0)}};t.Log=h,r([(0,d.requiredFields)("msg"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],h.prototype,"handle",null),t.Log=h=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.program)),o(1,(0,s.inject)(u.Injections.loggerTracer)),o(2,(0,s.inject)(u.Injections.logger)),i("design:paramtypes",[p.Program,l.LoggerTracer,f.MyLogger])],h)},21479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;const r=n(37763);class i{id;serviceIdentifier;parentContext;parentRequest;bindings;childRequests;target;requestScope;constructor(e,t,n,i,o){this.id=(0,r.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}addChildRequest(e,t,n){const r=new i(e,this.parentContext,this,t,n);return this.childRequests.push(r),r}}t.Request=i},21773:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InversifyCoreError=t.isAppErrorSymbol=void 0,t.isAppErrorSymbol=Symbol.for("@inversifyjs/core/InversifyCoreError");class n extends Error{[t.isAppErrorSymbol];kind;constructor(e,n,r){super(n,r),this[t.isAppErrorSymbol]=!0,this.kind=e}static is(e){return"object"==typeof e&&null!==e&&!0===e[t.isAppErrorSymbol]}static isErrorOfKind(e,t){return n.is(e)&&e.kind===t}}t.InversifyCoreError=n},22039:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestsManager=void 0;const a=n(5139),c=n(35263),s=n(52650),u=n(48151);var l;!function(e){e.SAVE_HTTP_DATA="SAVE_HTTP_DATA"}(l||(l={}));let d=class{constructor(e){this.observer=e,this.scriptAttribute="requests",this.scriptPath="libs/requests.js";const t={[c.MessageScriptType.SAVE_HTTP_DATA]:e=>{const t={...e.data.payload};this.observer.emit(l.SAVE_HTTP_DATA,t)},[c.MessageScriptType.HTTP_CONFIG_INJECTED]:()=>{this.callback?.()}};window.addEventListener("message",(e=>{t[e.data._custom_type_]?.(e)}))}injectConfig(e=[],t=[]){this.callback=()=>{const n={_custom_type_:c.MessageScriptType.INIT_HTTP_CONFIG,payload:{onHttpRequest:e,onHttpResponse:t}};window.postMessage(n)},this.callback()}injectScript(){if(this.isRequestsScriptInjected())return;const e=document.createElement("script");e.src=chrome.runtime.getURL(this.scriptPath);(document.head||document.documentElement).append(e)}onHttpDataSave(e){this.observer.subscribe(l.SAVE_HTTP_DATA,e)}isRequestsScriptInjected(){const e=Boolean(document.querySelector(`script[ecommerce-type="${this.scriptAttribute}"]`)),t=Boolean(document.querySelector(`script[src*="${this.scriptPath}"]`));return e||t}};d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.ContentInjections.observer)),i("design:paramtypes",[a.Observer])],d),t.RequestsManager=d},22888:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MathAction=void 0;const a=n(90726),c=n(54114),s=n(18195),u=n(64434),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return s.OperationType.MATH}scope(){return s.OperationScope.LOCAL}async*handle(e){const t=this.factory.prototype(this.main),n=await t.handle({operation:e.left,isChild:!0});if(!n.success)return(0,u.failed)(void 0,n.message);const r=await t.handle({operation:e.right,isChild:!0});if(!r.success)return(0,u.failed)(void 0,r.message);const i=Number(n.value.value),o=Number(r.value.value);if(Number.isNaN(i))return(0,u.failed)(void 0,`Value "${n.value.value}" could not be parsed as number`);if(Number.isNaN(o))return(0,u.failed)(void 0,`Value "${r.value.value}" could not be parsed as number`);const a=this.mathHandlers[e.sign];if(!a)return(0,u.failed)(void 0,`Unsupportable math sign "${e.sign}"`);const c=a(i,o);return Number.isNaN(c)?(0,u.failed)(void 0,`Result is not a number. Left: "${i}". Right: "${o}". Sign: "${e.sign}"`):(0,u.succeeded)(c)}get mathHandlers(){return{"+":(e,t)=>e+t,"-":(e,t)=>e-t,"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t}}};t.MathAction=p,r([(0,f.requiredFields)("left","right","sign"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.MathAction=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),i("design:paramtypes",[a.Program,c.ProgramFactory])],p)},22895:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnClickHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(58456),l=n(65334);let d=class{constructor(e,t){this.container=e,this.extractor=t}handle(){document.addEventListener("click",this.clickHandler.bind(this),{capture:!0})}watcher(){return this.container.get(c.ContentInjections.activeConfig)}logger(){return this.container.get(c.ContentInjections.logger)}clickHandler(e){this.watcher()?.config?.onClick?.forEach((t=>{try{if(e.target.matches(t.selector)){const n={[u.RESERVED_VARIABLES.$element]:e.target,[u.RESERVED_VARIABLES.$event]:e};this.extractor?.run?.(t,l.WatcherHandler.onClick,n)}}catch(e){this.logger().error(`\n Handler: "${l.WatcherHandler.onClick}". \n Event: "${t.event}". \n Error: "${e.message}"`)}}))}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnClickHandler=d},23108:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tagged=function(e,t){return(0,i.createTaggedDecorator)(new r.Metadata(e,t))};const r=n(4045),i=n(33353)},23498:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPropertyMetadataFromLegacyMetadata=function(e,t,n){try{return(0,o.getClassElementMetadataFromLegacyMetadata)(n)}catch(n){throw r.InversifyCoreError.isErrorOfKind(n,i.InversifyCoreErrorKind.missingInjectionDecorator)?new r.InversifyCoreError(i.InversifyCoreErrorKind.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${e.name}" at property "${t.toString()}"`,{cause:n}):n}};const r=n(21773),i=n(94931),o=n(44063)},24747:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validationRules=t.sharedRules=void 0;const r=n(20388),i=n(58456);t.sharedRules={[r.ValidatorSharedErrorTypes.ARG_IS_NULL]:{name:r.ValidatorSharedErrorTypes.ARG_IS_NULL,rule:e=>e.some((e=>null==e)),errorMsg:()=>"Values in args cannot be null or undefined"},[r.ValidatorSharedErrorTypes.INVALID_EVENT_NAME]:{name:r.ValidatorSharedErrorTypes.INVALID_EVENT_NAME,rule:(e,t)=>!Object.values(i.ExtractorEvents).includes(t),errorMsg:(e,t)=>`Invalid event name for validation. Your name is "${t}"`}},t.validationRules={[i.ExtractorEvents.STORAGE_SAVE]:{rules:[t.sharedRules[r.ValidatorSharedErrorTypes.INVALID_EVENT_NAME],t.sharedRules[r.ValidatorSharedErrorTypes.ARG_IS_NULL],{name:r.ValidatorErrorTypes.NAME_IS_NOT_STRING,rule:e=>"string"!=typeof e[0],errorMsg:e=>`Name value (first in the args array) type must be string. Received type is : "${typeof e[0]}"`},{name:r.ValidatorErrorTypes.INVALID_ARGS_AMOUNT,rule:e=>2!==e.length,errorMsg:(e,t)=>`Event "${t}" has "${e.length}" arguments. Expected amount is "2"`}]},[i.ExtractorEvents.STORAGE_REMOVE]:{rules:[t.sharedRules[r.ValidatorSharedErrorTypes.INVALID_EVENT_NAME],t.sharedRules[r.ValidatorSharedErrorTypes.ARG_IS_NULL],{name:r.ValidatorErrorTypes.NAME_IS_NOT_STRING,rule:e=>"string"!=typeof e[0],errorMsg:e=>`Name value (first in the args array) type must be string. Received type is : "${typeof e[0]}"`},{name:r.ValidatorErrorTypes.INVALID_ARGS_AMOUNT,rule:e=>1!==e.length,errorMsg:(e,t)=>`Event "${t}" has "${e.length}" arguments. Expected amount is "1"`}]}}},24769:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRegex=void 0;t.getRegex=e=>{const t="object"==typeof e;try{return t?new RegExp(e.regex,e.flags):new RegExp(e,"i")}catch{return t?new RegExp(e.regex,"i"):new RegExp(e,"i")}}},25290:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.IsNotHiddenElement=void 0;const a=n(18195),c=n(64434),s=n(59670),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e,t){this.elScope=e,this.logger=t}type(){return a.OperationType.IS_NOT_HIDDEN_ELEMENT}scope(){return a.OperationScope.LOCAL}async*handle(e){for(const t of e.selectors){let e;try{e=this.elScope.querySelector(t)}catch(e){this.logger.error("IsNotHiddenElement:",e);continue}if(null==e)continue;if(!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))return(0,c.succeeded)(!0)}return(0,c.failed)(!1,"No selectors found to be visible")}};t.IsNotHiddenElement=f,r([(0,d.requiredFields)("selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.IsNotHiddenElement=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.elScope)),o(1,(0,u.inject)(l.Injections.logger)),i("design:paramtypes",[Object,s.MyLogger])],f)},26029:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ForEach=void 0;const a=n(18195),c=n(90726),s=n(54114),u=n(64434),l=n(52650),d=n(35809),f=n(67161),p=n(53425);let h=class{constructor(e,t,n,r,i){this.main=e,this.factory=t,this.observer=n,this.config=r,this.funcs=i}type(){return a.OperationType.FOR_EACH}scope(){return a.OperationScope.BLOCK}async*handle(e){const t=await this.main.handle({operation:e.subject,isChild:!0});if(!t.success)return(0,u.failed)(void 0,t.message);const n=t.value.value;e:for(let t=0;t<n.length;t++){const r={},i={type:a.OperationType.LITERAL,var:e.index??"$index",value:t},o={type:a.OperationType.LITERAL,var:e.item??"$item",value:n[t]},c=this.factory.create(this.config,this.observer,this.main.getElScopeRef(),this.main.getGlobalScope(),this.funcs,!1,r,this.main.getCurrencyList()),s=()=>{this.clearScope(r,[o,i,...Boolean(e.cleanScope)&&e.forEach||[]]),this.main.mergeLocalScope(c.cloneLocalScope())};await c.handle({operation:i,isChild:!0}),await c.handle({operation:o,isChild:!0}),c.mergeLocalScope(this.main.programScope(!0));for(const[t,n]of Object.entries(e.forEach)){const e=await c.handle({operation:n,index:t});if(e.continue){s();continue e}if(e.break){s();break e}if(e.return)return(0,u.succeededAndReturn)(e.value.value);if((0,u.isFailed)(e,n))return(0,u.failed)(void 0,e.message)}s()}return(0,u.succeeded)(!0)}clearScope(e,t){t.forEach((t=>{t.var&&delete e[t.var]}))}};t.ForEach=h,r([(0,f.requiredFields)("subject","forEach"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],h.prototype,"handle",null),t.ForEach=h=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),o(2,(0,l.inject)(d.Injections.observer)),o(3,(0,l.inject)(d.Injections.config)),o(4,(0,l.inject)(d.Injections.funcs)),i("design:paramtypes",[c.Program,s.ProgramFactory,p.Observer,Object,Object])],h)},26504:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Extractor=void 0;const r=n(53425),i=n(54114),o=n(64434),a=n(18195);var c;!function(e){e.noOperations="noOperations",e.noReturn="noReturn",e.failed="failed",e.success="success",e.interrupted="interrupted"}(c||(c={}));t.Extractor=class{constructor(e,t,n,i,o){this.config=e,this.program=t,this.elScope=n,this.varScope=i,this.funcs=o,this.observer=new r.Observer}async run(){const e=(new i.ProgramFactory).create(this.config,this.observer,this.elScope,this.varScope,this.funcs,!0,void 0,this.currencyList);if(0===this.program.length)return this.response(c.noOperations,{main:e});try{const t=Object.entries((0,o.clone)(this.program));for(const[n,r]of t){const t=await e.handle({operation:r,index:n});if((0,o.isFailed)(t,r))return this.response(c.failed,{main:e,result:t});if(t.return)return this.response(c.success,{result:t})}return this.response(c.noReturn,{main:e})}catch(e){return this.response(c.interrupted,{message:e.message})}}on(e,t){this.observer.subscribe(e,t)}setCurrency(e){this.currencyList=e}response(e,t){return{[c.noOperations]:({main:e})=>({status:a.ExtractorResponseStatus.FAILED,response:e.getTrace("No operations were provided")}),[c.noReturn]:({main:e})=>({status:a.ExtractorResponseStatus.FAILED,response:e.getTrace('No "return" operation was provided')}),[c.failed]:({main:e,result:t})=>({status:a.ExtractorResponseStatus.FAILED,response:e.getTrace(t.message)}),[c.success]:({result:e})=>({status:a.ExtractorResponseStatus.SUCCESS,response:e.value.value}),[c.interrupted]:({message:e})=>({status:a.ExtractorResponseStatus.INTERRUPTED,response:e})}[e](t)}}},26727:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.typeConstraint=t.namedConstraint=t.taggedConstraint=t.traverseAncerstors=void 0;const c=a(n(19466)),s=n(4045),u=(e,t)=>{const n=e.parentRequest;return null!==n&&(!!t(n)||u(n,t))};t.traverseAncerstors=u;const l=e=>t=>{const n=n=>null!==n&&null!==n.target&&n.target.matchesTag(e)(t);return n.metaData=new s.Metadata(e,t),n};t.taggedConstraint=l;const d=l(c.NAMED_TAG);t.namedConstraint=d;t.typeConstraint=e=>t=>{let n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;{const n=t.bindings[0].implementationType;return e===n}}return!1}},27161:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInSyntax=void 0;const r=n(9117),i=n(41402);t.BindingInSyntax=class{_binding;constructor(e){this._binding=e}inRequestScope(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)}inSingletonScope(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)}inTransientScope(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)}}},27353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveToScope=t.tryGetFromScope=void 0;const r=n(9117),i=n(12576);t.tryGetFromScope=(e,t)=>t.scope===r.BindingScopeEnum.Singleton&&t.activated?t.cache:t.scope===r.BindingScopeEnum.Request&&e.has(t.id)?e.get(t.id):null;t.saveToScope=(e,t,n)=>{t.scope===r.BindingScopeEnum.Singleton&&a(t,n),t.scope===r.BindingScopeEnum.Request&&o(e,t,n)};const o=(e,t,n)=>{e.has(t.id)||e.set(t.id,n)},a=(e,t)=>{e.cache=t,e.activated=!0,(0,i.isPromise)(t)&&c(e,t)},c=async(e,t)=>{try{const n=await t;e.cache=n}catch(t){throw e.cache=null,e.activated=!1,t}}},28633:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(s.PARAM_TYPES,e))throw new Error(c.DUPLICATED_INJECTABLE_DECORATOR);const t=Reflect.getMetadata(s.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(s.PARAM_TYPES,t,e),e}};const c=a(n(35007)),s=a(n(19466))},28650:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertConstructorMetadataArrayFilled=function(e,t){const n=[];for(let e=0;e<t.length;++e){void 0===t[e]&&n.push(e)}if(n.length>0)throw new r.InversifyCoreError(i.InversifyCoreErrorKind.missingInjectionDecorator,`Found unexpected missing metadata on type "${e.name}" at constructor indexes "${n.join('", "')}".\n\nAre you using @inject, @multiInject or @unmanaged decorators at those indexes?\n\nIf you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)};const r=n(21773),i=n(94931)},28756:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnIframeLoadedHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(57421),l=n(65334),d=n(85362);let f=class{constructor(e,t,n){this.container=e,this.extractor=t,this.matcher=n}handle({payload:e}){if((0,d.isIframe)())return;const{url:t}=e;this.watcher()?.config?.onIframeLoaded?.forEach((e=>{this.matcher.isUrlMatches(e,t)&&this.extractor?.run?.(e,l.WatcherHandler.onIframeLoaded)}))}watcher(){try{return this.container.get(c.ContentInjections.activeConfig)}catch{return{}}}};f=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),o(2,(0,a.inject)(c.ContentInjections.matcher)),i("design:paramtypes",[a.Container,s.ExtractorManager,u.Matcher])],f),t.OnIframeLoadedHandler=f},29346:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Flow=void 0;const a=n(18195),c=n(90726),s=n(54114),u=n(64434),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return a.OperationType.FLOW}scope(){return a.OperationScope.BLOCK}async*handle(e){const t={condition:!0,flow:{name:a.FlowList.NONE,result:!0}},n=this.factory.prototype(this.main),r=this.factory.prototype(this.main);for(const n of e.condition){const e=await r.handle({operation:n,isChild:!0});if(!e.success||!e.value.value){t.condition=!1;break}}t.condition&&n.mergeLocalScope(r.getLocalScope());const i=t.condition?a.FlowList.THEN:a.FlowList.ELSE;if(i===a.FlowList.ELSE&&void 0===e[i])return(0,u.failed)(t,`condition is "FALSE". "${i}" is not defined`,a.NativeOperationType.NATIVE_ERROR);if(void 0!==e[i]){let r,o;t.flow.name=i;try{r=this.mapFlowBlockToFullFormat(e[i],i),o=this.factory.prototype(n)}catch(e){return(0,u.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}yield{condition:t.condition,flow:{result:!0,name:i}};const c=()=>{n.mergeLocalScope(o.getLocalScope()),this.main.mergeLocalScope(n.getLocalScope())};for(const[e,n]of Object.entries(r.operations??[])){let i=!1,a={};if(a=await o.handle({operation:n,index:e}),i=(0,u.isFailed)(a,n),a.continue)return c(),(0,u.$continue)();if(a.break)return c(),(0,u.$break)();if(a.return)return(0,u.succeededAndReturn)(a.value.value);if(i)return t.flow.result=!1,r.optional?(0,u.succeeded)(t):(0,u.failed)(t,a.message)}n.mergeLocalScope(o.getLocalScope())}return this.main.mergeLocalScope(n.getLocalScope()),(0,u.succeeded)(t)}mapFlowBlockToFullFormat(e,t){if(Array.isArray(e))return{optional:!1,operations:e};if((0,u.isObject)(e))return e;throw new Error(`Could not map a block "${t}", cause it's "${e}"`)}};t.Flow=p,r([(0,f.requiredFields)("condition"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.Flow=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),i("design:paramtypes",[c.Program,s.ProgramFactory])],p)},29472:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Replace=void 0;const a=n(18195),c=n(54114),s=n(64434),u=n(52650),l=n(35809),d=n(90726),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return a.OperationType.REPLACE}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=this.factory.prototype(this.main),n=await t.handle({operation:e.subject,isChild:!0});if(!n.success)return(0,s.failed)(void 0,n.message);const r=await t.handle({operation:e.needle,isChild:!0});if(!r.success)return(0,s.failed)(void 0,r.message);const i=await t.handle({operation:e.replacement,isChild:!0});if(!i.success)return(0,s.failed)(void 0,i.message);const o=e.mode?e.mode:"first",c=this.handler(o);if(!c)return(0,s.failed)(void 0,"Unsupportable replacementResult mode",a.NativeOperationType.NATIVE_ERROR);let u=n.value.value;const l=i.value.value;return(Array.isArray(r.value.value)?r.value.value:[r.value.value]).forEach((e=>{u=c(u,e,l)})),this.main.mergeLocalScope(t.getLocalScope()),(0,s.succeeded)(u)}handler(e){return{first:(e,t,n)=>e.replace(t,n),all:(e,t,n)=>e.replace(new RegExp(t,"g"),n)}[e]}};t.Replace=p,r([(0,f.requiredFields)("subject","needle","replacement"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.Replace=p=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),o(1,(0,u.inject)(l.Injections.factory)),i("design:paramtypes",[d.Program,c.ProgramFactory])],p)},31965:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SplitScope=void 0;const a=n(18195),c=n(39376),s=n(54114),u=n(64434),l=n(52650),d=n(53425),f=n(35809),p=n(90726),h=n(67161);let g=class{constructor(e,t,n,r,i,o,a){this.selectorsSolver=e,this.elScope=t,this.observer=n,this.factory=r,this.config=i,this.funcs=o,this.main=a}type(){return a.OperationType.SPLIT_SCOPE}scope(){return a.OperationScope.BLOCK}async*handle(e){const t=await this.selectorsSolver.solve(e.selectors);if(!t.success)return(0,u.failed)(void 0,t.message);let n=!1;if(e.breakOnError){const t=await this.main.handle({operation:e.breakOnError,isChild:!0});if(!t.success)return(0,u.failed)(void 0,t.message);n=t.value.value}const r=t.value.value;for(const t of r)try{const r=this.elScope.querySelectorAll(t);if(0===r.length)continue;const i=[];for(let t=0;t<r.length;t++){const o=r[t],c={};let s=!0;const l=this.factory.create(this.config,this.observer,o,this.main.getGlobalScope(),this.funcs,!1,c,this.main.getCurrencyList()),d={var:"$index",type:a.OperationType.LITERAL,value:`${t}`};await l.handle({operation:d,isChild:!0});for(const[t,r]of Object.entries(e.operations)){const e={var:"$scope",type:a.OperationType.LITERAL,value:o};await l.handle({operation:e,isChild:!0}),l.mergeLocalScope(this.main.programScope(!0));const i=await l.handle({operation:r,index:t});if(i.return)return(0,u.succeededAndReturn)(i.value.value);if(!i.success&&!r.optional){if(n)return(0,u.failed)(void 0,i.message);s=!1;break}this.clearScopeWith(c,[...Object.keys(this.main.getLocalScope()),...Object.keys(this.main.getGlobalScope()),e.var])}s&&(this.clearScopeWith(c,[d.var]),i.push(c))}return(0,u.succeeded)(i)}catch(e){return(0,u.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}return(0,u.failed)(void 0,"No scopes were found")}clearScopeWith(e,t){t.forEach((t=>{delete e[t]}))}};t.SplitScope=g,r([(0,h.requiredFields)("operations","selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],g.prototype,"handle",null),t.SplitScope=g=r([(0,l.injectable)(),o(0,(0,l.inject)(f.Injections.selectorsSolver)),o(1,(0,l.inject)(f.Injections.elScope)),o(2,(0,l.inject)(f.Injections.observer)),o(3,(0,l.inject)(f.Injections.factory)),o(4,(0,l.inject)(f.Injections.config)),o(5,(0,l.inject)(f.Injections.funcs)),o(6,(0,l.inject)(f.Injections.program)),i("design:paramtypes",[c.SelectorsSolver,Object,d.Observer,s.ProgramFactory,Object,Object,p.Program])],g)},32677:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryManager=void 0;const a=n(5139),c=n(35263),s=n(52650),u=n(48151);var l;!function(e){e.URL_CHANGED="URL_CHANGED",e.SHOPIFY_DETECTED="SHOPIFY_DETECTED"}(l||(l={}));let d=class{constructor(e){this.observer=e,this.scriptAttribute="extend-native-history-api",this.scriptPath="libs/extend-native-history-api.js";const t={[c.MessageScriptType.CUSTOM_ON_URL_CHANGED]:()=>{this.observer.emit(l.URL_CHANGED,location.href)},[c.MessageScriptType.SHOPIFY_DETECTED]:e=>{this.observer.emit(l.SHOPIFY_DETECTED,e.data.payload)}};window.addEventListener("message",(e=>{t[e.data._custom_type_]?.(e)}))}replaceNativeApi(){if(this.isHistoryScriptInjected())return;const e=document.createElement("script");e.src=chrome.runtime.getURL(this.scriptPath),(document.head||document.documentElement).append(e)}onUrlChanged(e){this.observer.subscribe(l.URL_CHANGED,e)}onShopifyDetected(e){this.observer.subscribe(l.SHOPIFY_DETECTED,e)}isHistoryScriptInjected(){const e=Boolean(document.querySelector(`script[ecommerce-type="${this.scriptAttribute}"]`)),t=Boolean(document.querySelector(`script[src*="${this.scriptPath}"]`));return e||t}};d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.ContentInjections.observer)),i("design:paramtypes",[a.Observer])],d),t.HistoryManager=d},33353:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.decorate=function(e,t,n){"number"==typeof n?p([h(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):p([e],t)},t.tagParameter=l,t.tagProperty=d,t.createTaggedDecorator=function(e){return(t,n,r)=>{"number"==typeof r?l(t,n,r,e):d(t,n,e)}};const c=a(n(35007)),s=a(n(19466)),u=n(48833);function l(e,t,n,r){!function(e){if(void 0!==e)throw new Error(c.INVALID_DECORATOR_OPERATION)}(t),f(s.TAGGED,e,n.toString(),r)}function d(e,t,n){if(void 0!==e.prototype)throw new Error(c.INVALID_DECORATOR_OPERATION);f(s.TAGGED_PROP,e.constructor,t,n)}function f(e,t,n,r){const i=function(e){let t=[];if(Array.isArray(e)){t=e;const n=(0,u.getFirstArrayDuplicate)(t.map((e=>e.key)));if(void 0!==n)throw new Error(`${c.DUPLICATED_METADATA} ${n.toString()}`)}else t=[e];return t}(r);let o={};Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));let a=o[n];if(void 0===a)a=[];else for(const e of a)if(i.some((t=>t.key===e.key)))throw new Error(`${c.DUPLICATED_METADATA} ${e.key.toString()}`);a.push(...i),o[n]=a,Reflect.defineMetadata(e,o,t)}function p(e,t){Reflect.decorate(e,t)}function h(e,t){return function(n,r){t(n,r,e)}}},33648:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Binding=void 0;const r=n(9117),i=n(37763);class o{id;moduleId;activated;serviceIdentifier;implementationType;cache;dynamicValue;scope;type;factory;provider;constraint;onActivation;onDeactivation;constructor(e,t){this.id=(0,i.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=e=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){const e=new o(this.serviceIdentifier,this.scope);return e.activated=e.scope===r.BindingScopeEnum.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e}}t.Binding=o},35007:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STACK_OVERFLOW=t.CIRCULAR_DEPENDENCY_IN_FACTORY=t.ON_DEACTIVATION_ERROR=t.PRE_DESTROY_ERROR=t.POST_CONSTRUCT_ERROR=t.ASYNC_UNBIND_REQUIRED=t.MULTIPLE_POST_CONSTRUCT_METHODS=t.MULTIPLE_PRE_DESTROY_METHODS=t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=t.ARGUMENTS_LENGTH_MISMATCH=t.INVALID_DECORATOR_OPERATION=t.INVALID_TO_SELF_VALUE=t.LAZY_IN_SYNC=t.INVALID_FUNCTION_BINDING=t.INVALID_MIDDLEWARE_RETURN=t.NO_MORE_SNAPSHOTS_AVAILABLE=t.INVALID_BINDING_TYPE=t.CIRCULAR_DEPENDENCY=t.UNDEFINED_INJECT_ANNOTATION=t.TRYING_TO_RESOLVE_BINDINGS=t.NOT_REGISTERED=t.CANNOT_UNBIND=t.AMBIGUOUS_MATCH=t.KEY_NOT_FOUND=t.NULL_ARGUMENT=t.DUPLICATED_METADATA=t.DUPLICATED_INJECTABLE_DECORATOR=void 0,t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";t.TRYING_TO_RESOLVE_BINDINGS=e=>`Trying to resolve bindings for "${e}"`;t.UNDEFINED_INJECT_ANNOTATION=e=>`@inject called with undefined this could mean that the class ${e} has a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation.`,t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";t.LAZY_IN_SYNC=e=>`You are attempting to construct ${function(e){if("function"==typeof e)return`[function/class ${e.name||"<anonymous>"}]`;if("symbol"==typeof e)return e.toString();return`'${e}'`}(e)} in a synchronous way but it has asynchronous dependencies.`,t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";t.ARGUMENTS_LENGTH_MISMATCH=e=>`The number of constructor arguments in the derived class ${e} must be >= than the number of constructor arguments of its base class.`,t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE='Invalid Container option. Default scope must be a string ("singleton" or "transient").',t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";t.POST_CONSTRUCT_ERROR=(e,t)=>`@postConstruct error in class ${e}: ${t}`;t.PRE_DESTROY_ERROR=(e,t)=>`@preDestroy error in class ${e}: ${t}`;t.ON_DEACTIVATION_ERROR=(e,t)=>`onDeactivation() error in class ${e}: ${t}`;t.CIRCULAR_DEPENDENCY_IN_FACTORY=(e,t)=>`It looks like there is a circular dependency in one of the '${e}' bindings. Please investigate bindings with service identifier '${t}'.`,t.STACK_OVERFLOW="Maximum call stack size exceeded"},35263:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageScriptType=t.MessageContentType=void 0,function(e){e.ECOMMERCE_INIT="ECOMMERCE_INIT",e.ECOMMERCE_RE_INIT="ECOMMERCE_RE_INIT",e.ECOMMERCE_TRACK="ECOMMERCE_TRACK",e.ECOMMERCE_STORAGE_SAVE="ECOMMERCE_STORAGE_SAVE",e.ECOMMERCE_STORAGE_REMOVE="ECOMMERCE_STORAGE_REMOVE",e.ERROR_TRACE="ERROR_TRACE",e.ECOMMERCE_INIT_SHOPIFY="ECOMMERCE_INIT_SHOPIFY"}(t.MessageContentType||(t.MessageContentType={})),function(e){e.INIT_HTTP_CONFIG="INIT_HTTP_CONFIG",e.HTTP_CONFIG_INJECTED="HTTP_CONFIG_INJECTED",e.SAVE_HTTP_DATA="SAVE_HTTP_DATA",e.CUSTOM_ON_URL_CHANGED="CUSTOM_ON_URL_CHANGED",e.SHOPIFY_DETECTED="SHOPIFY_DETECTED"}(t.MessageScriptType||(t.MessageScriptType={}))},35809:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Injections=void 0,function(e){e.logger="LOGGER",e.observer="OBSERVER",e.program="PROGRAM",e.factory="FACTORY",e.config="CONFIG",e.elScope="ELEMENT_SCOPE",e.funcs="FUNCTIONS",e.htmlElementSolver="HTML_ELEMENT_SOLVER",e.selectorsSolver="SELECTORS_SOLVER",e.loggerTracer="LOGGER_TRACER",e.operationTracer="OPERATION_TRACER",e.tracer="TRACER",e.currencyList="CURRENCY_LIST"}(n||(t.Injections=n={}))},36166:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnUrlChangedHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(57421),l=n(32677),d=n(16904),f=n(12668),p=n(58456),h=n(65334),g=n(85362),y=n(48885),m=n(15918),_=n(24769);let v=class{constructor(e,t,n,r,i){this.container=e,this.extractor=t,this.matcher=n,this.history=r,this.out=i;this.urlChanged=(0,y.debounce)((e=>{const t=this.config(),n=t?.initialUrl;if(e===n)return;if(this.log(`URL changed: "${e}"`),this.updateUrl(e),this.watcher()?.config?.onUrlChanged?.forEach((t=>{this.matcher.isUrlMatches(t,e)&&this.extractor?.run?.(t,h.WatcherHandler.onUrlChanged)})),(0,g.isIframe)())return;const r=this.watcher()?.detectUrlChanges??t?.marketplace?.detectUrlChanges;if(!r)return;if(!Array.isArray(r))return void this.out.reInit();r.some(this.urlMatchGroups(e,n))&&this.out.reInit()}))}handle(){this.history.onUrlChanged(this.urlChanged.bind(this))}updateUrl(e){const t={...this.config(),initialUrl:e};this.container.rebind(d.ConfigInjections.config).toConstantValue(t),this.storage().save(p.RESERVED_VARIABLES.$url,(0,m.parseUrl)(e))}log(e,...t){const n=this.container.get(c.ContentInjections.logger);n?.log?.(e,...t)}config(){return this.container.get(d.ConfigInjections.config)}watcher(){return this.container.get(c.ContentInjections.activeConfig)}storage(){return this.container.get(c.ContentInjections.contentStorage)}urlMatchGroups(e,t){return n=>{const r="object"==typeof n?n:{regex:n},i=e.match((0,_.getRegex)(r));if(null==i)return!1;if(1===i.length)return!0;const o=t.match((0,_.getRegex)(r));if(null==o||1===o.length)return!0;const[a,...c]=Array.from(i),[s,...u]=Array.from(o);return!c.every((e=>u.includes(e)))}}};v=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),o(2,(0,a.inject)(c.ContentInjections.matcher)),o(3,(0,a.inject)(c.ContentInjections.historyManager)),o(4,(0,a.inject)(c.ContentInjections.outContentMessageManager)),i("design:paramtypes",[a.Container,s.ExtractorManager,u.Matcher,l.HistoryManager,f.OutContentMessageManager])],v),t.OnUrlChangedHandler=v},36338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyQueryableStringImpl=void 0;t.LegacyQueryableStringImpl=class{#e;constructor(e){this.#e=e}startsWith(e){return this.#e.startsWith(e)}endsWith(e){return this.#e.endsWith(e)}contains(e){return this.#e.includes(e)}equals(e){return this.#e===e}value(){return this.#e}}},37763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.id=function(){return n++};let n=0},37893:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseType=function(e){const t=Object.getPrototypeOf(e.prototype),n=t?.constructor;return n}},39084:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseHandler=void 0;const i=n(52650);let o=class{};t.BaseHandler=o,t.BaseHandler=o=r([(0,i.injectable)()],o)},39376:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectorsSolver=void 0;const a=n(90726),c=n(64434),s=n(52650),u=n(35809),l=n(18195);let d=class{constructor(e){this.main=e}async solve(e){if(!Array.isArray(e)||0===e.length)return(0,c.failed)(void 0,'Argument for "selectors" must be non-empty an array',l.NativeOperationType.NATIVE_ERROR);const t=[];for(const n of e){const e=await this.main.handle({operation:n,isChild:!0});if((0,c.isFailed)(e,n))return(0,c.failed)(void 0,e.message);t.push(e.value.value)}return(0,c.succeeded)(t)}};t.SelectorsSolver=d,t.SelectorsSolver=d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.program)),i("design:paramtypes",[a.Program])],d)},39755:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnInputChangeHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(58456),l=n(65334);let d=class{constructor(e,t){this.container=e,this.extractor=t}handle(){document.addEventListener("change",this.changeHandler.bind(this),{capture:!0})}watcher(){return this.container.get(c.ContentInjections.activeConfig)}logger(){return this.container.get(c.ContentInjections.logger)}changeHandler(e){this.watcher()?.config?.onInputChange?.forEach((t=>{try{const n=e.target;if(n.matches(t.selector)&&["INPUT","SELECT","TEXTAREA"].includes(n.tagName)){const n={[u.RESERVED_VARIABLES.$element]:e.target,[u.RESERVED_VARIABLES.$event]:e,[u.RESERVED_VARIABLES.$elementValue]:e.target.value};this.extractor?.run?.(t,l.WatcherHandler.onInputChange,n)}}catch(e){this.logger().error(`\n Handler: "${l.WatcherHandler.onInputChange}". \n Event: "${t.event}". \n Error: "${e.message}"`)}}))}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnInputChangeHandler=d},41129:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDescription=function(e){return e.toString().slice(n,r)};const n=7,r=-1},41136:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getter=function(e,t){const n={[r.SINGLE_GET_TYPE.TEXT]:()=>{const e=t;return(e.innerText||e.textContent).trim()},[r.SINGLE_GET_TYPE.VALUE]:()=>t.value,[r.SINGLE_GET_TYPE.ATTRIBUTE]:()=>t.getAttribute(e.attr)};return n[e.get]?n[e.get]():n[r.SINGLE_GET_TYPE.TEXT]()};const r=n(18195)},41402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenOnSyntax=void 0;const r=n(87059),i=n(90732);t.BindingWhenOnSyntax=class{_bindingWhenSyntax;_bindingOnSyntax;_binding;constructor(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}},41815:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Computed=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.COMPUTED}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=[];for(const n of e.subjects){const e=await this.main.handle({operation:n,isChild:!0});if(!e.success)return(0,s.failed)(void 0,e.message);t.push(e.value.value)}let n;if(Array.isArray(e.value)){n=[];for(const t of e.value)n.push((await this.main.handle({operation:t,isChild:!0})).value.value)}else n=(await this.main.handle({operation:e.value,isChild:!0})).value.value;const r={var:t.join("."),type:a.OperationType.LITERAL,value:n,accumulate:e.accumulate};return await this.main.handle({operation:r,isChild:!0}),(0,s.succeeded)(n)}};t.Computed=f,r([(0,d.requiredFields)("subjects","value"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.Computed=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},42811:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.GetProperty=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.GET_PROPERTY}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.subject,isChild:!0}),n=t.value.value;if(!t.success||!(0,s.isObject)(n))return(0,s.failed)(void 0,t.message);const r=n[(await this.main.handle({operation:e.prop,isChild:!0})).value.value];return(0,s.succeeded)(r)}};t.GetProperty=f,r([(0,d.requiredFields)("subject","prop"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.GetProperty=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},43343:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Emit=void 0;const a=n(90726),c=n(53425),s=n(54114),u=n(64434),l=n(18195),d=n(52650),f=n(35809),p=n(67161);let h=class{constructor(e,t,n){this.main=e,this.observer=t,this.factory=n}type(){return l.OperationType.EMIT}scope(){return l.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.event,isChild:!0});if((0,u.isFailed)(t,e.event))return(0,u.failed)(void 0,t.message);if("string"!=typeof t.value.value)return(0,u.failed)(void 0,"Event name was not provided properly. It should be a string",l.NativeOperationType.NATIVE_ERROR);const n=(0,u.succeeded)([]);if(null!=e.args&&Array.isArray(e.args)){const t=this.factory.prototype(this.main);for(const t of e.args){const e=await this.main.handle({operation:t,isChild:!0});if((0,u.isFailed)(e,t))return(0,u.failed)(void 0,e.message);const r=e.value.value,i=(0,u.isObject)(r)?(0,u.clone)(r):r;n.value.value.push(i)}this.main.mergeLocalScope(t.getLocalScope())}return this.observer.emit(t.value.value,n?n.value.value:void 0),(0,u.succeeded)(!0)}};t.Emit=h,r([(0,p.requiredFields)("event"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],h.prototype,"handle",null),t.Emit=h=r([(0,d.injectable)(),o(0,(0,d.inject)(f.Injections.program)),o(1,(0,d.inject)(f.Injections.observer)),o(2,(0,d.inject)(f.Injections.factory)),i("design:paramtypes",[a.Program,c.Observer,s.ProgramFactory])],h)},44063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassElementMetadataFromLegacyMetadata=function(e){const t=e.find((e=>e.key===o.INJECT_TAG)),n=e.find((e=>e.key===o.MULTI_INJECT_TAG));if(void 0!==e.find((e=>e.key===o.UNMANAGED_TAG)))return function(e,t){if(void 0!==t||void 0!==e)throw new r.InversifyCoreError(i.InversifyCoreErrorKind.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:a.ClassElementMetadataKind.unmanaged}}(t,n);if(void 0===n&&void 0===t)throw new r.InversifyCoreError(i.InversifyCoreErrorKind.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");const c=e.find((e=>e.key===o.NAMED_TAG)),s=e.find((e=>e.key===o.OPTIONAL_TAG)),u=e.find((e=>e.key===o.NAME_TAG));return{kind:void 0===t?a.ClassElementMetadataKind.multipleInjection:a.ClassElementMetadataKind.singleInjection,name:c?.value,optional:void 0!==s,tags:new Map(e.filter((e=>o.NON_CUSTOM_TAG_KEYS.every((t=>e.key!==t)))).map((e=>[e.key,e.value]))),targetName:u?.value,value:void 0===t?n?.value:t.value}};const r=n(21773),i=n(94931),o=n(83313),a=n(86277)},44741:(e,t,n)=>{var r;!function(e){!function(){var t="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=i(e);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===t.Reflect?t.Reflect=e:r=i(t.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!o&&!a,s={create:o?function(){return re(Object.create(null))}:a?function(){return re({__proto__:null})}:function(){return re({})},has:c?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:c?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,f=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(l||"function"!=typeof WeakMap?ne():WeakMap);function h(e,t,n,r){if(L(n)){if(!$(e))throw new TypeError;if(!W(t))throw new TypeError;return R(e,t)}if(!$(e))throw new TypeError;if(!x(t))throw new TypeError;if(!x(r)&&!L(r)&&!B(r))throw new TypeError;return B(r)&&(r=void 0),T(e,t,n=k(n),r)}function g(e,t){function n(n,r){if(!x(n))throw new TypeError;if(!L(r)&&!Y(r))throw new TypeError;P(e,t,n,r)}return n}function y(e,t,n,r){if(!x(n))throw new TypeError;return L(r)||(r=k(r)),P(e,t,n,r)}function m(e,t,n){if(!x(t))throw new TypeError;return L(n)||(n=k(n)),A(e,t,n)}function _(e,t,n){if(!x(t))throw new TypeError;return L(n)||(n=k(n)),I(e,t,n)}function v(e,t,n){if(!x(t))throw new TypeError;return L(n)||(n=k(n)),C(e,t,n)}function b(e,t,n){if(!x(t))throw new TypeError;return L(n)||(n=k(n)),M(e,t,n)}function O(e,t){if(!x(e))throw new TypeError;return L(t)||(t=k(t)),D(e,t)}function E(e,t){if(!x(e))throw new TypeError;return L(t)||(t=k(t)),w(e,t)}function j(e,t,n){if(!x(t))throw new TypeError;L(n)||(n=k(n));var r=S(t,n,!1);if(L(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}function R(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!L(r)&&!B(r)){if(!W(r))throw new TypeError;t=r}}return t}function T(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!L(o)&&!B(o)){if(!x(o))throw new TypeError;r=o}}return r}function S(e,t,n){var r=p.get(e);if(L(r)){if(!n)return;r=new d,p.set(e,r)}var i=r.get(t);if(L(i)){if(!n)return;i=new d,r.set(t,i)}return i}function A(e,t,n){if(I(e,t,n))return!0;var r=Q(t);return!B(r)&&A(e,r,n)}function I(e,t,n){var r=S(t,n,!1);return!L(r)&&U(r.has(e))}function C(e,t,n){if(I(e,t,n))return M(e,t,n);var r=Q(t);return B(r)?void 0:C(e,r,n)}function M(e,t,n){var r=S(t,n,!1);if(!L(r))return r.get(e)}function P(e,t,n,r){S(n,r,!0).set(e,t)}function D(e,t){var n=w(e,t),r=Q(e);if(null===r)return n;var i=D(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new f,a=[],c=0,s=n;c<s.length;c++){var u=s[c];o.has(u)||(o.add(u),a.push(u))}for(var l=0,d=i;l<d.length;l++){u=d[l];o.has(u)||(o.add(u),a.push(u))}return a}function w(e,t){var n=[],r=S(e,t,!1);if(L(r))return n;for(var i=J(r.keys()),o=0;;){var a=Z(i);if(!a)return n.length=o,n;var c=z(a);try{n[o]=c}catch(e){try{X(i)}finally{throw e}}o++}}function N(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function L(e){return void 0===e}function B(e){return null===e}function F(e){return"symbol"==typeof e}function x(e){return"object"==typeof e?null!==e:"function"==typeof e}function G(e,t){switch(N(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=q(e,r);if(void 0!==i){var o=i.call(e,n);if(x(o))throw new TypeError;return o}return H(e,"default"===n?"number":n)}function H(e,t){if("string"===t){var n=e.toString;if(K(n))if(!x(i=n.call(e)))return i;if(K(r=e.valueOf))if(!x(i=r.call(e)))return i}else{var r;if(K(r=e.valueOf))if(!x(i=r.call(e)))return i;var i,o=e.toString;if(K(o))if(!x(i=o.call(e)))return i}throw new TypeError}function U(e){return!!e}function V(e){return""+e}function k(e){var t=G(e,3);return F(t)?t:V(t)}function $(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function K(e){return"function"==typeof e}function W(e){return"function"==typeof e}function Y(e){switch(N(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var n=e[t];if(null!=n){if(!K(n))throw new TypeError;return n}}function J(e){var t=q(e,i);if(!K(t))throw new TypeError;var n=t.call(e);if(!x(n))throw new TypeError;return n}function z(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function ne(){var e=16,n=s.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&s.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?s.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(s.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:s.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function c(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function u(){var t=c(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",h),e("metadata",g),e("defineMetadata",y),e("hasMetadata",m),e("hasOwnMetadata",_),e("getMetadata",v),e("getOwnMetadata",b),e("getMetadataKeys",O),e("getOwnMetadataKeys",E),e("deleteMetadata",j)}(r)}()}(r||(r={}))},44892:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractorManager=void 0;const a=n(26504),c=n(18195),s=n(12668),u=n(52650),l=n(48151),d=n(16904),f=n(11497),p=n(58456);let h=class{constructor(e,t){this.out=e,this.container=t}run(e,t,n={}){const{initialUrl:r,marketplace:i}=this.libConfig()??{},o={marketplace:i.name,templateVersion:i.version,event:e.event,url:r,lang:document.documentElement.lang},a={[c.ExtractorResponseStatus.SUCCESS]:({response:t})=>{this.out.track({...o,title:document.title,data:t},e)},[c.ExtractorResponseStatus.FAILED]:({response:n})=>{this.out.errorTrace(n,t,e,r)},[c.ExtractorResponseStatus.INTERRUPTED]:e=>{this.logger().error(e.response)}},s=async()=>{const t=this.makeExtractor(e.operations,document,n),r=await t.run();a[r.status]?.(r)};e.waitMs?setTimeout(s,e.waitMs):s()}get config(){return{log:this.libConfig().logging}}makeExtractor(e,t,n){const r=new a.Extractor(this.config,e,t,{...this.storage().getStorage(),...n},this.watcher().config.func);return this.currencyList()&&r.setCurrency(this.currencyList()),r.on(p.ExtractorEvents.STORAGE_SAVE,this.onStorageSave.bind(this)),r.on(p.ExtractorEvents.STORAGE_REMOVE,this.onStorageRemoveEvent.bind(this)),r}onStorageSave([e,t]){this.storage().save(e,t),this.out.storageSave(e,t)}onStorageRemoveEvent([e]){this.storage().remove(e),this.out.storageRemove(e)}libConfig(){return this.container.get(d.ConfigInjections.config)}storage(){return this.container.get(l.ContentInjections.contentStorage)}watcher(){return this.container.get(l.ContentInjections.activeConfig)}logger(){return this.container.get(l.ContentInjections.logger)}currencyList(){return this.container.get(l.ContentInjections.currencyList)}};r([(0,f.validateArgs)(p.ExtractorEvents.STORAGE_SAVE),i("design:type",Function),i("design:paramtypes",[Array]),i("design:returntype",void 0)],h.prototype,"onStorageSave",null),r([(0,f.validateArgs)(p.ExtractorEvents.STORAGE_REMOVE),i("design:type",Function),i("design:paramtypes",[Array]),i("design:returntype",void 0)],h.prototype,"onStorageRemoveEvent",null),h=r([(0,u.injectable)(),o(0,(0,u.inject)(l.ContentInjections.outContentMessageManager)),o(1,(0,u.inject)(l.ContentInjections.DI)),i("design:paramtypes",[s.OutContentMessageManager,u.Container])],h),t.ExtractorManager=h},45639:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnWindowLoadHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(65334),l=n(85362);let d=class{constructor(e,t){this.container=e,this.extractor=t}handle(){(0,l.isIframe)()||("complete"!==document.readyState?window.addEventListener("load",this.extractWindowLoadHandlers.bind(this)):this.extractWindowLoadHandlers())}extractWindowLoadHandlers(){this.watcher()?.config?.onWindowLoad?.forEach((e=>{this.extractor?.run?.(e,u.WatcherHandler.onWindowLoad)}))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnWindowLoadHandler=d},46872:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnPostMessageHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(57421),l=n(58456),d=n(65334);let f=class{constructor(e,t,n){this.container=e,this.extractor=t,this.matcher=n}handle(){window.addEventListener("message",this.listener.bind(this))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}listener({data:e,origin:t,source:n}){this.watcher()?.config?.onPostMessage?.forEach((r=>{const i=this.matcher.isUrlMatches(r,t),o=this.matcher.isDataMatches(e,r.schemas);if(!i||!o)return;let a={[l.RESERVED_VARIABLES.$data]:e};try{a={...a,[l.RESERVED_VARIABLES.$scope]:n.document}}catch{a={...a,[l.RESERVED_VARIABLES.$scope]:document}}this.extractor?.run?.(r,d.WatcherHandler.onPostMessage,a)}))}};f=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),o(2,(0,a.inject)(c.ContentInjections.matcher)),i("design:paramtypes",[a.Container,s.ExtractorManager,u.Matcher])],f),t.OnPostMessageHandler=f},47748:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const a=n(52650),c=n(16904);let s=class{constructor(e){this.config=e,this.loggerLabel="%c[ECOMMERCE]",this.loggerLabelStyle="background-color: lightgreen; font-weight: bold; padding: 2px;"}log(e,...t){this.config.logging}error(e,...t){this.config.logging}};s=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ConfigInjections.config)),i("design:paramtypes",[Object])],s),t.Logger=s},48151:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentInjections=void 0,function(e){e.contentStorage="contentStorage",e.requestsManager="requestsManager",e.inContentMessageManager="inContentMessageManager",e.outContentMessageManager="outContentMessageManager",e.historyManager="historyManager",e.extractorManager="extractorManager",e.observer="observer",e.logger="logger",e.matcher="matcher",e.ID="CONTENT_ID",e.DI="CONTENT_INJECTION",e.activeConfig="activeConfig",e.interceptorsHandler="interceptorsHandler",e.onClickHandler="onClickHandler",e.onInputChangeHandler="onInputChangeHandler",e.onDomLoadHandler="onDomLoadHandler",e.onIframeLoadedHandler="onIframeLoadedHandler",e.onLoadHandler="onLoadHandler",e.onPostMessageHandler="onPostMessageHandler",e.onUrlChangedHandler="onUrlChangedHandler",e.onWindowLoadHandler="onWindowLoadHandler",e.onDomChangedHandler="onDomChangedHandler",e.onKeyDownHandler="onKeyDownHandler",e.currencyList="currencyList"}(t.ContentInjections||(t.ContentInjections={}))},48724:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.currencyParser=void 0;const r=n(64434),i=["BHD","JOD","KWD","OMR"],o=new RegExp((0,r.makeRegExpStringFromArray)([",","."])),a=`[\\d${o.source}]+`,c={"٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9"};t.currencyParser=(e,t,n=!0,s=!1)=>{if("string"!=typeof e)return{success:!1,message:`Input value is not a string. Type: ${typeof e}. Value - ${JSON.stringify(e)}`};let u=e.replace(/(\s|&nbsp;|‎|\u200E|RLM|\u200F|\u061C)/g,"");Object.keys(c).some((e=>u.includes(e)))&&(u=(e=>e.replace(/[\u0660-\u0669]/g,(e=>c[e])).replace(/٫/g,"."))(u));const l=u.includes("-"),d=l?u.replace("-",""):u;if(0===d.length)return{success:!1,message:"Input string is empty"};const f=(e=>`${(0,r.makeRegExpStringFromArray)(Object.keys(e))}`)(t),p=((e,t)=>{const n=`(${a})`,r=`(${e})`,i=t?"":"?";return new RegExp(`${n}\\s*${r}${i}|${r}${i}\\s*${n}\\.?`)})(f,n),h=d.match(p);if(null===h)return{success:!1,message:`Input string is invalid. Initial value is "${e}"`};const g=h[2]??h[3],y=h[1]??h[4],m=t[g]?.currency??null,_=((e,t)=>{const n=e.split(o);if(1===n.length)return e;const[r]=n.splice(-1,1),a=i.includes(t),c=3===r.length,s=r.length<3,u=a&&c||s?".":"";return`${n.join("")}${u}${r}`})(y,m),v=parseFloat(_);return{success:!0,result:{price:s?Math.abs(v):l?-v:v,currency:m}}}},48833:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstArrayDuplicate=function(e){const t=new Set;for(const n of e){if(t.has(n))return n;t.add(n)}return}},48885:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.DEFAULT_DEBOUNCE_TIME=void 0,t.DEFAULT_DEBOUNCE_TIME=150;t.debounce=(e,n=t.DEFAULT_DEBOUNCE_TIME)=>{let r=0;return(...t)=>{clearTimeout(r),r=setTimeout((()=>e(...t)),n)}}},49195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTargets=void 0;const r=n(49343),i=n(8841),o=n(9750),a=n(7520),c=n(16586);t.getTargets=e=>{const t=void 0===e?r.getClassMetadata:t=>(0,i.getClassMetadataFromMetadataReader)(t,e),n=void 0===e?o.getClassMetadataProperties:t=>(0,a.getClassMetadataPropertiesFromMetadataReader)(t,e);return(0,c.getTargetsFromMetadataProviders)(t,n)}},49343:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadata=function(e){const t=(0,r.getReflectMetadata)(e,i.POST_CONSTRUCT),n=(0,r.getReflectMetadata)(e,i.PRE_DESTROY);return{constructorArguments:(0,o.getClassMetadataConstructorArguments)(e),lifecycle:{postConstructMethodName:t?.value,preDestroyMethodName:n?.value},properties:(0,a.getClassMetadataProperties)(e)}};const r=n(99757),i=n(83313),o=n(62719),a=n(9750)},49592:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.MAP}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.subject,isChild:!0});if(!t.success)return(0,s.failed)(void 0,t.message);const n=t.value.value,r=(await this.main.handle({operation:e.dictionary,isChild:!0})).value.value??[];let i=!1===e.trim?n:n.trim();const o=void 0===e.caseSensitive||!e.caseSensitive;i=o?i.toLowerCase():i;for(const e of r){if((o?e.key.map((e=>e.toLowerCase())):e.key).includes(i))return(0,s.succeeded)(e.value)}if(void 0!==e.defaultValue){const t=await this.main.handle({operation:e.defaultValue,isChild:!0});if(t.success)return(0,s.succeeded)(t.value.value)}return(0,s.failed)(void 0,`Subject "${n}" was not found in any dictionary to map`)}};t.Map=f,r([(0,d.requiredFields)("subject","dictionary"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.Map=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},52650:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=t.getServiceIdentifierAsString=t.typeConstraint=t.namedConstraint=t.taggedConstraint=t.traverseAncerstors=t.decorate=t.id=t.MetadataReader=t.preDestroy=t.postConstruct=t.targetName=t.multiInject=t.unmanaged=t.optional=t.inject=t.named=t.tagged=t.injectable=t.createTaggedDecorator=t.ContainerModule=t.AsyncContainerModule=t.TargetTypeEnum=t.BindingTypeEnum=t.BindingScopeEnum=t.Container=t.METADATA_KEY=t.LazyServiceIdentifer=t.LazyServiceIdentifier=void 0,n(44741);const c=n(5265),s=a(n(19466));var u=n(5265);Object.defineProperty(t,"LazyServiceIdentifier",{enumerable:!0,get:function(){return u.LazyServiceIdentifier}}),t.LazyServiceIdentifer=c.LazyServiceIdentifier,t.METADATA_KEY=s;var l=n(71697);Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return l.Container}});var d=n(9117);Object.defineProperty(t,"BindingScopeEnum",{enumerable:!0,get:function(){return d.BindingScopeEnum}}),Object.defineProperty(t,"BindingTypeEnum",{enumerable:!0,get:function(){return d.BindingTypeEnum}}),Object.defineProperty(t,"TargetTypeEnum",{enumerable:!0,get:function(){return d.TargetTypeEnum}});var f=n(60548);Object.defineProperty(t,"AsyncContainerModule",{enumerable:!0,get:function(){return f.AsyncContainerModule}}),Object.defineProperty(t,"ContainerModule",{enumerable:!0,get:function(){return f.ContainerModule}});var p=n(33353);Object.defineProperty(t,"createTaggedDecorator",{enumerable:!0,get:function(){return p.createTaggedDecorator}});var h=n(28633);Object.defineProperty(t,"injectable",{enumerable:!0,get:function(){return h.injectable}});var g=n(23108);Object.defineProperty(t,"tagged",{enumerable:!0,get:function(){return g.tagged}});var y=n(53719);Object.defineProperty(t,"named",{enumerable:!0,get:function(){return y.named}});var m=n(94269);Object.defineProperty(t,"inject",{enumerable:!0,get:function(){return m.inject}});var _=n(66004);Object.defineProperty(t,"optional",{enumerable:!0,get:function(){return _.optional}});var v=n(98986);Object.defineProperty(t,"unmanaged",{enumerable:!0,get:function(){return v.unmanaged}});var b=n(4035);Object.defineProperty(t,"multiInject",{enumerable:!0,get:function(){return b.multiInject}});var O=n(86331);Object.defineProperty(t,"targetName",{enumerable:!0,get:function(){return O.targetName}});var E=n(68480);Object.defineProperty(t,"postConstruct",{enumerable:!0,get:function(){return E.postConstruct}});var j=n(56294);Object.defineProperty(t,"preDestroy",{enumerable:!0,get:function(){return j.preDestroy}});var R=n(263);Object.defineProperty(t,"MetadataReader",{enumerable:!0,get:function(){return R.MetadataReader}});var T=n(37763);Object.defineProperty(t,"id",{enumerable:!0,get:function(){return T.id}});var S=n(33353);Object.defineProperty(t,"decorate",{enumerable:!0,get:function(){return S.decorate}});var A=n(26727);Object.defineProperty(t,"traverseAncerstors",{enumerable:!0,get:function(){return A.traverseAncerstors}}),Object.defineProperty(t,"taggedConstraint",{enumerable:!0,get:function(){return A.taggedConstraint}}),Object.defineProperty(t,"namedConstraint",{enumerable:!0,get:function(){return A.namedConstraint}}),Object.defineProperty(t,"typeConstraint",{enumerable:!0,get:function(){return A.typeConstraint}});var I=n(56272);Object.defineProperty(t,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return I.getServiceIdentifierAsString}});var C=n(8835);Object.defineProperty(t,"multiBindToService",{enumerable:!0,get:function(){return C.multiBindToService}})},52727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassElementMetadataFromNewable=function(e){return{kind:r.ClassElementMetadataKind.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:e}};const r=n(86277)},52760:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInWhenOnSyntax=void 0;const r=n(27161),i=n(87059),o=n(90732);t.BindingInWhenOnSyntax=class{_bindingInSyntax;_bindingWhenSyntax;_bindingOnSyntax;_binding;constructor(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}},53425:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Observer=void 0;const i=n(52650);let o=class{constructor(){this.listeners={}}emit(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>{e(t)}))}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}};t.Observer=o,t.Observer=o=r([(0,i.injectable)()],o)},53719:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.named=function(e){return(0,u.createTaggedDecorator)(new s.Metadata(c.NAMED_TAG,e))};const c=a(n(19466)),s=n(4045),u=n(33353)},54114:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ProgramFactory=void 0;const i=n(90726),o=n(60029),a=n(77345),c=n(66520),s=n(41815),u=n(71238),l=n(26029),d=n(82106),f=n(25290),p=n(86389),h=n(91293),g=n(21352),y=n(49592),m=n(89771),_=n(78487),v=n(91679),b=n(13198),O=n(62581),E=n(67167),j=n(953),R=n(31965),T=n(8260),S=n(6591),A=n(42811),I=n(43343),C=n(29346),M=n(96085),P=n(29472),D=n(59246),w=n(22888),N=n(52650),L=n(8358),B=n(59209),F=n(79101),x=n(18353);let G=class{create(e,t,n,r={},o,a=!1,c={},s){const u=new i.Program(e,t,n,r,o,this,this.handlers(),c,s);return a&&u.initTrace(),u}prototype(e){return this.create(e.getConfig(),e.getObserver(),e.getElScopeRef(),e.getGlobalScope(),e.getFuncsRef(),!1,e.cloneLocalScope(),e.getCurrencyList())}handlers(){return{CLOSEST:c.Closest,EXIST:u.ExistElement,IS_NOT_HIDDEN_ELEMENT:f.IsNotHiddenElement,SELECT:E.Select,AND:o.And,CONDITION:M.Condition,OR:_.Or,FLOW:C.Flow,FOR_EACH:l.ForEach,MATH:w.MathAction,CALL_METHOD:a.CallMethod,GET_PROPERTY:A.GetProperty,JSON_PARSER:p.JsonParser,PRICE_PARSER:b.PriceParser,PLURAL:v.Plural,SINGLE:j.Single,SPLIT_SCOPE:R.SplitScope,REPLACE:P.Replace,REPLACE_BETWEEN:D.ReplaceBetween,MARK_PROCESSED_ELEMENT:m.MarkProcessedElement,WAIT_FOR_NOT_PROCESSED_ELEMENT:S.WaitForNotProcessedElementHandler,COMPUTED:s.Computed,EMIT:I.Emit,FUNC:d.Func,LITERAL:h.Literal,LOG:g.Log,MAP:y.Map,RETURN:O.ReturnOperationHandler,VAR:T.Variable,CONSTRUCTOR:L.Constructor,INTERRUPT:B.Interrupt,BREAK:x.Break,CONTINUE:F.Continue}}};t.ProgramFactory=G,t.ProgramFactory=G=r([(0,N.injectable)()],G)},55028:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseType=function(e){const t=Object.getPrototypeOf(e.prototype),n=t?.constructor;return n}},56258:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnKeyDownHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(58456),l=n(65334),d=n(24769);let f=class{constructor(e,t){this.container=e,this.extractor=t}handle(){document.addEventListener("keydown",this.onKeyDown.bind(this),{capture:!0})}onKeyDown(e){this.watcher().config.onKeyDown?.forEach?.((t=>{try{if(!e.target.matches(t.selector))return;if(!(0,d.getRegex)(t.keyRegex).test(e.key))return;const n={[u.RESERVED_VARIABLES.$element]:e.target,[u.RESERVED_VARIABLES.$event]:e};this.extractor?.run?.(t,l.WatcherHandler.onKeyDown,n)}catch(e){this.logger().error(`\n Handler: "${l.WatcherHandler.onKeyDown}". \n Event: "${t.event}". \n Error: "${e.message}"`)}}))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}logger(){return this.container.get(c.ContentInjections.logger)}};f=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],f),t.OnKeyDownHandler=f},56272:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionName=l,t.getServiceIdentifierAsString=s,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){let r="";const i=n(e,t);0!==i.length&&(r="\nRegistered bindings:",i.forEach((e=>{let t="Object";null!==e.implementationType&&(t=l(e.implementationType)),r=`${r}\n ${t}`,e.constraint.metaData&&(r=`${r} - ${e.constraint.metaData}`)})));return r},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){let n="";const r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=d(r)+"\n"),null!==i&&i.forEach((e=>{n+=d(e)+"\n"})),` ${e}\n ${e} - ${n}`}return` ${e}`},t.circularDependencyToException=function e(t){t.childRequests.forEach((n=>{if(u(t,n.serviceIdentifier)){const e=function(e){function t(e,n=[]){const r=s(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}const n=t(e);return n.reverse().join(" --\x3e ")}(n);throw new Error(`${c.CIRCULAR_DEPENDENCY} ${e}`)}e(n)}))},t.getSymbolDescription=function(e){return e.toString().slice(7,-1)};const c=a(n(35007));function s(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function u(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||u(e.parentRequest,t))}function l(e){if(null!=e.name&&""!==e.name)return e.name;{const t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return null===n?`Anonymous function: ${t}`:n[1]}}function d(e){return`{"key":"${e.key.toString()}","value":"${e.value.toString()}"}`}},56294:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.preDestroy=void 0;const c=a(n(35007)),s=a(n(19466)),u=(0,n(89260).propertyEventDecorator)(s.PRE_DESTROY,c.MULTIPLE_PRE_DESTROY_METHODS);t.preDestroy=u},57421:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Matcher=void 0;const i=n(52650),o=n(24769);let a=class{isDataMatches(e,t=[]){return!t?.length||t.some((t=>{const n=this.dataStrategies[t.type];if(!n)throw new Error(`Matcher: Not correct schema type "${t.type}".`);return n(e,t)}))}isUrlMatches({regex:e},t){return(0,o.getRegex)(e).test(t)}primitiveStrategies(e,{type:t,value:n}){return!(typeof e!==t.toLowerCase())&&(void 0===n||n.some((t=>t===e)))}get dataStrategies(){return{Number:this.primitiveStrategies,String:this.primitiveStrategies,Boolean:this.primitiveStrategies,Null:e=>null===e,Undefined:e=>void 0===e,Array:(e,{value:t,min:n,max:r})=>!!Array.isArray(e)&&(!(void 0!==n&&e.length<n)&&(!(void 0!==r&&e.length>r)&&(void 0===t||t.some((t=>e.every((e=>this.isDataMatches(e,[t])))))))),Object:(e,{value:t})=>!(!(e instanceof Object)||Array.isArray(e))&&(void 0===t||t.some((t=>{const n=Object.entries(t);return 0===n.length?0===Object.keys(e).length:n.every((([t,n])=>e.hasOwnProperty(t)&&this.isDataMatches(e[t],[n])))})))}}};a=r([(0,i.injectable)()],a),t.Matcher=a},58456:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractorEvents=t.RESERVED_VARIABLES=void 0,function(e){e.$url="$url",e.$shopify="$shopify",e.$event="$event",e.$element="$element",e.$parent="$parent",e.$child="$child",e.$data="$data",e.$scope="$scope",e.$elementValue="$elementValue",e.$globalThis="$globalThis"}(t.RESERVED_VARIABLES||(t.RESERVED_VARIABLES={})),function(e){e.STORAGE_SAVE="@runtime.storage.save",e.STORAGE_REMOVE="@runtime.storage.remove"}(t.ExtractorEvents||(t.ExtractorEvents={}))},58509:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid=void 0,t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},59209:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Interrupt=void 0;const a=n(18195),c=n(52650),s=n(35809),u=n(59670);let l=class{constructor(e){this.logger=e}type(){return a.OperationType.INTERRUPT}scope(){return a.OperationScope.LOCAL}async*handle({msg:e}){throw e&&this.logger.log(e),new Error(e??"Operations were interrupted")}};t.Interrupt=l,t.Interrupt=l=r([(0,c.injectable)(),o(0,(0,c.inject)(s.Injections.logger)),i("design:paramtypes",[u.MyLogger])],l)},59246:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReplaceBetween=void 0;const a=n(18195),c=n(54114),s=n(64434),u=n(52650),l=n(35809),d=n(90726),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return a.OperationType.REPLACE_BETWEEN}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=this.factory.prototype(this.main),n=await t.handle({operation:e.subject,isChild:!0});if(!n.success)return(0,s.failed)(void 0,n.message);const r=await t.handle({operation:e.start,isChild:!0});if(!r.success)return(0,s.failed)(void 0,r.message);const i=await t.handle({operation:e.end,isChild:!0});if(!i.success)return(0,s.failed)(void 0,i.message);const o=await t.handle({operation:e.replacement,isChild:!0});if(!o.success)return(0,s.failed)(void 0,o.message);const a=this.replaceBetween(n.value.value,o.value.value,r.value.value,i.value.value);return this.main.mergeLocalScope(t.getLocalScope()),(0,s.succeeded)(a)}replaceBetween(e,t,n,r){const i=e.indexOf(n);if(-1===i)return e;const o=e.lastIndexOf(r);if(-1===o)return e;return e.substring(0,i)+t+e.substring(o+r.length)}};t.ReplaceBetween=p,r([(0,f.requiredFields)("subject","start","end","replacement"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.ReplaceBetween=p=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),o(1,(0,u.inject)(l.Injections.factory)),i("design:paramtypes",[d.Program,c.ProgramFactory])],p)},59670:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MyLogger=void 0;const a=n(52650),c=n(35809);let s=class{constructor(e){this.config=e,this.loggerLabel="%c[JSON-EXTRACTOR]",this.loggerLabelStyle="background-color: greenyellow; font-weight: bold; padding: 2px;"}log(e,...t){this.config.log}error(e,...t){this.config.log}forceLog(e,...t){}};t.MyLogger=s,t.MyLogger=s=r([(0,a.injectable)(),o(0,(0,a.inject)(c.Injections.config)),i("design:paramtypes",[Object])],s)},60029:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.And=void 0;const a=n(90726),c=n(54114),s=n(64434),u=n(18195),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return u.OperationType.AND}scope(){return u.OperationScope.BLOCK}async*handle(e){const t=this.factory.prototype(this.main);for(const[n,r]of Object.entries(e.operations??[])){const e=await t.handle({operation:r,index:n});if(e.return)return(0,s.succeededAndReturn)(e.value.value);if((0,s.isFailed)(e,r)||!e.value.value)return(0,s.failed)(!1,e.message)}return this.main.mergeLocalScope(t.getLocalScope()),(0,s.succeeded)(!0)}};t.And=p,r([(0,f.requiredFields)("operations"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.And=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),i("design:paramtypes",[a.Program,c.ProgramFactory])],p)},60548:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncContainerModule=t.ContainerModule=void 0;const r=n(37763);t.ContainerModule=class{id;registry;constructor(e){this.id=(0,r.id)(),this.registry=e}};t.AsyncContainerModule=class{id;registry;constructor(e){this.id=(0,r.id)(),this.registry=e}}},61823:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionName=void 0,t.getDependencies=function(e,t){return(0,c.getTargets)(e)(t)},t.getBaseClassDependencyCount=function e(t,n){const r=(0,u.getBaseType)(n);if(void 0===r||r===Object)return 0;const i=(0,c.getTargets)(t)(r),o=i.map((e=>e.metadata.filter((e=>e.key===s.UNMANAGED_TAG)))),a=[].concat.apply([],o).length,l=i.length-a;return l>0?l:e(t,r)};const c=n(69687),s=a(n(19466)),u=n(37893),l=n(56272);Object.defineProperty(t,"getFunctionName",{enumerable:!0,get:function(){return l.getFunctionName}})},62581:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReturnOperationHandler=void 0;const a=n(18195),c=n(52650),s=n(35809),u=n(90726),l=n(64434),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.RETURN}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.value,isChild:!0});return t.success?{...(0,l.succeeded)(t.value.value),return:!0}:(0,l.failed)(t.value.value,t.message)}};t.ReturnOperationHandler=f,r([(0,d.requiredFields)("value"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.ReturnOperationHandler=f=r([(0,c.injectable)(),o(0,(0,c.inject)(s.Injections.program)),i("design:paramtypes",[u.Program])],f)},62719:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadataConstructorArguments=function(e){const t=(0,r.getReflectMetadata)(e,i.DESIGN_PARAM_TYPES),n=(0,r.getReflectMetadata)(e,i.TAGGED),s=[];if(void 0!==n)for(const[t,r]of Object.entries(n)){const n=parseInt(t);s[n]=(0,c.getConstructorArgumentMetadataFromLegacyMetadata)(e,n,r)}if(void 0!==t)for(let e=0;e<t.length;++e)if(void 0===s[e]){const n=t[e];s[e]=(0,a.getClassElementMetadataFromNewable)(n)}return(0,o.assertConstructorMetadataArrayFilled)(e,s),s};const r=n(99757),i=n(83313),o=n(28650),a=n(52727),c=n(12818)},64214:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReflectMetadata=function(e,t){return Reflect.getMetadata(t,e)}},64434:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeRegExpStringFromArray=t.markEscapedString=t.deepFreeze=t.isWindow=t.isBlockedScope=t.isObject=t.isElement=t.$break=t.$continue=t.succeeded=t.succeededAndReturn=t.failed=void 0,t.clone=function e(n){const r={[i.Array]:()=>{const r=[];for(const i in n){const o=n[i];r[i]=(0,t.isObject)(o)?e(o):o}return r},[i.Event]:()=>n,[i.GlobalThis]:()=>n,[i.RegExp]:()=>n,[i.Element]:()=>n,[i.Date]:()=>new(0,n.constructor)(n),[i.Map]:()=>{const t=new(0,n.constructor);return n.forEach(((n,r)=>{t.set(r,e(n))})),t},[i.Set]:()=>{const t=new(0,n.constructor);return n.forEach((n=>{t.add(e(n))})),t},[i.Primitive]:()=>n,[i.Object]:()=>{const r=n,i={},o=i=>"function"==typeof i?i.bind(r):(0,t.isObject)(n)?e(i):i;for(const e in n){const t=o(n[e]);void 0!==t&&(i[e]=t)}return i}},a=o(n);return r[a]()},t.isFailed=function(e,t){return!e.success&&!t?.optional};const r=n(18195);t.failed=(e=void 0,t="Something went wrong",n=r.OperationType.LITERAL)=>({success:!1,value:{type:n,value:e},message:t});t.succeededAndReturn=e=>({return:!0,...(0,t.succeeded)(e)});t.succeeded=(e,t)=>({...t&&{return:!0},success:!0,value:{type:r.OperationType.LITERAL,value:e}});t.$continue=()=>({success:!0,continue:!0,value:{type:r.OperationType.LITERAL,value:void 0}});var i;t.$break=()=>({success:!0,break:!0,value:{type:r.OperationType.LITERAL,value:void 0}}),function(e){e.GlobalThis="GlobalThis",e.Array="Array",e.Event="Event",e.RegExp="RegExp",e.Element="Element",e.Date="Date",e.Map="Map",e.Set="Set",e.Primitive="Primitive",e.Object="Object"}(i||(i={}));const o=e=>{const n=[()=>e instanceof Window&&i.GlobalThis,()=>Array.isArray(e)&&i.Array,()=>e instanceof Event&&i.Event,()=>e instanceof RegExp&&i.RegExp,()=>(0,t.isElement)(e)&&i.Element,()=>e instanceof Date&&i.Date,()=>e instanceof Map&&i.Map,()=>e instanceof Set&&i.Set,()=>!(0,t.isObject)(e)&&i.Primitive];for(const e of n){const t=e();if(t)return t}return i.Object};t.isElement=e=>{const t=e instanceof Element,n=e instanceof Document,r=e instanceof HTMLDocument,i=(e?.constructor?.name??"").match("^HTML.*(?:Document|Element)$");return t||n||r||i};t.isObject=e=>"object"==typeof e&&null!==e;t.isBlockedScope=e=>e.scope()===r.OperationScope.BLOCK;t.isWindow=e=>e.hasOwnProperty("window")&&(e.window instanceof e.constructor||e.window.constructor.name===e.constructor.name);t.deepFreeze=e=>{if((0,t.isWindow)(e))return e;if(Object.isFrozen(e))return e;Object.values(e).forEach((e=>Object.isFrozen(e)||(0,t.deepFreeze)(e)));try{return Object.freeze(e)}catch{return e}};t.markEscapedString=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t.makeRegExpStringFromArray=e=>e.map(t.markEscapedString).join("|")},64483:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.BindingToSyntax=void 0;const c=a(n(35007)),s=n(9117),u=n(52760),l=n(41402);t.BindingToSyntax=class{_binding;constructor(e){this._binding=e}to(e){return this._binding.type=s.BindingTypeEnum.Instance,this._binding.implementationType=e,new u.BindingInWhenOnSyntax(this._binding)}toSelf(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(c.INVALID_TO_SELF_VALUE);const e=this._binding.serviceIdentifier;return this.to(e)}toConstantValue(e){return this._binding.type=s.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=s.BindingScopeEnum.Singleton,new l.BindingWhenOnSyntax(this._binding)}toDynamicValue(e){return this._binding.type=s.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new u.BindingInWhenOnSyntax(this._binding)}toConstructor(e){return this._binding.type=s.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=s.BindingScopeEnum.Singleton,new l.BindingWhenOnSyntax(this._binding)}toFactory(e){return this._binding.type=s.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=s.BindingScopeEnum.Singleton,new l.BindingWhenOnSyntax(this._binding)}toFunction(e){if("function"!=typeof e)throw new Error(c.INVALID_FUNCTION_BINDING);const t=this.toConstantValue(e);return this._binding.type=s.BindingTypeEnum.Function,this._binding.scope=s.BindingScopeEnum.Singleton,t}toAutoFactory(e){return this._binding.type=s.BindingTypeEnum.Factory,this._binding.factory=t=>()=>t.container.get(e),this._binding.scope=s.BindingScopeEnum.Singleton,new l.BindingWhenOnSyntax(this._binding)}toAutoNamedFactory(e){return this._binding.type=s.BindingTypeEnum.Factory,this._binding.factory=t=>n=>t.container.getNamed(e,n),new l.BindingWhenOnSyntax(this._binding)}toProvider(e){return this._binding.type=s.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=s.BindingScopeEnum.Singleton,new l.BindingWhenOnSyntax(this._binding)}toService(e){this._binding.type=s.BindingTypeEnum.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get:()=>null,set(e){}}),this._binding.dynamicValue=t=>{try{return t.container.get(e)}catch(n){return t.container.getAsync(e)}},this._binding.implementationType=null}}},65334:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WatcherHandler=void 0,function(e){e.onLoad="onLoad",e.onClick="onClick",e.onInputChange="onInputChange",e.onIframeLoaded="onIframeLoaded",e.onUrlChanged="onUrlChanged",e.onPostMessage="onPostMessage",e.onWindowLoad="onWindowLoad",e.onDomLoad="onDomLoad",e.onDomChanged="onDomChanged",e.onHttpRequest="onHttpRequest",e.onHttpResponse="onHttpResponse",e.onKeyDown="onKeyDown"}(t.WatcherHandler||(t.WatcherHandler={}))},66004:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.optional=function(){return(0,u.createTaggedDecorator)(new s.Metadata(c.OPTIONAL_TAG,!0))};const c=a(n(19466)),s=n(4045),u=n(33353)},66520:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Closest=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.CLOSEST}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.subject,isChild:!0});if(!t.success)return(0,s.failed)(void 0,t.message);const n=t.value.value,r=await this.main.handle({operation:e.selector,isChild:!0});if(!r.success)return(0,s.failed)(void 0,r.message);try{const e=n.closest(r.value.value);return(0,s.succeeded)(e)}catch(e){return(0,s.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}}};t.Closest=f,r([(0,d.requiredFields)("subject","selector"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.Closest=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},66757:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetId=function(){const e=(0,r.getReflectMetadata)(Object,i)??0;e===Number.MAX_SAFE_INTEGER?(0,r.updateReflectMetadata)(Object,i,e,(()=>Number.MIN_SAFE_INTEGER)):(0,r.updateReflectMetadata)(Object,i,e,(e=>e+1));return e};const r=n(99757),i="@inversifyjs/core/targetId"},67161:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requiredFields=function(...e){return function(t,n,r){const i=r.value;r.value=function(t,...n){const r=e.find((e=>!(e in t)));return r?o(r):i.call(this,t,...n)}}};const r=n(64434),i=n(18195),o=async function*(e){return(0,r.failed)(void 0,`Argument "${e}" is not defined`,i.NativeOperationType.MISSING_ARGUMENT_ERROR)}},67167:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Select=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161),f=n(39376),p=n(88393);let h=class{constructor(e,t,n,r){this.main=e,this.selectorsSolver=t,this.elementSolver=n,this.elScope=r}type(){return a.OperationType.SELECT}scope(){return a.OperationScope.LOCAL}async*handle(e){let t=this.elScope;if(null!=e.scope){const n=await this.elementSolver.solve(e.scope);if(!n.success)return(0,s.failed)(void 0,n.message);t=n.value.value}const n=Array.isArray(e.selector)?e.selector:[e.selector],r=await this.selectorsSolver.solve(n);if(!r.success)return(0,s.failed)(void 0,r.message);for(const n of r.value.value)try{if(e.plural){const e=t.querySelectorAll(n);if(!e.length)continue;return(0,s.succeeded)([...e])}{const e=t.querySelector(n);if(!e)continue;return(0,s.succeeded)(e)}}catch(e){return(0,s.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}return(0,s.succeeded)(e.plural?[]:null)}};t.Select=h,r([(0,d.requiredFields)("selector"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],h.prototype,"handle",null),t.Select=h=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),o(1,(0,u.inject)(l.Injections.selectorsSolver)),o(2,(0,u.inject)(l.Injections.htmlElementSolver)),o(3,(0,u.inject)(l.Injections.elScope)),i("design:paramtypes",[c.Program,f.SelectorsSolver,p.HtmlElementSolver,Object])],h)},68480:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.postConstruct=void 0;const c=a(n(35007)),s=a(n(19466)),u=(0,n(89260).propertyEventDecorator)(s.POST_CONSTRUCT,c.MULTIPLE_POST_CONSTRUCT_METHODS);t.postConstruct=u},69687:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyTargetImpl=t.getTargets=t.getClassMetadataFromMetadataReader=t.getClassMetadata=t.getClassElementMetadataFromLegacyMetadata=t.ClassElementMetadataKind=void 0;const r=n(49195);Object.defineProperty(t,"getTargets",{enumerable:!0,get:function(){return r.getTargets}});const i=n(80877);Object.defineProperty(t,"LegacyTargetImpl",{enumerable:!0,get:function(){return i.LegacyTargetImpl}});const o=n(44063);Object.defineProperty(t,"getClassElementMetadataFromLegacyMetadata",{enumerable:!0,get:function(){return o.getClassElementMetadataFromLegacyMetadata}});const a=n(49343);Object.defineProperty(t,"getClassMetadata",{enumerable:!0,get:function(){return a.getClassMetadata}});const c=n(8841);Object.defineProperty(t,"getClassMetadataFromMetadataReader",{enumerable:!0,get:function(){return c.getClassMetadataFromMetadataReader}});const s=n(86277);Object.defineProperty(t,"ClassElementMetadataKind",{enumerable:!0,get:function(){return s.ClassElementMetadataKind}})},71063:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalMessageBgType=t.MessageBgType=void 0,function(e){e.INIT="INIT",e.RE_INIT="RE_INIT",e.IFRAME_LOADED="IFRAME_LOADED",e.STORAGE_SAVE="STORAGE_SAVE",e.STORAGE_REMOVE="STORAGE_REMOVE"}(t.MessageBgType||(t.MessageBgType={})),function(e){e.TRACK="__ECOMMERCE_INTERNAL_TRACK__",e.INIT_COMPLETED="__ECOMMERCE_INTERNAL_INIT_COMPLETED__",e.ERROR_TRACE="__ECOMMERCE_ERROR_TRACE__",e.STREAM_ENABLED="__ECOMMERCE_STREAM_ENABLED__"}(t.InternalMessageBgType||(t.InternalMessageBgType={}))},71238:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExistElement=void 0;const a=n(18195),c=n(64434),s=n(52650),u=n(35809),l=n(67161);let d=class{constructor(e){this.elScope=e}type(){return a.OperationType.EXIST}scope(){return a.OperationScope.LOCAL}async*handle(e){try{for(const t of e.selectors){if(null!=this.elScope.querySelector(t))return(0,c.succeeded)(!0)}}catch(e){return(0,c.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}return(0,c.failed)(!1,"No selectors found to exist")}};t.ExistElement=d,r([(0,l.requiredFields)("selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],d.prototype,"handle",null),t.ExistElement=d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.elScope)),i("design:paramtypes",[Object])],d)},71697:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;const c=n(33648),s=a(n(35007)),u=n(9117),l=a(n(19466)),d=n(263),f=n(73934),p=n(96871),h=n(64483),g=n(12576),y=n(37763),m=n(56272),_=n(75528),v=n(93382),b=n(6289);class O{id;parent;options;_middleware;_bindingDictionary;_activations;_deactivations;_snapshots;_metadataReader;_moduleActivationStore;constructor(e){const t=e||{};if("object"!=typeof t)throw new Error(s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=u.BindingScopeEnum.Transient;else if(t.defaultScope!==u.BindingScopeEnum.Singleton&&t.defaultScope!==u.BindingScopeEnum.Transient&&t.defaultScope!==u.BindingScopeEnum.Request)throw new Error(s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,y.id)(),this._bindingDictionary=new v.Lookup,this._snapshots=[],this._middleware=null,this._activations=new v.Lookup,this._deactivations=new v.Lookup,this.parent=null,this._metadataReader=new d.MetadataReader,this._moduleActivationStore=new b.ModuleActivationStore}static merge(e,t,...n){const r=new O,i=[e,t,...n].map((e=>(0,f.getBindingDictionary)(e))),o=(0,f.getBindingDictionary)(r);return i.forEach((e=>{var t;t=o,e.traverse(((e,n)=>{n.forEach((e=>{t.add(e.serviceIdentifier,e.clone())}))}))})),r}load(...e){const t=this._getContainerModuleHelpersFactory();for(const n of e){const e=t(n.id);n.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction,e.unbindAsyncFunction,e.onActivationFunction,e.onDeactivationFunction)}}async loadAsync(...e){const t=this._getContainerModuleHelpersFactory();for(const n of e){const e=t(n.id);await n.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction,e.unbindAsyncFunction,e.onActivationFunction,e.onDeactivationFunction)}}unload(...e){e.forEach((e=>{const t=this._removeModuleBindings(e.id);this._deactivateSingletons(t),this._removeModuleHandlers(e.id)}))}async unloadAsync(...e){for(const t of e){const e=this._removeModuleBindings(t.id);await this._deactivateSingletonsAsync(e),this._removeModuleHandlers(t.id)}}bind(e){return this._bind(this._buildBinding(e))}rebind(e){return this.unbind(e),this.bind(e)}async rebindAsync(e){return await this.unbindAsync(e),this.bind(e)}unbind(e){if(this._bindingDictionary.hasKey(e)){const t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)}async unbindAsync(e){if(this._bindingDictionary.hasKey(e)){const t=this._bindingDictionary.get(e);await this._deactivateSingletonsAsync(t)}this._removeServiceFromDictionary(e)}unbindAll(){this._bindingDictionary.traverse(((e,t)=>{this._deactivateSingletons(t)})),this._bindingDictionary=new v.Lookup}async unbindAllAsync(){const e=[];this._bindingDictionary.traverse(((t,n)=>{e.push(this._deactivateSingletonsAsync(n))})),await Promise.all(e),this._bindingDictionary=new v.Lookup}onActivation(e,t){this._activations.add(e,t)}onDeactivation(e,t){this._deactivations.add(e,t)}isBound(e){let t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t}isCurrentBound(e){return this._bindingDictionary.hasKey(e)}isBoundNamed(e,t){return this.isBoundTagged(e,l.NAMED_TAG,t)}isBoundTagged(e,t,n){let r=!1;if(this._bindingDictionary.hasKey(e)){const i=this._bindingDictionary.get(e),o=(0,f.createMockRequest)(this,e,{customTag:{key:t,value:n},isMultiInject:!1});r=i.some((e=>e.constraint(o)))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r}snapshot(){this._snapshots.push(_.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){const e=this._snapshots.pop();if(void 0===e)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore}createChild(e){const t=new O(e||this.options);return t.parent=this,t}applyMiddleware(...e){const t=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(((e,t)=>t(e)),t)}applyCustomMetadataReader(e){this._metadataReader=e}get(e){const t=this._getNotAllArgs(e,!1,!1);return this._getButThrowIfAsync(t)}async getAsync(e){const t=this._getNotAllArgs(e,!1,!1);return this._get(t)}getTagged(e,t,n){const r=this._getNotAllArgs(e,!1,!1,t,n);return this._getButThrowIfAsync(r)}async getTaggedAsync(e,t,n){const r=this._getNotAllArgs(e,!1,!1,t,n);return this._get(r)}getNamed(e,t){return this.getTagged(e,l.NAMED_TAG,t)}async getNamedAsync(e,t){return this.getTaggedAsync(e,l.NAMED_TAG,t)}getAll(e,t){const n=this._getAllArgs(e,t,!1);return this._getButThrowIfAsync(n)}async getAllAsync(e,t){const n=this._getAllArgs(e,t,!1);return this._getAll(n)}getAllTagged(e,t,n){const r=this._getNotAllArgs(e,!0,!1,t,n);return this._getButThrowIfAsync(r)}async getAllTaggedAsync(e,t,n){const r=this._getNotAllArgs(e,!0,!1,t,n);return this._getAll(r)}getAllNamed(e,t){return this.getAllTagged(e,l.NAMED_TAG,t)}async getAllNamedAsync(e,t){return this.getAllTaggedAsync(e,l.NAMED_TAG,t)}resolve(e){const t=this.isBound(e);t||this.bind(e).toSelf();const n=this.get(e);return t||this.unbind(e),n}tryGet(e){const t=this._getNotAllArgs(e,!1,!0);return this._getButThrowIfAsync(t)}async tryGetAsync(e){const t=this._getNotAllArgs(e,!1,!0);return this._get(t)}tryGetTagged(e,t,n){const r=this._getNotAllArgs(e,!1,!0,t,n);return this._getButThrowIfAsync(r)}async tryGetTaggedAsync(e,t,n){const r=this._getNotAllArgs(e,!1,!0,t,n);return this._get(r)}tryGetNamed(e,t){return this.tryGetTagged(e,l.NAMED_TAG,t)}async tryGetNamedAsync(e,t){return this.tryGetTaggedAsync(e,l.NAMED_TAG,t)}tryGetAll(e,t){const n=this._getAllArgs(e,t,!0);return this._getButThrowIfAsync(n)}async tryGetAllAsync(e,t){const n=this._getAllArgs(e,t,!0);return this._getAll(n)}tryGetAllTagged(e,t,n){const r=this._getNotAllArgs(e,!0,!0,t,n);return this._getButThrowIfAsync(r)}async tryGetAllTaggedAsync(e,t,n){const r=this._getNotAllArgs(e,!0,!0,t,n);return this._getAll(r)}tryGetAllNamed(e,t){return this.tryGetAllTagged(e,l.NAMED_TAG,t)}async tryGetAllNamedAsync(e,t){return this.tryGetAllTaggedAsync(e,l.NAMED_TAG,t)}_preDestroy(e,t){if(void 0!==e&&Reflect.hasMetadata(l.PRE_DESTROY,e)){const n=Reflect.getMetadata(l.PRE_DESTROY,e);return t[n.value]?.()}}_removeModuleHandlers(e){const t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)}_removeModuleBindings(e){return this._bindingDictionary.removeByCondition((t=>t.moduleId===e))}_deactivate(e,t){const n=null==t?void 0:Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){const r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,g.isPromise)(r))return this._handleDeactivationError(r.then((async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n))),e.serviceIdentifier)}const r=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n);if((0,g.isPromise)(r))return this._handleDeactivationError(r,e.serviceIdentifier)}catch(t){if(t instanceof Error)throw new Error(s.ON_DEACTIVATION_ERROR((0,m.getServiceIdentifierAsString)(e.serviceIdentifier),t.message))}}async _handleDeactivationError(e,t){try{await e}catch(e){if(e instanceof Error)throw new Error(s.ON_DEACTIVATION_ERROR((0,m.getServiceIdentifierAsString)(t),e.message))}}_deactivateContainer(e,t){let n=t.next();for(;"function"==typeof n.value;){const r=n.value(e);if((0,g.isPromise)(r))return r.then((async()=>this._deactivateContainerAsync(e,t)));n=t.next()}}async _deactivateContainerAsync(e,t){let n=t.next();for(;"function"==typeof n.value;)await n.value(e),n=t.next()}_getContainerModuleHelpersFactory(){const e=e=>t=>{const n=this._buildBinding(t);return n.moduleId=e,this._bind(n)},t=()=>e=>{this.unbind(e)},n=()=>async e=>this.unbindAsync(e),r=()=>e=>this.isBound(e),i=t=>{const n=e(t);return e=>(this.unbind(e),n(e))},o=e=>(t,n)=>{this._moduleActivationStore.addActivation(e,t,n),this.onActivation(t,n)},a=e=>(t,n)=>{this._moduleActivationStore.addDeactivation(e,t,n),this.onDeactivation(t,n)};return c=>({bindFunction:e(c),isboundFunction:r(),onActivationFunction:o(c),onDeactivationFunction:a(c),rebindFunction:i(c),unbindAsyncFunction:n(),unbindFunction:t()})}_bind(e){return this._bindingDictionary.add(e.serviceIdentifier,e),new h.BindingToSyntax(e)}_buildBinding(e){const t=this.options.defaultScope||u.BindingScopeEnum.Transient;return new c.Binding(e,t)}async _getAll(e){return Promise.all(this._get(e))}_get(e){const t={...e,contextInterceptor:e=>e,targetType:u.TargetTypeEnum.Variable};if(this._middleware){const e=this._middleware(t);if(null==e)throw new Error(s.INVALID_MIDDLEWARE_RETURN);return e}return this._planAndResolve()(t)}_getButThrowIfAsync(e){const t=this._get(e);if((0,g.isPromiseOrContainsPromise)(t))throw new Error(s.LAZY_IN_SYNC(e.serviceIdentifier));return t}_getAllArgs(e,t,n){return{avoidConstraints:!t?.enforceBindingConstraints,isMultiInject:!0,isOptional:n,serviceIdentifier:e}}_getNotAllArgs(e,t,n,r,i){return{avoidConstraints:!1,isMultiInject:t,isOptional:n,key:r,serviceIdentifier:e,value:i}}_getPlanMetadataFromNextArgs(e){const t={isMultiInject:e.isMultiInject};return void 0!==e.key&&(t.customTag={key:e.key,value:e.value}),!0===e.isOptional&&(t.isOptional=!0),t}_planAndResolve(){return e=>{let t=(0,f.plan)(this._metadataReader,this,e.targetType,e.serviceIdentifier,this._getPlanMetadataFromNextArgs(e),e.avoidConstraints);t=e.contextInterceptor(t);return(0,p.resolve)(t)}}_deactivateIfSingleton(e){if(e.activated)return(0,g.isPromise)(e.cache)?e.cache.then((t=>this._deactivate(e,t))):this._deactivate(e,e.cache)}_deactivateSingletons(e){for(const t of e){const e=this._deactivateIfSingleton(t);if((0,g.isPromise)(e))throw new Error(s.ASYNC_UNBIND_REQUIRED)}}async _deactivateSingletonsAsync(e){await Promise.all(e.map((async e=>this._deactivateIfSingleton(e))))}_propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n){this.parent?await this._deactivate.bind(this.parent)(e,t):await this._bindingDeactivationAndPreDestroyAsync(e,t,n)}_removeServiceFromDictionary(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(`${s.CANNOT_UNBIND} ${(0,m.getServiceIdentifierAsString)(e)}`)}}_bindingDeactivationAndPreDestroy(e,t,n){if("function"==typeof e.onDeactivation){const r=e.onDeactivation(t);if((0,g.isPromise)(r))return r.then((()=>this._preDestroy(n,t)))}return this._preDestroy(n,t)}async _bindingDeactivationAndPreDestroyAsync(e,t,n){"function"==typeof e.onDeactivation&&await e.onDeactivation(t),await this._preDestroy(n,t)}}t.Container=O},73934:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getBindingDictionary=v,t.plan=function(e,t,n,r,i,o=!1){const a=new h.Context(t),s=function(e,t,n){const r=O(t,n),i=(0,c.getClassElementMetadataFromLegacyMetadata)(r);if(i.kind===c.ClassElementMetadataKind.unmanaged)throw new Error("Unexpected metadata when creating target");const o=new c.LegacyTargetImpl("",i,e);return o}(n,r,i);try{return E(e,o,r,a,null,s),a}catch(e){throw(0,f.isStackOverflowException)(e)&&(0,p.circularDependencyToException)(a.plan.rootRequest),e}},t.createMockRequest=function(e,t,n){const r=O(t,n),i=(0,c.getClassElementMetadataFromLegacyMetadata)(r);if(i.kind===c.ClassElementMetadataKind.unmanaged)throw new Error("Unexpected metadata when creating target");const o=new c.LegacyTargetImpl("",i,"Variable"),a=new h.Context(e);return new _.Request(t,a,null,[],o)};const c=n(69687),s=n(6736),u=a(n(35007)),l=n(9117),d=a(n(19466)),f=n(12672),p=n(56272),h=n(18721),g=n(4045),y=n(91799),m=n(61823),_=n(21479);function v(e){return e._bindingDictionary}function b(e,t,n,r,i){let o=j(n.container,i.serviceIdentifier),a=[];return o.length===s.BindingCount.NoBindingsAvailable&&!0===n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),o=j(n.container,i.serviceIdentifier)),a=t?o:o.filter((e=>{const t=new _.Request(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r,i){switch(t.length){case s.BindingCount.NoBindingsAvailable:if(r.isOptional())return t;{const t=(0,p.getServiceIdentifierAsString)(e);let o=u.NOT_REGISTERED;throw o+=(0,p.listMetadataForTarget)(t,r),o+=(0,p.listRegisteredBindingsForServiceIdentifier)(i,t,j),null!==n&&(o+=`\n${u.TRYING_TO_RESOLVE_BINDINGS((0,p.getServiceIdentifierAsString)(n.serviceIdentifier))}`),new Error(o)}case s.BindingCount.OnlyOneBindingAvailable:return t;case s.BindingCount.MultipleBindingsAvailable:default:if(r.isArray())return t;{const t=(0,p.getServiceIdentifierAsString)(e);let n=`${u.AMBIGUOUS_MATCH} ${t}`;throw n+=(0,p.listRegisteredBindingsForServiceIdentifier)(i,t,j),new Error(n)}}}(i.serviceIdentifier,a,r,i,n.container),a}function O(e,t){const n=t.isMultiInject?d.MULTI_INJECT_TAG:d.INJECT_TAG,r=[new g.Metadata(n,e)];return void 0!==t.customTag&&r.push(new g.Metadata(t.customTag.key,t.customTag.value)),!0===t.isOptional&&r.push(new g.Metadata(d.OPTIONAL_TAG,!0)),r}function E(e,t,n,r,i,o){let a,c;if(null===i){a=b(e,t,r,null,o),c=new _.Request(n,r,null,a,o);const i=new y.Plan(r,c);r.addPlan(i)}else a=b(e,t,r,i,o),c=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((t=>{let n=null;if(o.isArray())n=c.addChildRequest(t.serviceIdentifier,t,o);else{if(null!==t.cache)return;n=c}if(t.type===l.BindingTypeEnum.Instance&&null!==t.implementationType){const i=(0,m.getDependencies)(e,t.implementationType);if(!0!==r.container.options.skipBaseClassChecks){const n=(0,m.getBaseClassDependencyCount)(e,t.implementationType);if(i.length<n){const e=u.ARGUMENTS_LENGTH_MISMATCH((0,m.getFunctionName)(t.implementationType));throw new Error(e)}}i.forEach((t=>{E(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function j(e,t){let n=[];const r=v(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=j(e.parent,t)),n}},75528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerSnapshot=void 0;class n{bindings;activations;deactivations;middleware;moduleActivationStore;static of(e,t,r,i,o){const a=new n;return a.bindings=e,a.middleware=t,a.deactivations=i,a.activations=r,a.moduleActivationStore=o,a}}t.ContainerSnapshot=n},76062:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerTracer=void 0;const i=n(52650),o=n(64434);let a=class{constructor(){this.logTrace=[]}log(e,t={}){const n={message:e,args:this.clonedArguments(t)};this.logTrace.push(n)}trace(){return this.logTrace.map((e=>e))}clear(){this.logTrace=[]}clonedArguments(e={}){return Object.entries(e).reduce(((e,[t,n])=>[...e,{var:t,value:(0,o.isObject)(n)?(0,o.isElement)(n)?n.outerHTML:(0,o.clone)(n):n}]),[])}};t.LoggerTracer=a,t.LoggerTracer=a=r([(0,i.injectable)()],a)},77279:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateReflectMetadata=function(e,t,n,i){const o=(0,r.getReflectMetadata)(e,t)??n,a=i(o);Reflect.defineMetadata(t,a,e)};const r=n(64214)},77345:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CallMethod=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.CALL_METHOD}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=await this.main.handle({operation:e.subject,isChild:!0});if(!t.success)return(0,s.failed)(void 0,t.message);const n=t.value.value,r=[];for(const t of e.args??[]){const e=await this.main.handle({operation:t,isChild:!0});r.push(e.value.value)}try{if("function"==typeof n[e.method]){const t=n[e.method].apply(n,r);return(0,s.succeeded)(t)}return(0,s.failed)(void 0,`Method "${e.method}" does not exist in prototype of "${e.subject.value}"`,a.NativeOperationType.NATIVE_ERROR)}catch(e){return(0,s.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}}};t.CallMethod=f,r([(0,d.requiredFields)("subject","method"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.CallMethod=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},77426:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLegacyMetadata=function(e){if(e.kind===i.ClassElementMetadataKind.unmanaged)return[{key:r.UNMANAGED_TAG,value:!0}];return function(e){const t=[o(e)];void 0!==e.name&&t.push({key:r.NAMED_TAG,value:e.name});e.optional&&t.push({key:r.OPTIONAL_TAG,value:!0});for(const[n,r]of e.tags)t.push({key:n,value:r});void 0!==e.targetName&&t.push({key:r.NAME_TAG,value:e.targetName});return t}(e)};const r=n(83313),i=n(86277);function o(e){let t;switch(e.kind){case i.ClassElementMetadataKind.multipleInjection:t={key:r.MULTI_INJECT_TAG,value:e.value};break;case i.ClassElementMetadataKind.singleInjection:t={key:r.INJECT_TAG,value:e.value}}return t}},78082:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OperationTracer=void 0;const a=n(52650),c=n(18195),s=n(35809),u=n(90726),l=n(64434);let d=class{constructor(e){this.main=e,this.operationTracer=[],this.localScope={},this.globalScope={}}pop({type:e}){const t=this.operationHandler(e).scope(),n={[c.OperationScope.BLOCK]:this.popBlock.bind(this),[c.OperationScope.LOCAL]:this.popLocal.bind(this)};n[t]?.(),this.localScope={}}push(e,t,n){this.localScope=n;const r={...this.mapOperation(e),position:+t},[i,...o]=this.operationTracer;if(!i)return void(this.operationTracer=[r]);const a=!(0,l.isBlockedScope)(this.operationHandler(i?.type));this.operationTracer=a?[r,...o]:[r,i,...o]}replaceFirst(e){if(0===this.operationTracer.length)return;const[{position:t,type:n,var:r},...i]=this.operationTracer;this.operationTracer=[{...e,position:t,var:r,type:n},...i]}trace(){const e=this.clonedScope(this.globalScope);return{scope:{local:this.clonedScope(this.localScope,e),global:e},trace:this.operationTracer}}init(e){this.localScope={},this.operationTracer=[],this.globalScope=e}clonedScope(e,t={}){const n=Object.keys(t);return Object.entries(e).reduce(((e,[t,r])=>{let i;switch(!0){case(0,l.isElement)(r):i=r.outerHTML;break;case(0,l.isObject)(r)&&(0,l.isWindow)(r):i=r.toString();break;case(0,l.isObject)(r):i=(0,l.clone)(r);break;default:i=r}return{...e,...!n.includes(t)&&{[t]:i}}}),{})}popBlock(){const e=this.operationTracer.findIndex((({type:e})=>(0,l.isBlockedScope)(this.operationHandler(e))));-1!==e&&(this.operationTracer=this.operationTracer.slice(e+1))}popLocal(){this.operationTracer=this.operationTracer.slice(1)}operationHandler(e){return this.main.getOperationsList()[e]}mapOperation(e){const t={[c.OperationType.AND]:({operations:e,...t})=>({...t}),[c.OperationType.OR]:({operations:e,...t})=>({...t}),[c.OperationType.FOR_EACH]:({forEach:e,...t})=>({...t}),[c.OperationType.SPLIT_SCOPE]:({operations:e,...t})=>({...t})}[e.type];return t?t(e):e}};t.OperationTracer=d,t.OperationTracer=d=r([(0,a.injectable)(),o(0,(0,a.inject)(s.Injections.program)),i("design:paramtypes",[u.Program])],d)},78487:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Or=void 0;const a=n(90726),c=n(54114),s=n(64434),u=n(18195),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return u.OperationType.OR}scope(){return u.OperationScope.BLOCK}async*handle(e){for(const[t,n]of Object.entries(e.operations)){const e=this.factory.prototype(this.main),r=await e.handle({operation:n,index:t});if(r.return)return(0,s.succeededAndReturn)(r.value.value);if(r.success&&r.value.value)return this.main.mergeLocalScope(e.getLocalScope()),(0,s.succeeded)(!0)}return(0,s.failed)(!1,'All of the "or" operations are falsy')}};t.Or=p,r([(0,f.requiredFields)("operations"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.Or=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),i("design:paramtypes",[a.Program,c.ProgramFactory])],p)},79101:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Continue=void 0;const i=n(64434),o=n(18195),a=n(52650);let c=class{type(){return o.OperationType.CONTINUE}scope(){return o.OperationScope.LOCAL}async*handle(){return(0,i.$continue)()}};t.Continue=c,t.Continue=c=r([(0,a.injectable)()],c)},80146:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ContentStorage=void 0;const a=n(52650),c=n(48151),s=n(47748);let u=class{constructor(e){this.logger=e,this.runtimeStorage=new Map}initStorage(e){this.runtimeStorage=new Map(Object.entries(e))}save(e,t){this.logger.log(`Runtime storage save: key=${e}, value=`,t),this.runtimeStorage.set(e,t)}remove(e){this.runtimeStorage.has(e)?(this.logger.log(`"${e}" variable was removed from the storage; removed value=`,this.runtimeStorage.get(e)),this.runtimeStorage.delete(e)):this.logger.error(`"${e}" variable was not found in the storage`)}getStorage(){return Object.fromEntries(this.runtimeStorage)}getItem(e){return this.runtimeStorage.get(e)}upsert(e,t){const n=this.runtimeStorage.has(e)?[...this.getItem(e),t]:[t];this.logger.log("Runtime storage save intercepted data: ",[e,n]),this.runtimeStorage.set(e,n)}};u=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.logger)),i("design:paramtypes",[s.Logger])],u),t.ContentStorage=u},80877:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyTargetImpl=void 0;const r=n(5265),i=n(77426),o=n(86277),a=n(83313),c=n(36338),s=n(41129),u=n(66757);t.LegacyTargetImpl=class{#t;#n;#r;#i;#o;#a;constructor(e,t,n){this.#n=(0,u.getTargetId)(),this.#r=e,this.#i=void 0,this.#t=t,this.#o=new c.LegacyQueryableStringImpl("string"==typeof e?e:(0,s.getDescription)(e)),this.#a=n}get id(){return this.#n}get identifier(){return this.#r}get metadata(){return void 0===this.#i&&(this.#i=(0,i.getLegacyMetadata)(this.#t)),this.#i}get name(){return this.#o}get type(){return this.#a}get serviceIdentifier(){return r.LazyServiceIdentifier.is(this.#t.value)?this.#t.value.unwrap():this.#t.value}getCustomTags(){return[...this.#t.tags.entries()].map((([e,t])=>({key:e,value:t})))}getNamedTag(){return void 0===this.#t.name?null:{key:a.NAMED_TAG,value:this.#t.name}}hasTag(e){return this.metadata.some((t=>t.key===e))}isArray(){return this.#t.kind===o.ClassElementMetadataKind.multipleInjection}isNamed(){return void 0!==this.#t.name}isOptional(){return this.#t.optional}isTagged(){return this.#t.tags.size>0}matchesArray(e){return this.isArray()&&this.#t.value===e}matchesNamedTag(e){return this.#t.name===e}matchesTag(e){return t=>this.metadata.some((n=>n.key===e&&n.value===t))}}},82106:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Func=void 0;const a=n(18195),c=n(90726),s=n(54114),u=n(64434),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t,n){this.main=e,this.factory=t,this.funcs=n}type(){return a.OperationType.FUNC}scope(){return a.OperationScope.BLOCK}async*handle(e){const t=await this.main.handle({operation:e.name,isChild:!0});if(!t.success)return(0,u.failed)(void 0,t.message);const n=t.value.value;if("string"!=typeof n||!this.funcs[n])return(0,u.failed)(void 0,`Operation "${n}" can not be found`,a.NativeOperationType.NATIVE_ERROR);const r=this.funcs[n],i={},o=e.args??[];for(let e=0;e<o.length;e++){const t=await this.main.handle({operation:o[e],isChild:!0});if(!t.success)return(0,u.failed)(void 0,t.message);if(r.params[e]){const n=r.params[e];i["string"==typeof n?n:n.name]=t.value.value}}const c=this.factory.create(this.main.getConfig(),this.main.getObserver(),this.main.getElScopeRef(),this.main.getGlobalScope(),this.funcs,!1,i,this.main.getCurrencyList());if(c.mergeLocalScope(this.main.getGlobalScope()),0===r.operations.length)return(0,u.failed)(void 0,"Function operation list is empty");for(const[e,t]of Object.entries(r.operations)){const n=await c.handle({operation:t,index:e});if(n.return||t.type===a.OperationType.RETURN)return(0,u.succeeded)(n.value.value);if((0,u.isFailed)(n,t))return(0,u.failed)(void 0,n.message)}return(0,u.succeeded)(void 0)}};t.Func=p,r([(0,f.requiredFields)("name"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.Func=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),o(2,(0,l.inject)(d.Injections.funcs)),i("design:paramtypes",[c.Program,s.ProgramFactory,Object])],p)},82151:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyServiceIdentifier=t.islazyServiceIdentifierSymbol=void 0,t.islazyServiceIdentifierSymbol=Symbol.for("@inversifyjs/common/islazyServiceIdentifier");class n{[t.islazyServiceIdentifierSymbol];#c;constructor(e){this.#c=e,this[t.islazyServiceIdentifierSymbol]=!0}static is(e){return"object"==typeof e&&null!==e&&!0===e[t.islazyServiceIdentifierSymbol]}unwrap(){return this.#c()}}t.LazyServiceIdentifier=n},83313:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NON_CUSTOM_TAG_KEYS=t.PRE_DESTROY=t.POST_CONSTRUCT=t.DESIGN_PARAM_TYPES=t.PARAM_TYPES=t.TAGGED_PROP=t.TAGGED=t.MULTI_INJECT_TAG=t.INJECT_TAG=t.OPTIONAL_TAG=t.UNMANAGED_TAG=t.NAME_TAG=t.NAMED_TAG=void 0,t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct",t.PRE_DESTROY="pre_destroy",t.NON_CUSTOM_TAG_KEYS=[t.INJECT_TAG,t.MULTI_INJECT_TAG,t.NAME_TAG,t.UNMANAGED_TAG,t.NAMED_TAG,t.OPTIONAL_TAG]},83843:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnLoadHandler=void 0;const a=n(52650),c=n(48151),s=n(44892),u=n(65334),l=n(85362);let d=class{constructor(e,t){this.container=e,this.extractor=t}handle(){(0,l.isIframe)()||this.watcher()?.config?.onLoad?.forEach((e=>{this.extractor?.run?.(e,u.WatcherHandler.onLoad)}))}watcher(){return this.container.get(c.ContentInjections.activeConfig)}};d=r([(0,a.injectable)(),o(0,(0,a.inject)(c.ContentInjections.DI)),o(1,(0,a.inject)(c.ContentInjections.extractorManager)),i("design:paramtypes",[a.Container,s.ExtractorManager])],d),t.OnLoadHandler=d},85362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIframe=void 0,t.isIframe=function(){try{return window.self!==window.top}catch{return!0}}},86249:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassMetadataConstructorArgumentsFromMetadataReader=function(e,t){const n=t.getConstructorMetadata(e),a=[];for(const[t,r]of Object.entries(n.userGeneratedMetadata)){const n=parseInt(t);a[n]=(0,o.getConstructorArgumentMetadataFromLegacyMetadata)(e,n,r)}if(void 0!==n.compilerGeneratedMetadata)for(let e=0;e<n.compilerGeneratedMetadata.length;++e)if(void 0===a[e]){const t=n.compilerGeneratedMetadata[e];a[e]=(0,i.getClassElementMetadataFromNewable)(t)}return(0,r.assertConstructorMetadataArrayFilled)(e,a),a};const r=n(28650),i=n(52727),o=n(12818)},86277:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ClassElementMetadataKind=void 0,function(e){e[e.multipleInjection=0]="multipleInjection",e[e.singleInjection=1]="singleInjection",e[e.unmanaged=2]="unmanaged"}(n||(t.ClassElementMetadataKind=n={}))},86331:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.targetName=function(e){return function(t,n,r){const i=new s.Metadata(c.NAME_TAG,e);(0,u.tagParameter)(t,n,r,i)}};const c=a(n(19466)),s=n(4045),u=n(33353)},86389:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.JsonParser=void 0;const a=n(18195),c=n(90726),s=n(64434),u=n(52650),l=n(35809),d=n(67161);let f=class{constructor(e){this.main=e}type(){return a.OperationType.JSON_PARSER}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=(await this.main.handle({operation:e.value,isChild:!0})).value.value;try{const e=JSON.parse(t);return(0,s.succeeded)(e)}catch(e){return(0,s.failed)(void 0,`${e.message}. Parsed value - ${t}`,a.NativeOperationType.NATIVE_ERROR)}}};t.JsonParser=f,r([(0,d.requiredFields)("value"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],f.prototype,"handle",null),t.JsonParser=f=r([(0,u.injectable)(),o(0,(0,u.inject)(l.Injections.program)),i("design:paramtypes",[c.Program])],f)},87059:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingOnSyntax=void 0;const r=n(90732);t.BindingOnSyntax=class{_binding;constructor(e){this._binding=e}onActivation(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)}onDeactivation(e){return this._binding.onDeactivation=e,new r.BindingWhenSyntax(this._binding)}}},88053:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FactoryType=void 0,function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(n||(t.FactoryType=n={}))},88393:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlElementSolver=void 0;const a=n(90726),c=n(64434),s=n(52650),u=n(35809),l=n(18195);let d=class{constructor(e){this.main=e}async solve(e){try{const t=await this.main.handle({operation:e,isChild:!0});return t.success?(0,c.isElement)(t.value.value)?(0,c.succeeded)(t.value.value):(0,c.failed)(void 0,'Argument for "scope" must be an instance of "HTMLElement"'):(0,c.failed)(void 0,t.message)}catch(e){return(0,c.failed)(void 0,e.message,l.NativeOperationType.NATIVE_ERROR)}}};t.HtmlElementSolver=d,t.HtmlElementSolver=d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.program)),i("design:paramtypes",[a.Program])],d)},89260:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.propertyEventDecorator=function(e,t){return()=>(n,i)=>{const o=new r.Metadata(e,i);if(Reflect.hasOwnMetadata(e,n.constructor))throw new Error(t);Reflect.defineMetadata(e,o,n.constructor)}};const r=n(4045)},89399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0;t.delay=async e=>{await new Promise((t=>setTimeout(t,e,!0)))}},89771:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MarkProcessedElement=void 0;const a=n(18195),c=n(64434),s=n(52650),u=n(35809),l=n(67161);let d=class{constructor(e){this.elScope=e}type(){return a.OperationType.MARK_PROCESSED_ELEMENT}scope(){return a.OperationScope.LOCAL}async*handle(e){for(const t of e.selectors){let e;try{e=this.elScope.querySelector(t)}catch(e){continue}if(null!=e)return e.setAttribute("data-lib-processed","true"),(0,c.succeeded)(!0)}return(0,c.failed)(!1,"No element was found to process")}};t.MarkProcessedElement=d,r([(0,l.requiredFields)("selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],d.prototype,"handle",null),t.MarkProcessedElement=d=r([(0,s.injectable)(),o(0,(0,s.inject)(u.Injections.elScope)),i("design:paramtypes",[Object])],d)},90256:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isClonable=function(e){return"object"==typeof e&&null!==e&&"clone"in e&&"function"==typeof e.clone}},90726:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const a=n(18195),c=n(53425),s=n(54114),u=n(64434),l=n(59670),d=n(52650),f=n(88393),p=n(39376),h=n(35809),g=n(76062),y=n(78082),m=n(18968),_=n(686);let v=r=class{constructor(e,t,n,r,i,o,a,c={},s=_.DEFAULT_CURRENCY_LIST){this.config=e,this.observer=t,this.elScope=n,this.varScope=r,this.funcs=i,this.localScope=c,this.currencyList=s,this.operations={},this.globalScope=(0,u.deepFreeze)((0,u.clone)(r)),this.localScope=c,this.di=new d.Container,this.injectDependencies(o,a)}getConfig(){return this.config}getElScopeRef(){return this.elScope}getLocalScope(){return this.localScope}getGlobalScope(){return this.globalScope}cloneLocalScope(){return(0,u.clone)(this.getLocalScope())}mergeLocalScope(e){return Object.assign(this.getLocalScope(),e),this.getLocalScope()}getFuncsRef(){return this.funcs}getObserver(){return this.observer}programScope(e){return e?Object.assign({},this.getGlobalScope(),this.cloneLocalScope()):Object.assign({},this.getGlobalScope(),this.getLocalScope())}getOperationsList(){return this.operations}getTrace(e){return r.tracer.trace(e)}initTrace(){r.tracer.init(this.getGlobalScope())}getCurrencyList(){return this.currencyList}async handle({operation:e,isChild:t=!1,index:n="0"}){if(null==e?.type)return(0,u.failed)(void 0,"Operation type is not provided",a.NativeOperationType.NATIVE_ERROR);if(!this.operations[e?.type])return(0,u.failed)(void 0,`Unsupportable operation type "${e?.type}"`,a.NativeOperationType.NATIVE_ERROR);const i=this.getLocalScope(),o=this.getGlobalScope();e.debug&&(this.logger.forceLog("DEBUG: operation",e),this.logger.forceLog("DEBUG: localScope",i),this.logger.forceLog("DEBUG: globalScope",o)),t||r.operationTracer.push(e,n,i);const c=await this.handleOperation(e),s=await this.handleAccumulated(e),l=await this.handleResult(e,this.programScope(!1),c,s);return t||!l.success||r.operationTracer.pop(e),l}async handleResult(e,t,n,r){try{if(e.var){const i=e.var.split(".");let o=t;for(let e=0;e<i.length-1;e++)o.hasOwnProperty(i[e])||(o[i[e]]={}),o=o[i[e]];const a=i[i.length-1];if(r){const e=null!=o[a],t=[o[a],n.value.value],r=[n.value.value];o[a]=Array.isArray(o[a])?[...o[a],n.value.value]:e?t:r}else o[a]=n.value.value;this.mergeLocalScope(t)}return n}catch(e){return(0,u.failed)(void 0,e.message,a.NativeOperationType.NATIVE_ERROR)}}async handleOperation(e){const t=this.operations[e.type].handle(e);let n,i;do{i=await t.next(),n=i.value,i.done||r.operationTracer.replaceFirst(n)}while(!i.done);return n}async handleAccumulated(e){if(null!=e.accumulate){let t,n;const r=this.operations[e.accumulate.type].handle(e.accumulate);do{n=await r.next(),t=n.value}while(!n.done);return t.value.value}return!1}injectDependencies(e,t){this.di.bind(h.Injections.program).toConstantValue(this),this.di.bind(h.Injections.currencyList).toConstantValue(this.currencyList),this.injectServices(e),this.injectTracer(),this.injectOperations(t),this.logger=this.di.get(h.Injections.logger)}injectServices(e){this.di.bind(h.Injections.htmlElementSolver).to(f.HtmlElementSolver).inSingletonScope(),this.di.bind(h.Injections.selectorsSolver).to(p.SelectorsSolver).inSingletonScope(),this.di.bind(h.Injections.logger).to(l.MyLogger).inSingletonScope(),this.di.bind(h.Injections.observer).toConstantValue(this.observer),this.di.bind(h.Injections.factory).toConstantValue(e),this.di.bind(h.Injections.config).toConstantValue(this.config),this.di.bind(h.Injections.elScope).toConstantValue(this.elScope),this.di.bind(h.Injections.funcs).toConstantValue(this.funcs)}injectOperations(e){Object.values(e).forEach((e=>{const t=e.prototype.type();this.di.bind(t).to(e).inSingletonScope();const n=this.di.get(t);this.operations[n.type()]=n}))}injectTracer(){r.loggerTracer?this.di.bind(h.Injections.loggerTracer).toConstantValue(r.loggerTracer):(this.di.bind(h.Injections.loggerTracer).to(g.LoggerTracer).inSingletonScope(),r.loggerTracer=this.di.get(h.Injections.loggerTracer)),r.operationTracer?this.di.bind(h.Injections.operationTracer).toConstantValue(r.operationTracer):(this.di.bind(h.Injections.operationTracer).to(y.OperationTracer).inSingletonScope(),r.operationTracer=this.di.get(h.Injections.operationTracer)),r.tracer?this.di.bind(h.Injections.tracer).toConstantValue(r.tracer):(this.di.bind(h.Injections.tracer).to(m.Tracer).inSingletonScope(),r.tracer=this.di.get(h.Injections.tracer))}};t.Program=v,t.Program=v=r=i([(0,d.injectable)(),o("design:paramtypes",[Object,c.Observer,Object,Object,Object,s.ProgramFactory,Object,Object,Object])],v)},90732:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenSyntax=void 0;const r=n(87059),i=n(26727);t.BindingWhenSyntax=class{_binding;constructor(e){this._binding=e}when(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)}whenTargetNamed(e){return this._binding.constraint=(0,i.namedConstraint)(e),new r.BindingOnSyntax(this._binding)}whenTargetIsDefault(){return this._binding.constraint=e=>{if(null===e)return!1;return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new r.BindingOnSyntax(this._binding)}whenTargetTagged(e,t){return this._binding.constraint=(0,i.taggedConstraint)(e)(t),new r.BindingOnSyntax(this._binding)}whenInjectedInto(e){return this._binding.constraint=t=>null!==t&&(0,i.typeConstraint)(e)(t.parentRequest),new r.BindingOnSyntax(this._binding)}whenParentNamed(e){return this._binding.constraint=t=>null!==t&&(0,i.namedConstraint)(e)(t.parentRequest),new r.BindingOnSyntax(this._binding)}whenParentTagged(e,t){return this._binding.constraint=n=>null!==n&&(0,i.taggedConstraint)(e)(t)(n.parentRequest),new r.BindingOnSyntax(this._binding)}whenAnyAncestorIs(e){return this._binding.constraint=t=>null!==t&&(0,i.traverseAncerstors)(t,(0,i.typeConstraint)(e)),new r.BindingOnSyntax(this._binding)}whenNoAncestorIs(e){return this._binding.constraint=t=>null!==t&&!(0,i.traverseAncerstors)(t,(0,i.typeConstraint)(e)),new r.BindingOnSyntax(this._binding)}whenAnyAncestorNamed(e){return this._binding.constraint=t=>null!==t&&(0,i.traverseAncerstors)(t,(0,i.namedConstraint)(e)),new r.BindingOnSyntax(this._binding)}whenNoAncestorNamed(e){return this._binding.constraint=t=>null!==t&&!(0,i.traverseAncerstors)(t,(0,i.namedConstraint)(e)),new r.BindingOnSyntax(this._binding)}whenAnyAncestorTagged(e,t){return this._binding.constraint=n=>null!==n&&(0,i.traverseAncerstors)(n,(0,i.taggedConstraint)(e)(t)),new r.BindingOnSyntax(this._binding)}whenNoAncestorTagged(e,t){return this._binding.constraint=n=>null!==n&&!(0,i.traverseAncerstors)(n,(0,i.taggedConstraint)(e)(t)),new r.BindingOnSyntax(this._binding)}whenAnyAncestorMatches(e){return this._binding.constraint=t=>null!==t&&(0,i.traverseAncerstors)(t,e),new r.BindingOnSyntax(this._binding)}whenNoAncestorMatches(e){return this._binding.constraint=t=>null!==t&&!(0,i.traverseAncerstors)(t,e),new r.BindingOnSyntax(this._binding)}}},91293:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Literal=void 0;const o=n(64434),a=n(18195),c=n(52650),s=n(67161);let u=class{type(){return a.OperationType.LITERAL}scope(){return a.OperationScope.LOCAL}async*handle(e){return(0,o.succeeded)(e.value)}};t.Literal=u,r([(0,s.requiredFields)("value"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],u.prototype,"handle",null),t.Literal=u=r([(0,c.injectable)()],u)},91679:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Plural=void 0;const a=n(39084),c=n(18195),s=n(88393),u=n(39376),l=n(64434),d=n(41136),f=n(52650),p=n(35809),h=n(67161);let g=class extends a.BaseHandler{constructor(e,t,n){super(),this.selectorsSolver=e,this.elementSolver=t,this.elScope=n}type(){return c.OperationType.PLURAL}scope(){return c.OperationScope.LOCAL}async*handle(e){let t=this.elScope;if(null!=e.scope){const n=await this.elementSolver.solve(e.scope);if(!n.success)return(0,l.failed)(void 0,n.message);t=n.value.value}const n=await this.selectorsSolver.solve(e.selectors);if(!n.success)return(0,l.failed)(void 0,n.message);const r=n.value.value;for(const n of r){let r;try{if(r=t.querySelectorAll(n),0===r.length)continue}catch(e){return(0,l.failed)(void 0,e.message,c.NativeOperationType.NATIVE_ERROR)}const i=[];return r.forEach((t=>i.push((0,d.getter)(e,t)))),(0,l.succeeded)(i)}return(0,l.failed)(void 0,`No elements by selectors "${JSON.stringify(r)}" were found`)}};t.Plural=g,r([(0,h.requiredFields)("selectors"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],g.prototype,"handle",null),t.Plural=g=r([(0,f.injectable)(),o(0,(0,f.inject)(p.Injections.selectorsSolver)),o(1,(0,f.inject)(p.Injections.htmlElementSolver)),o(2,(0,f.inject)(p.Injections.elScope)),i("design:paramtypes",[u.SelectorsSolver,s.HtmlElementSolver,Object])],g)},91799:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plan=void 0;t.Plan=class{parentContext;rootRequest;constructor(e,t){this.parentContext=e,this.rootRequest=t}}},93382:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Lookup=void 0;const c=a(n(35007)),s=n(90256);class u{_map;constructor(){this._map=new Map}getMap(){return this._map}add(e,t){if(this._checkNonNulish(e),null==t)throw new Error(c.NULL_ARGUMENT);const n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])}get(e){this._checkNonNulish(e);const t=this._map.get(e);if(void 0!==t)return t;throw new Error(c.KEY_NOT_FOUND)}remove(e){if(this._checkNonNulish(e),!this._map.delete(e))throw new Error(c.KEY_NOT_FOUND)}removeIntersection(e){this.traverse(((t,n)=>{const r=e.hasKey(t)?e.get(t):void 0;if(void 0!==r){const e=n.filter((e=>!r.some((t=>e===t))));this._setValue(t,e)}}))}removeByCondition(e){const t=[];return this._map.forEach(((n,r)=>{const i=[];for(const r of n){e(r)?t.push(r):i.push(r)}this._setValue(r,i)})),t}hasKey(e){return this._checkNonNulish(e),this._map.has(e)}clone(){const e=new u;return this._map.forEach(((t,n)=>{t.forEach((t=>{e.add(n,(0,s.isClonable)(t)?t.clone():t)}))})),e}traverse(e){this._map.forEach(((t,n)=>{e(n,t)}))}_checkNonNulish(e){if(null==e)throw new Error(c.NULL_ARGUMENT)}_setValue(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)}}t.Lookup=u},94269:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.inject=void 0;const c=a(n(19466)),s=(0,n(8701).injectBase)(c.INJECT_TAG);t.inject=s},94931:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InversifyCoreErrorKind=void 0,function(e){e[e.injectionDecoratorConflict=0]="injectionDecoratorConflict",e[e.missingInjectionDecorator=1]="missingInjectionDecorator",e[e.planning=2]="planning",e[e.unknown=3]="unknown"}(n||(t.InversifyCoreErrorKind=n={}))},96085:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Condition=void 0;const a=n(18195),c=n(90726),s=n(54114),u=n(64434),l=n(52650),d=n(35809),f=n(67161);let p=class{constructor(e,t){this.main=e,this.factory=t}type(){return a.OperationType.CONDITION}scope(){return a.OperationScope.LOCAL}async*handle(e){const t=this.factory.prototype(this.main),n=await t.handle({operation:e.left,isChild:!0});if(!n.success)return(0,u.failed)(!1,n.message);const r=await t.handle({operation:e.right,isChild:!0});if(!r.success)return(0,u.failed)(!1,r.message);const i={"!=":()=>n.value.value!=r.value.value,"!==":()=>n.value.value!==r.value.value,">":()=>n.value.value>r.value.value,"<":()=>n.value.value<r.value.value,"<=":()=>n.value.value<=r.value.value,">=":()=>n.value.value>=r.value.value,"==":()=>n.value.value==r.value.value,"===":()=>n.value.value===r.value.value};if(!i[e.operator])return(0,u.failed)(void 0,`Unsupportable condition operator "${e.operator}"`,a.NativeOperationType.NATIVE_ERROR);const o=i[e.operator]();return this.main.mergeLocalScope(t.getLocalScope()),(0,u.succeeded)(o)}};t.Condition=p,r([(0,f.requiredFields)("operator","left","right"),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],p.prototype,"handle",null),t.Condition=p=r([(0,l.injectable)(),o(0,(0,l.inject)(d.Injections.program)),o(1,(0,l.inject)(d.Injections.factory)),i("design:paramtypes",[c.Program,s.ProgramFactory])],p)},96871:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=function(e){return g(e.plan.rootRequest.requestScope)(e.plan.rootRequest)};const c=a(n(35007)),s=n(9117),u=n(73934),l=n(27353),d=n(12576),f=n(8835),p=n(12672),h=n(97508),g=e=>t=>{t.parentContext.setCurrentRequest(t);const n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return r.map((t=>g(e)(t)));{if(t.target.isOptional()&&0===n.length)return;const r=n[0];return m(e,t,r)}},y=(e,t,n)=>{let r;const i=t.childRequests;switch((0,f.ensureFullyBound)(n),n.type){case s.BindingTypeEnum.ConstantValue:case s.BindingTypeEnum.Function:r=n.cache;break;case s.BindingTypeEnum.Constructor:r=n.implementationType;break;case s.BindingTypeEnum.Instance:r=(0,h.resolveInstance)(n,n.implementationType,i,g(e));break;default:r=((e,t)=>{const n=(0,f.getFactoryDetails)(e);return(0,p.tryAndThrowErrorIfStackOverflow)((()=>n.factory.bind(e)(t)),(()=>new Error(c.CIRCULAR_DEPENDENCY_IN_FACTORY(n.factoryType,t.currentRequest.serviceIdentifier.toString()))))})(n,t.parentContext)}return r},m=(e,t,n)=>((e,t,n)=>{let r=(0,l.tryGetFromScope)(e,t);return null!==r||(r=n(),(0,l.saveToScope)(e,t,r)),r})(e,n,(()=>{let r=y(e,t,n);return r=(0,d.isPromise)(r)?r.then((e=>_(t,n,e))):_(t,n,r),r}));function _(e,t,n){let r=v(e.parentContext,t,n);const i=j(e.parentContext.container);let o,a=i.next();do{o=a.value;const t=e.parentContext,n=e.serviceIdentifier,c=E(o,n);r=(0,d.isPromise)(r)?O(c,t,r):b(c,t,r),a=i.next()}while(!0!==a.done&&!(0,u.getBindingDictionary)(o).hasKey(e.serviceIdentifier));return r}const v=(e,t,n)=>{let r;return r="function"==typeof t.onActivation?t.onActivation(e,n):n,r},b=(e,t,n)=>{let r=e.next();for(;!0!==r.done;){if(n=r.value(t,n),(0,d.isPromise)(n))return O(e,t,n);r=e.next()}return n},O=async(e,t,n)=>{let r=await n,i=e.next();for(;!0!==i.done;)r=await i.value(t,r),i=e.next();return r},E=(e,t)=>{const n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},j=e=>{const t=[e];let n=e.parent;for(;null!==n;)t.push(n),n=n.parent;return{next:()=>{const e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}}},97508:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.resolveInstance=function(e,t,n,r){!function(e,t){e.scope!==s.BindingScopeEnum.Singleton&&function(e,t){const n=`Class cannot be instantiated in ${e.scope===s.BindingScopeEnum.Request?"request":"transient"} scope.`;if("function"==typeof e.onDeactivation)throw new Error((0,c.ON_DEACTIVATION_ERROR)(t.name,n));if(Reflect.hasMetadata(u.PRE_DESTROY,t))throw new Error((0,c.PRE_DESTROY_ERROR)(t.name,n))}(e,t)}(e,t);const i=function(e,t,n){let r;if(t.length>0){const i=function(e,t){return e.reduce(((e,n)=>{const r=t(n);return n.target.type===s.TargetTypeEnum.ConstructorArgument?e.constructorInjections.push(r):(e.propertyRequests.push(n),e.propertyInjections.push(r)),e.isAsync||(e.isAsync=(0,l.isPromiseOrContainsPromise)(r)),e}),{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}(t,n),o={...i,constr:e};r=i.isAsync?async function(e){const t=await f(e.constructorInjections),n=await f(e.propertyInjections);return d({...e,constructorInjections:t,propertyInjections:n})}(o):d(o)}else r=new e;return r}(t,n,r);return(0,l.isPromise)(i)?i.then((e=>p(t,e))):p(t,i)};const c=n(35007),s=n(9117),u=a(n(19466)),l=n(12576);function d(e){const t=new e.constr(...e.constructorInjections);return e.propertyRequests.forEach(((n,r)=>{const i=n.target.identifier,o=e.propertyInjections[r];n.target.isOptional()&&void 0===o||(t[i]=o)})),t}async function f(e){const t=[];for(const n of e)Array.isArray(n)?t.push(Promise.all(n)):t.push(n);return Promise.all(t)}function p(e,t){const n=function(e,t){if(Reflect.hasMetadata(u.POST_CONSTRUCT,e)){const n=Reflect.getMetadata(u.POST_CONSTRUCT,e);try{return t[n.value]?.()}catch(t){if(t instanceof Error)throw new Error((0,c.POST_CONSTRUCT_ERROR)(e.name,t.message))}}}(e,t);return(0,l.isPromise)(n)?n.then((()=>t)):t}},98986:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&i(t,e,n[a]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.unmanaged=function(){return function(e,t,n){const r=new s.Metadata(c.UNMANAGED_TAG,!0);(0,u.tagParameter)(e,t,n,r)}};const c=a(n(19466)),s=n(4045),u=n(33353)},99757:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateReflectMetadata=t.getReflectMetadata=void 0;const r=n(64214);Object.defineProperty(t,"getReflectMetadata",{enumerable:!0,get:function(){return r.getReflectMetadata}});const i=n(77279);Object.defineProperty(t,"updateReflectMetadata",{enumerable:!0,get:function(){return i.updateReflectMetadata}})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();(()=>{"use strict";n(44741);const e=n(12668),t=n(2353),r=n(32677),i=n(5139),o=n(22039),a=n(52650),c=n(48151),s=n(57421),u=n(8380),l=n(22895),d=n(6439),f=n(28756),p=n(83843),h=n(46872),g=n(36166),y=n(45639),m=n(44892),_=n(13007),v=n(39755),b=n(56258),O=n(58509);(new class{constructor(){this.initContainer()}init(){const e=this.container.get(c.ContentInjections.historyManager),t=this.container.get(c.ContentInjections.outContentMessageManager),n=this.container.get(c.ContentInjections.requestsManager);this.container.get(c.ContentInjections.inContentMessageManager),e.onShopifyDetected(t.initShopify.bind(t)),e.replaceNativeApi(),n.injectScript(),t.init()}initContainer(){this.container=new a.Container,this.bindManagers(),this.bindConstants(),this.bindHandlers()}bindManagers(){const n={[c.ContentInjections.requestsManager]:o.RequestsManager,[c.ContentInjections.inContentMessageManager]:t.InContentMessageManager,[c.ContentInjections.outContentMessageManager]:e.OutContentMessageManager,[c.ContentInjections.historyManager]:r.HistoryManager,[c.ContentInjections.observer]:i.Observer,[c.ContentInjections.matcher]:s.Matcher,[c.ContentInjections.extractorManager]:m.ExtractorManager};Object.entries(n).forEach((([e,t])=>{this.bindSingleton(e,t)}))}bindConstants(){const e=(0,O.uuid)();this.container.bind(c.ContentInjections.ID).toConstantValue(e),this.container.bind(c.ContentInjections.DI).toConstantValue(this.container)}bindHandlers(){const e={[c.ContentInjections.interceptorsHandler]:u.InterceptorsHandler,[c.ContentInjections.onClickHandler]:l.OnClickHandler,[c.ContentInjections.onInputChangeHandler]:v.OnInputChangeHandler,[c.ContentInjections.onDomLoadHandler]:d.OnDomLoadHandler,[c.ContentInjections.onIframeLoadedHandler]:f.OnIframeLoadedHandler,[c.ContentInjections.onLoadHandler]:p.OnLoadHandler,[c.ContentInjections.onPostMessageHandler]:h.OnPostMessageHandler,[c.ContentInjections.onUrlChangedHandler]:g.OnUrlChangedHandler,[c.ContentInjections.onWindowLoadHandler]:y.OnWindowLoadHandler,[c.ContentInjections.onDomChangedHandler]:_.OnDomChangedHandler,[c.ContentInjections.onKeyDownHandler]:b.OnKeyDownHandler};Object.entries(e).forEach((([e,t])=>{this.bindSingleton(e,t)}))}bindSingleton(e,t){this.container.bind(e).to(t).inSingletonScope()}}).init()})()})();